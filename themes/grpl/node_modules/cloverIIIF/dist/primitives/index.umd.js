(function(o,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("react"),require("sanitize-html"),require("@stitches/react"),require("hls.js")):typeof define=="function"&&define.amd?define(["exports","react","sanitize-html","@stitches/react","hls.js"],t):(o=typeof globalThis<"u"?globalThis:o||self,t(o.CloverIIIFPrimitives={},o.React,o.sanitizeHtml,o.react,o.Hls))})(this,function(o,t,U,B,g){"use strict";const V=(e,n="none")=>{if(!e)return null;if(typeof e=="string")return[e];if(!e[n]){const r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return!e[n]||!Array.isArray(e[n])?null:e[n]},v=(e,n="none",r=", ")=>{const s=V(e,n);return Array.isArray(s)?s.join(`${r}`):s};function J(e){return{__html:Q(e)}}function f(e,n){const r=Object.keys(e).filter(i=>n.includes(i)?null:i),s=new Object;return r.forEach(i=>{s[i]=e[i]}),s}function Q(e){return U(e,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const k=209,X={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${k} 100% 38.2%)`,accentMuted:`hsl(${k} 80% 61.8%)`,accentAlt:`hsl(${k} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},Y={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:m,css:ye,keyframes:ge,createTheme:he}=B.createStitches({theme:X,media:Y}),Z=m("span",{}),M=e=>{const{as:n,label:r}=e,i=f(e,["as","label"]);return t.createElement(Z,{as:n,...i},v(r,i.lang))},R=(e,n="200,",r="full")=>{Array.isArray(e)&&(e=e[0]);const{id:s,service:i}=e;let a;if(!i)return s;if(Array.isArray(e.service)&&e.service.length>0&&(a=i[0]),a){if(a["@id"])return`${a["@id"]}/${r}/${n}/0/default.jpg`;if(a.id)return`${a.id}/${r}/${n}/0/default.jpg`}},L=m("img",{objectFit:"cover"}),P=e=>{const n=t.useRef(null),{contentResource:r,altAsLabel:s,region:i="full"}=e;let a;s&&(a=v(s));const p=f(e,["contentResource","altAsLabel"]),{type:y,id:d,width:T=200,height:$=200,duration:h}=r;t.useEffect(()=>{if(!d&&!n.current||["Image"].includes(y)||!d.includes("m3u8"))return;const c=new g;return n.current&&(c.attachMedia(n.current),c.on(g.Events.MEDIA_ATTACHED,function(){c.loadSource(d)})),c.on(g.Events.ERROR,function(E,b){if(b.fatal)switch(b.type){case g.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${E} network error encountered, try to recover`),c.startLoad();break;case g.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${E} media error encountered, try to recover`),c.recoverMediaError();break;default:c.destroy();break}}),()=>{c&&(c.detachMedia(),c.destroy())}},[d,y]);const A=t.useCallback(()=>{if(!n.current)return;let c=0,E=30;if(h&&(E=h),!d.split("#t=")&&h&&(c=h*.1),d.split("#t=").pop()){const K=d.split("#t=").pop();K&&(c=parseInt(K.split(",")[0]))}const b=n.current;b.autoplay=!0,b.currentTime=c,setTimeout(()=>A(),E*1e3)},[h,d]);t.useEffect(()=>A(),[A]);const ve=R(r,`${T},${$}`,i);switch(y){case"Image":return t.createElement(L,{as:"img",alt:a,css:{width:T,height:$},key:d,src:ve,...p});case"Video":return t.createElement(L,{as:"video",css:{width:T,height:$},disablePictureInPicture:!0,key:d,loop:!0,muted:!0,onPause:A,ref:n,src:d});default:return console.warn(`Resource type: ${y} is not valid or not yet supported in Primitives.`),t.createElement(t.Fragment,null)}},ee=m("a",{}),F=e=>{const{children:n,homepage:r}=e,i=f(e,["children","homepage"]);return t.createElement(t.Fragment,null,r&&r.map(a=>{const l=v(a.label,i.lang);return t.createElement(ee,{"aria-label":n?l:void 0,href:a.id,key:a.id,...i},n||l)}))},te={delimiter:", "},w=t.createContext(void 0),I=()=>{const e=t.useContext(w);if(e===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return e},C=({children:e,initialState:n=te})=>{const r=ne(n,"delimiter");return t.createElement(w.Provider,{value:{delimiter:r}},e)},ne=(e,n)=>Object.hasOwn(e,n)?e[n].toString():void 0,re=m("span",{}),j=e=>{const{as:n,markup:r}=e,{delimiter:s}=I();if(!r)return t.createElement(t.Fragment,null);const a=f(e,["as","markup"]),l=J(v(r,a.lang,s));return t.createElement(re,{as:n,...a,dangerouslySetInnerHTML:l})},x=e=>t.useContext(w)?t.createElement(j,{...e}):t.createElement(C,null,t.createElement(j,{...e})),O=({as:e="dd",lang:n,value:r})=>t.createElement(x,{markup:r,as:e,lang:n}),ae=m("span",{}),ie=({as:e="dd",customValueContent:n,lang:r,value:s})=>{var l;const{delimiter:i}=I(),a=(l=V(s,r))==null?void 0:l.map(p=>t.cloneElement(n,{value:p}));return t.createElement(ae,{as:e,lang:r},a==null?void 0:a.map((p,y)=>[y>0&&`${i}`,t.createElement(t.Fragment,{key:y},p)]))},S=e=>{var p;const{item:n,lang:r,customValueContent:s}=e,{label:i,value:a}=n,l=(p=v(i))==null?void 0:p.replace(" ","-").toLowerCase();return t.createElement("div",{role:"group","data-label":l},t.createElement(M,{as:"dt",label:i,lang:r}),s?t.createElement(ie,{as:"dd",customValueContent:s,value:a,lang:r}):t.createElement(O,{as:"dd",value:a,lang:r}))},q=(e,n)=>Object.hasOwn(e,n)?e[n].toString():void 0;function se(e,n){const r=n.filter(s=>{const{matchingLabel:i}=s,a=Object.keys(s.matchingLabel)[0],l=v(i,a);if(v(e,a)===l)return!0}).map(s=>s.Content);if(Array.isArray(r))return r[0]}const le=m("dl",{}),z=e=>{const{as:n,customValueContent:r,metadata:s}=e;if(!Array.isArray(s))return t.createElement(t.Fragment,null);const i=q(e,"customValueDelimiter"),l=f(e,["as","customValueContent","customValueDelimiter","metadata"]);return t.createElement(C,{...typeof i=="string"?{initialState:{delimiter:i}}:void 0},s.length>0&&t.createElement(le,{as:n,...l},s.map((p,y)=>{const d=r?se(p.label,r):void 0;return t.createElement(S,{customValueContent:d,item:p,key:y,lang:l==null?void 0:l.lang})})))},oe=m("li",{}),ue=m("ul",{}),D=e=>{const{as:n,partOf:r}=e,i=f(e,["as","partOf"]);return t.createElement(ue,{as:n},r&&r.map(a=>{const l=a.label?v(a.label,i.lang):void 0;return t.createElement(oe,{key:a.id},t.createElement("a",{href:a.id,...i},l||a.id))}))},ce=m("li",{}),me=m("ul",{}),_=e=>{const{as:n,rendering:r}=e,i=f(e,["as","rendering"]);return t.createElement(me,{as:n},r&&r.map(a=>{const l=v(a.label,i.lang);return t.createElement(ce,{key:a.id},t.createElement("a",{href:a.id,...i,target:"_blank"},l||a.id))}))},de=m("dl",{}),H=e=>{const{as:n,requiredStatement:r}=e;if(!r)return t.createElement(t.Fragment,null);const s=q(e,"customValueDelimiter"),a=f(e,["as","customValueDelimiter","requiredStatement"]);return t.createElement(C,{...typeof s=="string"?{initialState:{delimiter:s}}:void 0},t.createElement(de,{as:n,...a},t.createElement(S,{item:r,lang:a.lang})))},fe=m("li",{}),pe=m("ul",{}),W=e=>{const{as:n,seeAlso:r}=e,i=f(e,["as","seeAlso"]);return t.createElement(pe,{as:n},r&&r.map(a=>{const l=v(a.label,i.lang);return t.createElement(fe,{key:a.id},t.createElement("a",{href:a.id,...i},l||a.id))}))},N=e=>{const{as:n,summary:r}=e,i=f(e,["as","customValueDelimiter","summary"]);return t.createElement(x,{as:n,markup:r,...i})},G=e=>{const{thumbnail:n,region:r}=e,i=f(e,["thumbnail"]);return t.createElement(t.Fragment,null,n&&n.map(a=>t.createElement(P,{contentResource:a,key:a.id,region:r,...i})))},u=()=>(console.log("Use dot notation to access Primitives.*, ex: Primitives.Label"),null);u.ContentResource=P,u.Homepage=F,u.Label=M,u.Markup=x,u.Metadata=z,u.MetadataItem=S,u.PartOf=D,u.Rendering=_,u.RequiredStatement=H,u.SeeAlso=W,u.Summary=N,u.Thumbnail=G,u.Value=O,o.ContentResource=P,o.Homepage=F,o.Label=M,o.Markup=x,o.Metadata=z,o.MetadataItem=S,o.PartOf=D,o.Rendering=_,o.RequiredStatement=H,o.SeeAlso=W,o.Summary=N,o.Thumbnail=G,o.Value=O,o.default=u,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
