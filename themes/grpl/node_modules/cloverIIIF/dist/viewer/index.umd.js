(function(I,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("react"),require("@iiif/vault"),require("uuid"),require("@radix-ui/react-collapsible"),require("openseadragon"),require("@iiif/vault-helpers"),require("react-error-boundary"),require("@stitches/react"),require("@radix-ui/react-tabs"),require("@radix-ui/react-radio-group"),require("node-webvtt"),require("@radix-ui/react-form"),require("sanitize-html"),require("hls.js"),require("@radix-ui/react-popover"),require("@radix-ui/react-select"),require("@radix-ui/react-switch")):typeof define=="function"&&define.amd?define(["exports","react","@iiif/vault","uuid","@radix-ui/react-collapsible","openseadragon","@iiif/vault-helpers","react-error-boundary","@stitches/react","@radix-ui/react-tabs","@radix-ui/react-radio-group","node-webvtt","@radix-ui/react-form","sanitize-html","hls.js","@radix-ui/react-popover","@radix-ui/react-select","@radix-ui/react-switch"],t):(I=typeof globalThis<"u"?globalThis:I||self,t(I.CloverIIIFViewer={},I.React,I.vault,I.uuid,I.Collapsible,I.OpenSeadragon,I.vaultHelpers,I.reactErrorBoundary,I.react,I.Tabs,I.RadioGroup,I.nodeWebvtt,I.Form$1,I.sanitizeHtml,I.Hls,I.Popover$1,I.Select$1,I.Switch))})(this,function(I,t,ue,te,Mt,ne,zt,Ie,$e,Pt,Ft,Vt,Bt,Ht,B,_t,H,Ot){"use strict";var kt,It,$t,At;function U(e){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>e[r]})}}return n.default=e,Object.freeze(n)}const me=U(Mt),re=U(Pt),oe=U(Ft),ie=U(Bt),K=U(_t),Q=U(H),ae=U(Ot),Nt=e=>{const n=e.toString().split(":"),r=Math.ceil(parseInt(n[0])),i=Math.ceil(parseInt(n[1])),o=Wt(Math.ceil(parseInt(n[2])),2);let l=`${r!==0&&i<10?(i+"").padStart(2,"0"):i}:${o}`;return r!==0&&(l=`${r}:${l}`),l},Ae=e=>{const n=new Date(e*1e3).toISOString().substr(11,8);return Nt(n)},Te=(e,n)=>{if(typeof e!="object"||e===null)return n;for(const r in n)typeof n[r]=="object"&&n[r]!==null&&!Array.isArray(n[r])?(e[r]||(e[r]={}),e[r]=Te(e[r],n[r])):e[r]=n[r];return e},Dt=e=>e.split("").reduce(function(n,r){return n=(n<<5)-n+r.charCodeAt(0),n&n},0),Le=(e,n)=>Object.hasOwn(e,n)?e[n].toString():void 0,Wt=(e,n)=>String(e).padStart(n,"0"),F={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,zoomToFirst:!1,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},ignoreCaptionLabels:[],pages:{show:!0,toggleLabel:"Pages"},informationPanel:{vtt:{autoScroll:{enabled:!0,settings:{behavior:"smooth",block:"center"}}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1,localeText:{contentSearch:{tabLabel:"Search Results",formPlaceholder:"Enter search words",noSearchResults:"No search results",loading:"Loading...",moreResults:"more results"}}};function Me(e){let n={...F.informationPanel.vtt.autoScroll};return typeof e=="object"&&(n="enabled"in e?e:{enabled:!0,settings:e}),e===!1&&(n.enabled=!1),qt(n.settings),n}function qt({behavior:e,block:n}){const r=["auto","instant","smooth"],i=["center","end","nearest","start"];if(!r.includes(e))throw TypeError(`'${e}' not in ${r.join(" | ")}`);if(!i.includes(n))throw TypeError(`'${n}' not in ${i.join(" | ")}`)}const jt=Me((It=(kt=F==null?void 0:F.informationPanel)==null?void 0:kt.vtt)==null?void 0:It.autoScroll),le={activeCanvas:"",activeManifest:"",OSDImageLoaded:!1,collection:{},configOptions:F,customDisplays:[],plugins:[],isAutoScrollEnabled:jt.enabled,isAutoScrolling:!1,isInformationOpen:($t=F==null?void 0:F.informationPanel)==null?void 0:$t.open,showPageNavigation:(At=F==null?void 0:F.pages)==null?void 0:At.show,isLoaded:!1,isUserScrolling:void 0,vault:new ue.Vault,contentSearchVault:new ue.Vault,openSeadragonViewer:null,viewerId:te.v4(),informationPanelCounts:{}},ze=t.createContext(le),Pe=t.createContext(le);function Gt(e,n){switch(n.type){case"updateActiveCanvas":return n.canvasId||(n.canvasId=""),{...e,activeCanvas:n.canvasId};case"updateActiveManifest":return{...e,activeManifest:n.manifestId};case"updateOSDImageLoaded":return{...e,OSDImageLoaded:n.OSDImageLoaded};case"updateAutoScrollAnnotationEnabled":return{...e,isAutoScrollEnabled:n.isAutoScrollEnabled};case"updateAutoScrolling":return{...e,isAutoScrolling:n.isAutoScrolling};case"updateCollection":return{...e,collection:n.collection};case"updateConfigOptions":return{...e,configOptions:Te(e.configOptions,n.configOptions)};case"updateInformationOpen":return{...e,isInformationOpen:n.isInformationOpen};case"updateShowPageNavigation":return{...e,showPageNavigation:n.showPageNavigation};case"updateIsLoaded":return{...e,isLoaded:n.isLoaded};case"updateUserScrolling":return{...e,isUserScrolling:n.isUserScrolling};case"updateOpenSeadragonViewer":return{...e,openSeadragonViewer:n.openSeadragonViewer};case"updateViewerId":return{...e,viewerId:n.viewerId};case"updateInformationPanelCount":{const r=e.informationPanelCounts??{};return r[n.panel]=n.count,{...e,informationPanelCounts:r}}default:throw new Error(`Unhandled action type: ${n.type}`)}}const Ut=({initialState:e=le,children:n})=>{const[r,i]=t.useReducer(Gt,e);return t.createElement(ze.Provider,{value:r},t.createElement(Pe.Provider,{value:i},n))};function k(){const e=t.useContext(ze);if(e===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return e}function M(){const e=t.useContext(Pe);if(e===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return e}const Zt=(e,n)=>{const r=e.get({id:n,type:"Canvas"});return!(r!=null&&r.annotations)||!r.annotations[0]?[]:e.get(r.annotations).filter(o=>!o.items||!o.items.length?!1:o).map(o=>{const a=o.label||{none:["Annotations"]};return{...o,label:a}})},Fe=async(e,n,r,i)=>{if(i==null||i.q==null)return{label:{none:[r]}};const o=`${n}?q=${i.q.trim()}`;let a;try{a=await e.load(o)}catch{return console.log("Could not load content search."),{}}return a.label==null&&(a.label={none:[r]}),a},Ve=(e,n,r,i)=>{var l,c;const o={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},a=s=>{if(s){if(!s.body||!s.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",s);return}let d=s.body;Array.isArray(d)&&(d=d[0]);const h=e.get(d.id);if(!h)return;switch(r){case"painting":return s.target===n.id&&s.motivation&&s.motivation[0]==="painting"&&i.includes(h.type)&&(s.body=h),!!s;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};if(o.canvas=e.get(n),o.canvas&&(o.annotationPage=e.get(o.canvas.items[0]),o.accompanyingCanvas=(l=o.canvas)!=null&&l.accompanyingCanvas?e.get((c=o.canvas)==null?void 0:c.accompanyingCanvas):void 0),o.annotationPage){const s=e.get(o.annotationPage.items).map(h=>({body:e.get(h.body[0].id),motivation:h.motivation,type:"Annotation"})),d=[];s.forEach(h=>{h.body.type==="Choice"?h.body.items.forEach(u=>d.push({...h,id:u.id,body:e.get(u.id)})):d.push(h)}),o.annotations=d.filter(a)}return o},Y=(e,n="en")=>{if(!e)return"";if(!e[n]){const r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return e[n]},se=(e,n)=>{const r=Ve(e,{id:n,type:"Canvas"},"painting",["Image","Sound","Video"]);if(r.annotations.length!==0&&r.annotations&&r.annotations)return r.annotations.map(i=>i==null?void 0:i.body)},Xt=(e,n,r,i)=>{const o=[];if(n.canvas&&n.canvas.thumbnail.length>0){const c=e.get(n.canvas.thumbnail[0]);o.push(c)}if(n.annotations[0]){if(n.annotations[0].thumbnail&&n.annotations[0].thumbnail.length>0){const s=e.get(n.annotations[0].thumbnail[0]);o.push(s)}if(!n.annotations[0].body)return;const c=n.annotations[0].body;c.type==="Image"&&o.push(c)}return o.length===0?void 0:{id:o[0].id,format:o[0].format,type:o[0].type,width:r,height:i}};let Z=window.OpenSeadragon;if(!Z&&(Z=ne,!Z))throw new Error("OpenSeadragon is missing.");const Be="http://www.w3.org/2000/svg";Z.Viewer&&(Z.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo?this._svgOverlayInfo:(this._svgOverlayInfo=new pe(this),this._svgOverlayInfo)});const pe=function(e){const n=this;this._viewer=e,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(Be,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(Be,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){n.resize()}),this._viewer.addHandler("open",function(){n.resize()}),this._viewer.addHandler("rotate",function(){n.resize()}),this._viewer.addHandler("flip",function(){n.resize()}),this._viewer.addHandler("resize",function(){n.resize()}),this.resize()};pe.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));const e=this._viewer.viewport.pixelFromPoint(new Z.Point(0,0),!0),n=this._viewer.viewport.getZoom(!0),r=this._viewer.viewport.getRotation(),i=this._viewer.viewport.getFlip(),o=this._viewer.viewport._containerInnerSize.x;let a=o*n;const l=a;i&&(a=-a,e.x=-e.x+o),this._node.setAttribute("transform","translate("+e.x+","+e.y+") scale("+a+","+l+") rotate("+r+")")},onClick:function(e,n){new Z.MouseTracker({element:e,clickHandler:n}).setTracking(!0)}};const Yt=e=>new pe(e),He=e=>{var r,i;let n={id:typeof e=="string"?e:e.source};if(typeof e=="string"){if(e.includes("#xywh=")){const o=e.split("#xywh=");if(o&&o[1]){const[a,l,c,s]=o[1].split(",").map(d=>Number(d));n={id:o[0],rect:{x:a,y:l,w:c,h:s}}}}else if(e.includes("#t=")){const o=e.split("#t=");o&&o[1]&&(n={id:o[0],t:o[1]})}}else typeof e=="object"&&(((r=e.selector)==null?void 0:r.type)==="PointSelector"?n={id:e.source,point:{x:e.selector.x,y:e.selector.y}}:((i=e.selector)==null?void 0:i.type)==="SvgSelector"&&(n={id:e.source,svg:e.selector.value}));return n},Jt=e=>fetch(`${e.replace(/\/$/,"")}/info.json`).then(n=>n.json()).then(n=>n).catch(n=>{console.error(`The IIIF tilesource ${e.replace(/\/$/,"")}/info.json failed to load: ${n}`)}),Kt=e=>{let n,r;if(Array.isArray(e)&&(n=e[0],n)){let i;"@id"in n?i=n["@id"]:i=n.id,r=i}return r},fe=e=>{var i;let n,r;if(tn(e))n=e,r={};else{const o=JSON.parse(zt.decodeContentState(e));switch(o==null?void 0:o.type){case"SpecificResource":case"Range":case"Annotation":n=o==null?void 0:o.target.partOf[0].id,r={manifest:n,canvas:o==null?void 0:o.target.id};break;case"Canvas":n=o==null?void 0:o.partOf[0].id,r={manifest:n,canvas:o==null?void 0:o.id};break;case"Manifest":n=o==null?void 0:o.id,r={collection:(i=o==null?void 0:o.partOf[0])==null?void 0:i.id,manifest:o==null?void 0:o.id};break;case"Collection":n=o==null?void 0:o.id,r={collection:n};break}}return{resourceId:n,active:r}},Qt=e=>{const{resourceId:n,active:r}=fe(e);return r.collection||r.manifest||n},Rt=(e,n)=>{const r=n.items.map(a=>a.id),{active:i}=fe(e),o=i.canvas;return r.includes(o)?o:r[0]},en=(e,n)=>{const{active:r}=fe(e),i=r.manifest,o=n.items.filter(a=>a.type==="Manifest").map(a=>a.id);return o.length==0?null:o.includes(i)?i:o[0]},tn=e=>{try{new URL(e)}catch{return!1}return!0};var R=(e=>(e.TiledImage="tiledImage",e.SimpleImage="simpleImage",e))(R||{});function _e(e,n,r,i,o){if(!e)return;const a=1/n.width;i.forEach(l=>{if(!l.target)return;const c=He(l.target),{point:s,rect:d,svg:h}=c;if(d){const{x:u,y,w:f,h:b}=d;rn(e,u*a,y*a,f*a,b*a,r,o)}if(s){const{x:u,y}=s,f=`
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
          <circle cx="${u}" cy="${y}" r="20" />
        </svg>
      `;Oe(e,f,r,a,o)}h&&Oe(e,h,r,a,o)})}function nn(e,n,r){let i,o,a=40,l=40;n.rect&&(i=n.rect.x,o=n.rect.y,a=n.rect.w,l=n.rect.h),n.point&&(i=n.point.x,o=n.point.y);const c=1/e.width;return new ne.Rect(i*c-a*c/2*(r-1),o*c-l*c/2*(r-1),a*c*r,l*c*r)}function rn(e,n,r,i,o,a,l){const c=new ne.Rect(n,r,i,o),s=document.createElement("div");if(a){const{backgroundColor:d,opacity:h,borderType:u,borderColor:y,borderWidth:f}=a;s.style.backgroundColor=d,s.style.opacity=h,s.style.border=`${u} ${f} ${y}`,s.className=l}e.addOverlay(s,c)}function on(e){if(!e)return null;const n=document.createElement("template");return n.innerHTML=e.trim(),n.content.children[0]}function Oe(e,n,r,i,o){const a=on(n);if(a)for(const l of a.children)Ne(e,l,r,i,o)}function Ne(e,n,r,i,o){var a;if(n.nodeName==="#text")ln(n);else{const l=an(n,r,i),c=Yt(e);c.node().append(l),(a=c._svg)==null||a.setAttribute("class",o),n.childNodes.forEach(s=>{Ne(e,s,r,i,o)})}}function an(e,n,r){let i=!1,o=!1,a=!1,l=!1;const c=document.createElementNS("http://www.w3.org/2000/svg",e.nodeName);if(e.attributes.length>0)for(let s=0;s<e.attributes.length;s++){const d=e.attributes[s];switch(d.name){case"fill":a=!0;break;case"stroke":i=!0;break;case"stroke-width":o=!0;break;case"fill-opacity":l=!0;break}c.setAttribute(d.name,d.textContent)}return i||(c.style.stroke=n==null?void 0:n.borderColor),o||(c.style.strokeWidth=n==null?void 0:n.borderWidth),a||(c.style.fill=n==null?void 0:n.backgroundColor),l||(c.style.fillOpacity=n==null?void 0:n.opacity),c.setAttribute("transform",`scale(${r})`),c}function ln(e){e.textContent&&(e.textContent.includes(`
`)||console.log("nodeName:",e.nodeName,", textContent:",e.textContent,", childNodes.length",e.childNodes.length))}const sn=e=>{const n=Array.isArray(e==null?void 0:e.service)&&(e==null?void 0:e.service.length)>0,r=n?Kt(e==null?void 0:e.service):e==null?void 0:e.id,i=n?R.TiledImage:R.SimpleImage;return{uri:r,imageType:i}},cn=(e,n)=>{const r=n?R.TiledImage:R.SimpleImage;return{uri:e,imageType:r}};function De(e,n){if(!e)return;n.startsWith(".")||(n="."+n);const r=document.querySelectorAll(n);r&&r.forEach(i=>e.removeOverlay(i))}function he(e,n,r,i){const o=He(r),{point:a,rect:l,svg:c}=o;if(a||l||c){const s=nn(i,o,n);e==null||e.viewport.fitBounds(s)}}function dn(e,n,r,i,o){var l;if(!(n!=null&&n.items)||(n==null?void 0:n.items.length)===0)return;const a=[];n.items.forEach(c=>{const s=e.get(c.id);typeof s.target=="string"&&s.target.startsWith(i.id)&&a.push(s)}),r&&((l=o.contentSearch)!=null&&l.overlays)&&_e(r,i,o.contentSearch.overlays,a,"content-search-overlay")}const ge=209,un={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${ge} 100% 38.2%)`,accentMuted:`hsl(${ge} 80% 61.8%)`,accentAlt:`hsl(${ge} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},ve={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:m,css:xi,keyframes:be,createTheme:wi}=$e.createStitches({theme:un,media:ve}),mn=m("div",{display:"flex",flexDirection:"column",alignItems:"center"}),pn=m("p",{fontWeight:"bold",fontSize:"x-large"}),fn=m("span",{fontSize:"medium"}),We=({error:e})=>{const{message:n}=e;return t.createElement(mn,{role:"alert"},t.createElement(pn,{"data-testid":"headline"},"Something went wrong"),n&&t.createElement(fn,null,`Error message: ${n}`," "))},qe=m("div",{position:"relative",zIndex:"0"}),je=m("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden","@sm":{flexDirection:"column"}}),Ge=m("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),Ue=m(me.Trigger,{display:"none",border:"none",padding:"0",transition:"$all",opacity:"1",background:"#6663",margin:"1rem 0",borderRadius:"6px","&[data-information-panel='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",fontSize:"0.8333em",justifyContent:"center",padding:"0.5rem",fontFamily:"inherit"}}}),Ze=m(me.Content,{width:"100%",display:"flex"}),hn=m("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),gn=m("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${je}`]:{flexGrow:"1"},[`& ${Ge}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${qe}`]:{display:"none"},[`& ${Ue}`]:{margin:"1rem"},[`& ${Ze}`]:{height:"100%"}}}}),vn=m(re.Root,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),bn=m(re.List,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid #6663","@sm":{margin:"0 1rem"}}),ce=m(re.Trigger,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),de=m(re.Content,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),yn=m(({handleScroll:e,children:n,className:r})=>t.createElement("div",{className:r,onScroll:e},n),{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),Xe={position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"inherit",border:"none",background:"none"},Ye=m("button",{textAlign:"left","&:hover":{color:"$accent"}}),En=m("div",{display:"flex",flexDirection:"column",width:"100%"}),xn=m("div",{...Xe}),wn=m("div",{"&:hover":{color:"$accent"}}),Je=({value:e,handleClick:n})=>t.createElement(Ye,{onClick:n},e),Sn=({value:e,handleClick:n})=>t.createElement(wn,{dangerouslySetInnerHTML:{__html:e},onClick:n}),Cn=()=>{function e(o){return o.map(a=>{const l=a.identifier||te.v4();return{...a,identifier:l}})}function n(o){var s;const a=[],l=[],c=e(o);for(const d of c){for(;l.length>0&&l[l.length-1].end<=d.start;)l.pop();l.length>0?(l[l.length-1].children||(l[l.length-1].children=[]),(s=l[l.length-1].children)==null||s.push(d),l.push(d)):(a.push(d),l.push(d))}return a}function r(o,a=[]){return a.some(l=>o.start>=l.start&&o.end<=l.end)}function i(o=[]){return o.sort((a,l)=>a.start-l.start)}return{addIdentifiersToParsedCues:e,createNestedCues:n,isChild:r,orderCuesByTime:i}},Ke=be({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),kn=m(oe.Root,{display:"flex",flexDirection:"column",width:"100%"}),Qe=m(oe.Item,{...Xe,"@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{backgroundColor:"#6663","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:Ke,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:Ke,boxSizing:"content-box","@sm":{content:"unset"}}}}),In=750,$n=e=>{for(;e&&e!==document.body;){const n=window.getComputedStyle(e).overflowY;if(n!=="visible"&&n!=="hidden"&&e.scrollHeight>e.clientHeight)return e;e=e.parentNode}return null},An=({label:e,start:n,end:r})=>{var f,b;const i=M(),{configOptions:o,isAutoScrollEnabled:a,isUserScrolling:l}=k(),c=(b=(f=o==null?void 0:o.informationPanel)==null?void 0:f.vtt)==null?void 0:b.autoScroll,[s,d]=t.useState(!1),h=t.useRef(null),u=document.getElementById("clover-iiif-video");t.useEffect(()=>(u==null||u.addEventListener("timeupdate",()=>{const{currentTime:g}=u;d(n<=g&&g<r)}),()=>document.removeEventListener("timeupdate",()=>{})),[r,n,u]),t.useEffect(()=>{var p;const g=v=>{i({type:"updateAutoScrolling",isAutoScrolling:!0}),v(),setTimeout(()=>i({type:"updateAutoScrolling",isAutoScrolling:!1}),In)};if(a&&s&&h.current&&!l){const v=h.current;if(v&&v instanceof HTMLElement){const E=$n(v);if(E&&E instanceof HTMLElement){let S;switch((p=c==null?void 0:c.settings)==null?void 0:p.block){case"center":const $=E.getBoundingClientRect();S=v.offsetTop+v.offsetHeight-Math.floor(($.bottom-$.top)/2);break;case"end":S=v.offsetTop+v.offsetHeight-(E.clientHeight-v.clientHeight)+2;break;default:S=v.offsetTop-2;break}g(()=>{var $;return E.scrollTo({top:S,left:0,behavior:($=c==null?void 0:c.settings)==null?void 0:$.behavior})})}}}},[c,s,l,a,i]);const y=()=>{u&&(u.pause(),u.currentTime=n,u.play())};return t.createElement(Qe,{ref:h,"aria-checked":s,"data-testid":"information-panel-cue",onClick:y,value:e},e,t.createElement("strong",null,Ae(n)))},Tn=m("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${Qe}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),Re=({items:e})=>t.createElement(Tn,null,e.map(n=>{const{text:r,start:i,end:o,children:a,identifier:l}=n;return t.createElement("li",{key:l},t.createElement(An,{label:r,start:i,end:o}),a&&t.createElement(Re,{items:a}))})),Ln=({label:e,vttUri:n})=>{const[r,i]=t.useState([]),{createNestedCues:o,orderCuesByTime:a}=Cn(),[l,c]=t.useState();return t.useEffect(()=>{n&&fetch(n,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(s=>s.text()).then(s=>{const d=Vt.parse(s).cues,h=a(d),u=o(h);i(u)}).catch(s=>{console.error(n,s.toString()),c(s)})},[n]),t.createElement(kn,{"data-testid":"annotation-item-vtt","aria-label":`navigate ${Y(e,"en")}`},l&&t.createElement("div",{"data-testid":"error-message"},"Network Error: ",l.toString()),t.createElement(Re,{items:r}))},Mn=({caption:e,handleClick:n,imageUri:r})=>t.createElement(Ye,{onClick:n},t.createElement("img",{src:r,alt:`A visual annotation for ${e}`}),t.createElement("span",null,e)),zn=({annotation:e})=>{var f,b;const{target:n}=e,r=k(),{openSeadragonViewer:i,vault:o,activeCanvas:a,configOptions:l}=r,c=e.body.map(g=>o.get(g.id)),s=((f=c.find(g=>g.format))==null?void 0:f.format)||"",d=((b=c.find(g=>g.value))==null?void 0:b.value)||"",h=o.get({id:a,type:"Canvas"});function u(){var p;if(!n)return;const g=((p=l.annotationOverlays)==null?void 0:p.zoomLevel)||1;he(i,g,n,h)}function y(){var g,p;switch(s){case"text/plain":return t.createElement(Je,{value:d,handleClick:u});case"text/html":return t.createElement(Sn,{value:d,handleClick:u});case"text/vtt":return t.createElement(Ln,{label:c[0].label,vttUri:c[0].id||""});case((g=s.match(/^image\//))==null?void 0:g.input):const v=((p=c.find(E=>{var S;return!((S=E.id)!=null&&S.includes("vault://"))}))==null?void 0:p.id)||"";return t.createElement(Mn,{caption:d,handleClick:u,imageUri:v});default:return t.createElement(Je,{value:d,handleClick:u})}}return t.createElement(xn,null,y())},Pn=({annotationPage:e})=>{var o;const n=k(),{vault:r}=n;if(!e||!e.items||((o=e.items)==null?void 0:o.length)===0)return t.createElement(t.Fragment,null);const i=e.items.map(a=>r.get(a.id));return i?t.createElement(En,{"data-testid":"annotation-page"},i==null?void 0:i.map(a=>t.createElement(zn,{key:a.id,annotation:a}))):t.createElement(t.Fragment,null)},Fn=m("button",{textAlign:"left","&:hover":{color:"$accent"}}),Vn=m("li",{margin:"0.25rem 0"}),Bn=m("ol",{listStyleType:"auto",marginBottom:"1rem",listStylePosition:"inside"}),Hn=m("div",{margin:"0.5rem 1.618rem"}),_n=m("div",{fontWeight:"bold"}),On=m("div",{marginBottom:"1rem"}),Nn=({value:e,handleClick:n,target:r,canvas:i})=>t.createElement(Fn,{onClick:n,"data-target":r,"data-canvas":i},e),Dn=({annotation:e,activeContentSearchTarget:n,setActiveContentSearchTarget:r})=>{var S,$,A;const i=M(),o=k(),{openSeadragonViewer:a,vault:l,contentSearchVault:c,activeCanvas:s,configOptions:d,OSDImageLoaded:h}=o,u=l.get({id:s,type:"Canvas"}),f=((S=e.body.map(C=>c.get(C.id)).find(C=>C.value))==null?void 0:S.value)||"";let b;e.target&&typeof e.target=="string"&&(b=e.target);let g;if(b){const C=b.split("#xywh");C.length>1&&(g=C[0])}const p=((A=($=d.contentSearch)==null?void 0:$.overlays)==null?void 0:A.zoomLevel)||1;t.useEffect(()=>{h&&a&&e.target&&e.target==n&&he(a,p,b,u)},[a,h]);function v(C){if(!a)return;const O=JSON.parse(C.target.dataset.target),N=C.target.dataset.canvas;s===N?he(a,p,b,u):(i({type:"updateOSDImageLoaded",OSDImageLoaded:!1}),i({type:"updateActiveCanvas",canvasId:N}),r(O))}const E=JSON.stringify(b);return t.createElement(Vn,null,t.createElement(Nn,{target:E,canvas:g,value:f,handleClick:v}))};let et=!1;const Wn=({annotationPage:e})=>{var y,f,b,g;const n=k(),{contentSearchVault:r,configOptions:i}=n,[o,a]=t.useState(),l=(y=i.contentSearch)==null?void 0:y.searchResultsLimit,c=!!((f=i.contentSearch)!=null&&f.zoomToFirst),s=(b=i.localeText)==null?void 0:b.contentSearch;function d(p){const v={};return p.items.forEach(E=>{const S=r.get(E.id);let $="";if(S.label){const A=Y(S.label);A&&($=A[0])}v[$]==null&&(v[$]=[]),v[$].push(S),!et&&c&&typeof S.target=="string"&&(a(S.target),et=!0)}),v}function h(p){return(l?p.slice(0,l):p).map((E,S)=>t.createElement(Dn,{key:S,annotation:E,activeContentSearchTarget:o,setActiveContentSearchTarget:a}))}function u(p){if(l){const v=p.length-l;if(v>0)return t.createElement(On,null,v," ",s==null?void 0:s.moreResults)}}return!e||!e.items||((g=e.items)==null?void 0:g.length)===0?t.createElement("p",null,s==null?void 0:s.noSearchResults):t.createElement(t.Fragment,null,Object.entries(d(e)).map(([p,v],E)=>t.createElement("div",{key:E},t.createElement(_n,{className:"content-search-results-title"},p),t.createElement(Bn,{className:"content-search-results"},h(v)),u(v))))},qn=m("div",{".content-search-form":{display:"flex",marginBottom:"1rem"},input:{padding:".25rem",marginRight:"1rem"}}),jn=m("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),Gn=({searchServiceUrl:e,setContentSearchResource:n,setLoading:r})=>{var f;const i=k(),{contentSearchVault:o,openSeadragonViewer:a,configOptions:l}=i,c=(f=l.localeText)==null?void 0:f.contentSearch,s=l.initialSearch,[d,h]=t.useState(s);async function u(b){b&&b.preventDefault();const g=c==null?void 0:c.tabLabel;if(a&&e){if(!d||d.trim()===""){n({label:{none:[g]}});return}r(!0),Fe(o,e,g,{q:d}).then(p=>{n(p),r(!1)})}}const y=b=>{b.preventDefault(),h(b.target.value)};return t.useEffect(()=>{s&&(h(s),u(null))},[a]),t.createElement(qn,null,t.createElement(ie.Root,{onSubmit:u,className:"content-search-form"},t.createElement(ie.Field,{className:"FormField",name:"searchTerms",onChange:y},t.createElement(ie.Control,{placeholder:c==null?void 0:c.formPlaceholder})),t.createElement(ie.Submit,{asChild:!0},t.createElement(jn,{type:"submit"},t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Search"),t.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"}))))))},Un=({searchServiceUrl:e,setContentSearchResource:n,activeCanvas:r,annotationPage:i})=>{const[o,a]=t.useState(!1);return t.createElement(Hn,null,t.createElement(Gn,{searchServiceUrl:e,setContentSearchResource:n,activeCanvas:r,setLoading:a}),!o&&t.createElement(Wn,{annotationPage:i}),o&&t.createElement("span",null,"Loading..."))},Zn=m("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),Xn=m("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),tt=(e,n="none")=>{if(!e)return null;if(typeof e=="string")return[e];if(!e[n]){const r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return!e[n]||!Array.isArray(e[n])?null:e[n]},P=(e,n="none",r=", ")=>{const i=tt(e,n);return Array.isArray(i)?i.join(`${r}`):i};function Yn(e){return{__html:Jn(e)}}function _(e,n){const r=Object.keys(e).filter(o=>n.includes(o)?null:o),i=new Object;return r.forEach(o=>{i[o]=e[o]}),i}function Jn(e){return Ht(e,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const Kn=m("span",{}),j=e=>{const{as:n,label:r}=e,o=_(e,["as","label"]);return t.createElement(Kn,{as:n,...o},P(r,o.lang))},Qn=(e,n="200,",r="full")=>{Array.isArray(e)&&(e=e[0]);const{id:i,service:o}=e;let a;if(!o)return i;if(Array.isArray(e.service)&&e.service.length>0&&(a=o[0]),a){if(a["@id"])return`${a["@id"]}/${r}/${n}/0/default.jpg`;if(a.id)return`${a.id}/${r}/${n}/0/default.jpg`}},nt=m("img",{objectFit:"cover"}),Rn=e=>{const n=t.useRef(null),{contentResource:r,altAsLabel:i,region:o="full"}=e;let a;i&&(a=P(i));const c=_(e,["contentResource","altAsLabel"]),{type:s,id:d,width:h=200,height:u=200,duration:y}=r;t.useEffect(()=>{if(!d&&!n.current||["Image"].includes(s)||!d.includes("m3u8"))return;const g=new B;return n.current&&(g.attachMedia(n.current),g.on(B.Events.MEDIA_ATTACHED,function(){g.loadSource(d)})),g.on(B.Events.ERROR,function(p,v){if(v.fatal)switch(v.type){case B.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${p} network error encountered, try to recover`),g.startLoad();break;case B.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${p} media error encountered, try to recover`),g.recoverMediaError();break;default:g.destroy();break}}),()=>{g&&(g.detachMedia(),g.destroy())}},[d,s]);const f=t.useCallback(()=>{if(!n.current)return;let g=0,p=30;if(y&&(p=y),!d.split("#t=")&&y&&(g=y*.1),d.split("#t=").pop()){const E=d.split("#t=").pop();E&&(g=parseInt(E.split(",")[0]))}const v=n.current;v.autoplay=!0,v.currentTime=g,setTimeout(()=>f(),p*1e3)},[y,d]);t.useEffect(()=>f(),[f]);const b=Qn(r,`${h},${u}`,o);switch(s){case"Image":return t.createElement(nt,{as:"img",alt:a,css:{width:h,height:u},key:d,src:b,...c});case"Video":return t.createElement(nt,{as:"video",css:{width:h,height:u},disablePictureInPicture:!0,key:d,loop:!0,muted:!0,onPause:f,ref:n,src:d});default:return console.warn(`Resource type: ${s} is not valid or not yet supported in Primitives.`),t.createElement(t.Fragment,null)}},er=m("a",{}),tr=e=>{const{children:n,homepage:r}=e,o=_(e,["children","homepage"]);return t.createElement(t.Fragment,null,r&&r.map(a=>{const l=P(a.label,o.lang);return t.createElement(er,{"aria-label":n?l:void 0,href:a.id,key:a.id,...o},n||l)}))},nr={delimiter:", "},ye=t.createContext(void 0),rt=()=>{const e=t.useContext(ye);if(e===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return e},Ee=({children:e,initialState:n=nr})=>{const r=rr(n,"delimiter");return t.createElement(ye.Provider,{value:{delimiter:r}},e)},rr=(e,n)=>Object.hasOwn(e,n)?e[n].toString():void 0,or=m("span",{}),ot=e=>{const{as:n,markup:r}=e,{delimiter:i}=rt();if(!r)return t.createElement(t.Fragment,null);const a=_(e,["as","markup"]),l=Yn(P(r,a.lang,i));return t.createElement(or,{as:n,...a,dangerouslySetInnerHTML:l})},it=e=>t.useContext(ye)?t.createElement(ot,{...e}):t.createElement(Ee,null,t.createElement(ot,{...e})),ir=({as:e="dd",lang:n,value:r})=>t.createElement(it,{markup:r,as:e,lang:n}),ar=m("span",{}),lr=({as:e="dd",customValueContent:n,lang:r,value:i})=>{var l;const{delimiter:o}=rt(),a=(l=tt(i,r))==null?void 0:l.map(c=>t.cloneElement(n,{value:c}));return t.createElement(ar,{as:e,lang:r},a==null?void 0:a.map((c,s)=>[s>0&&`${o}`,t.createElement(t.Fragment,{key:s},c)]))},at=e=>{var c;const{item:n,lang:r,customValueContent:i}=e,{label:o,value:a}=n,l=(c=P(o))==null?void 0:c.replace(" ","-").toLowerCase();return t.createElement("div",{role:"group","data-label":l},t.createElement(j,{as:"dt",label:o,lang:r}),i?t.createElement(lr,{as:"dd",customValueContent:i,value:a,lang:r}):t.createElement(ir,{as:"dd",value:a,lang:r}))};function sr(e,n){const r=n.filter(i=>{const{matchingLabel:o}=i,a=Object.keys(i.matchingLabel)[0],l=P(o,a);if(P(e,a)===l)return!0}).map(i=>i.Content);if(Array.isArray(r))return r[0]}const cr=m("dl",{}),dr=e=>{const{as:n,customValueContent:r,metadata:i}=e;if(!Array.isArray(i))return t.createElement(t.Fragment,null);const o=Le(e,"customValueDelimiter"),l=_(e,["as","customValueContent","customValueDelimiter","metadata"]);return t.createElement(Ee,{...typeof o=="string"?{initialState:{delimiter:o}}:void 0},i.length>0&&t.createElement(cr,{as:n,...l},i.map((c,s)=>{const d=r?sr(c.label,r):void 0;return t.createElement(at,{customValueContent:d,item:c,key:s,lang:l==null?void 0:l.lang})})))};m("li",{}),m("ul",{});const ur=m("li",{}),mr=m("ul",{}),pr=e=>{const{as:n,rendering:r}=e,o=_(e,["as","rendering"]);return t.createElement(mr,{as:n},r&&r.map(a=>{const l=P(a.label,o.lang);return t.createElement(ur,{key:a.id},t.createElement("a",{href:a.id,...o,target:"_blank"},l||a.id))}))},fr=m("dl",{}),hr=e=>{const{as:n,requiredStatement:r}=e;if(!r)return t.createElement(t.Fragment,null);const i=Le(e,"customValueDelimiter"),a=_(e,["as","customValueDelimiter","requiredStatement"]);return t.createElement(Ee,{...typeof i=="string"?{initialState:{delimiter:i}}:void 0},t.createElement(fr,{as:n,...a},t.createElement(at,{item:r,lang:a.lang})))},gr=m("li",{}),vr=m("ul",{}),br=e=>{const{as:n,seeAlso:r}=e,o=_(e,["as","seeAlso"]);return t.createElement(vr,{as:n},r&&r.map(a=>{const l=P(a.label,o.lang);return t.createElement(gr,{key:a.id},t.createElement("a",{href:a.id,...o},l||a.id))}))},yr=e=>{const{as:n,summary:r}=e,o=_(e,["as","customValueDelimiter","summary"]);return t.createElement(it,{as:n,markup:r,...o})},lt=e=>{const{thumbnail:n,region:r}=e,o=_(e,["thumbnail"]);return t.createElement(t.Fragment,null,n&&n.map(a=>t.createElement(Rn,{contentResource:a,key:a.id,region:r,...o})))},Er=({homepage:e})=>(e==null?void 0:e.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"Homepage"),t.createElement(tr,{homepage:e})),xr=({id:e,htmlLabel:n,parent:r="manifest"})=>t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},n),t.createElement("a",{href:e,target:"_blank",id:`iiif-${r}-id`},e)),wr=({metadata:e,parent:n="manifest"})=>e?t.createElement(t.Fragment,null,t.createElement(dr,{metadata:e,id:`iiif-${n}-metadata`})):t.createElement(t.Fragment,null),Sr=({rendering:e})=>(e==null?void 0:e.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"Alternate formats"),t.createElement(pr,{rendering:e})),Cr=({requiredStatement:e,parent:n="manifest"})=>e?t.createElement(t.Fragment,null,t.createElement(hr,{requiredStatement:e,id:`iiif-${n}-required-statement`})):t.createElement(t.Fragment,null),kr=({rights:e})=>e?t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"Rights"),t.createElement("a",{href:e,target:"_blank"},e)):t.createElement(t.Fragment,null),Ir=({seeAlso:e})=>(e==null?void 0:e.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"See Also"),t.createElement(br,{seeAlso:e})),$r=({summary:e,parent:n="manifest"})=>e?t.createElement(t.Fragment,null,t.createElement(yr,{summary:e,as:"p",id:`iiif-${n}-summary`})):t.createElement(t.Fragment,null),Ar=({label:e,thumbnail:n})=>(n==null?void 0:n.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement(lt,{altAsLabel:e||{none:["resource"]},thumbnail:n,style:{backgroundColor:"#6663",objectFit:"cover"}})),Tr=()=>{const e=k(),{activeManifest:n,vault:r}=e,[i,o]=t.useState(),[a,l]=t.useState([]),[c,s]=t.useState([]),[d,h]=t.useState([]),[u,y]=t.useState([]);return t.useEffect(()=>{var b,g,p,v;const f=r.get(n);o(f),((b=f.homepage)==null?void 0:b.length)>0&&l(r.get(f.homepage)),((g=f.seeAlso)==null?void 0:g.length)>0&&s(r.get(f.seeAlso)),((p=f.rendering)==null?void 0:p.length)>0&&h(r.get(f.rendering)),((v=f.thumbnail)==null?void 0:v.length)>0&&y(r.get(f.thumbnail))},[n,r]),i?t.createElement(Xn,null,t.createElement(Zn,null,t.createElement(Ar,{thumbnail:u,label:i.label}),t.createElement($r,{summary:i.summary}),t.createElement(wr,{metadata:i.metadata}),t.createElement(Cr,{requiredStatement:i.requiredStatement}),t.createElement(kr,{rights:i.rights}),t.createElement(Er,{homepage:a}),t.createElement(Ir,{seeAlso:c}),t.createElement(Sr,{rendering:d}),t.createElement(xr,{id:i.id,htmlLabel:"IIIF Manifest"}))):t.createElement(t.Fragment,null)};function Lr(e){const n=[];return e.forEach(r=>{var i;(i=r.informationPanel)!=null&&i.component&&n.push(r)}),{pluginsWithInfoPanel:n}}const Mr=1500,zr=({activeCanvas:e,annotationResources:n,searchServiceUrl:r,setContentSearchResource:i,contentSearchResource:o})=>{const a=M(),l=k(),{isAutoScrolling:c,configOptions:{informationPanel:s},configOptions:d,isUserScrolling:h,vault:u,plugins:y,activeManifest:f,openSeadragonViewer:b,informationPanelCounts:g}=l,p=u.get({id:e,type:"Canvas"}),[v,E]=t.useState(),S=s==null?void 0:s.renderAbout,$=s==null?void 0:s.renderAnnotation,A=s==null?void 0:s.renderContentSearch,{pluginsWithInfoPanel:C}=Lr(y);function O(w,z){var D,W;const V=(D=w==null?void 0:w.informationPanel)==null?void 0:D.component;return V===void 0?t.createElement(t.Fragment,null):t.createElement(de,{key:z,value:w.id},t.createElement(V,{...(W=w==null?void 0:w.informationPanel)==null?void 0:W.componentProps,activeManifest:f,canvas:p,viewerConfigOptions:d,openSeadragonViewer:b,useViewerDispatch:M,useViewerState:k}))}t.useEffect(()=>{if(!v)if(s!=null&&s.defaultTab){const w=["manifest-about","manifest-content-search"];p.annotations.length>0&&p.annotations.forEach(z=>w.push(z.id)),w.includes(s==null?void 0:s.defaultTab)?E(s.defaultTab):E("manifest-about")}else S?E("manifest-about"):A?E("manifest-content-search"):n&&(n==null?void 0:n.length)>0&&E(n[0].id)},[s==null?void 0:s.defaultTab,e,v,S,A,n,o,p==null?void 0:p.annotations,y]);function N(){if(!c){clearTimeout(h);const w=setTimeout(()=>{a({type:"updateUserScrolling",isUserScrolling:void 0})},Mr);a({type:"updateUserScrolling",isUserScrolling:w})}}const q=w=>{E(w)};return t.createElement(vn,{"data-testid":"information-panel",defaultValue:v,onValueChange:q,orientation:"horizontal",value:v,className:"clover-viewer-information-panel"},t.createElement(bn,{"aria-label":"select chapter","data-testid":"information-panel-list"},A&&o&&t.createElement(ce,{value:"manifest-content-search"},t.createElement(j,{label:o.label})),$&&n&&n.map((w,z)=>t.createElement(ce,{key:z,value:w.id},t.createElement(j,{label:w.label}))),C&&C.map((w,z)=>{var x;const V=P((x=w.informationPanel)==null?void 0:x.label),D=g[w.id]?" ("+g[w.id]+")":"",W={none:[V+D]};return t.createElement(ce,{key:z,value:w.id},t.createElement(j,{label:W}))}),S&&t.createElement(ce,{value:"manifest-about"},"About")),t.createElement(yn,{handleScroll:N},A&&o&&t.createElement(de,{value:"manifest-content-search"},t.createElement(Un,{searchServiceUrl:r,setContentSearchResource:i,activeCanvas:e,annotationPage:o})),$&&n&&n.map(w=>t.createElement(de,{key:w.id,value:w.id},t.createElement(Pn,{annotationPage:w}))),C&&C.map((w,z)=>O(w,z)),S&&t.createElement(de,{value:"manifest-about"},t.createElement(Tr,null))))},st=m("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),Pr=m("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),xe=m("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),Fr=m("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),Vr=m("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${st}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),Br=(e,n)=>{t.useEffect(()=>{function r(i){i.key===e&&n()}return window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r)},[])},Hr=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Arrow Back"),t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),_r=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Arrow Forward"),t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),Or=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Close"),t.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Nr=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Search"),t.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),Dr=({handleCanvasToggle:e,handleFilter:n,activeIndex:r,canvasLength:i})=>{const[o,a]=t.useState(!1),[l,c]=t.useState(!1),[s,d]=t.useState(!1);t.useEffect(()=>{d(r===0),r===i-1?c(!0):c(!1)},[r,i]),Br("Escape",()=>{a(!1),n("")});const h=()=>{a(y=>!y),n("")},u=y=>n(y.target.value);return t.createElement(Vr,{isToggle:o},t.createElement(st,null,o&&t.createElement(Pr,{autoFocus:!0,onChange:u,placeholder:"Search"}),!o&&t.createElement(Fr,null,t.createElement(xe,{onClick:()=>e(-1),disabled:s,type:"button"},t.createElement(Hr,null)),t.createElement("span",null,r+1," of ",i),t.createElement(xe,{onClick:()=>e(1),disabled:l,type:"button"},t.createElement(_r,null))),t.createElement(xe,{onClick:h,type:"button"},o?t.createElement(Or,null):t.createElement(Nr,null))))},Wr=m(oe.Root,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"}),qr=()=>t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),jr=()=>t.createElement(t.Fragment,null,t.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),t.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),t.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),Gr=()=>t.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),Ur=()=>t.createElement(t.Fragment,null,t.createElement("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})),Zr=()=>t.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),Xr=()=>t.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"}),ct=m("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),Yr=({children:e})=>t.createElement("title",null,e),T=e=>t.createElement(ct,{...e,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},e.children);T.Title=Yr,T.Add=qr,T.Audio=jr,T.Close=Gr,T.Download=Ur,T.Image=Zr,T.Video=Xr;const Jr=be({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),Kr=be({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),dt=m(K.Arrow,{fill:"$secondaryAlt"}),Qr=m(K.Close,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),Rr=m(K.Content,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:Kr},'&[data-side="bottom"]':{animationName:Jr},'&[data-align="end"]':{[`& ${dt}`]:{margin:"0 0.7rem"}}}),eo=m(K.Trigger,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),to=m(K.Root,{boxSizing:"content-box"}),no=e=>t.createElement(eo,{...e},e.children),ro=e=>t.createElement(Rr,{...e},t.createElement(dt,null),t.createElement(Qr,null,t.createElement(T,{isSmall:!0},t.createElement(T.Close,null))),e.children),X=({children:e})=>t.createElement(to,null,e);X.Trigger=no,X.Content=ro;const we=m("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"5px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${ct}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),Se=m("span",{display:"flex"}),oo=m("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),io=m("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),ao=m(oe.Item,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${Se}`]:{position:"absolute",right:"0",bottom:"0",[`& ${we}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${Se}`]:{[`& ${we}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700"}}}),lo=({type:e})=>{switch(e){case"Sound":return t.createElement(T.Audio,null);case"Image":return t.createElement(T.Image,null);case"Video":return t.createElement(T.Video,null);default:return t.createElement(T.Image,null)}},so=({canvas:e,canvasIndex:n,isActive:r,thumbnail:i,type:o,handleChange:a})=>t.createElement(ao,{"aria-checked":r,"data-testid":"media-thumbnail","data-canvas":n,onClick:()=>a(e.id),value:e.id},t.createElement("figure",null,t.createElement("div",null,(i==null?void 0:i.id)&&t.createElement("img",{src:i.id,alt:e!=null&&e.label?Y(e.label):""}),t.createElement(Se,null,t.createElement(we,{isIcon:!0,"data-testid":"thumbnail-tag"},t.createElement(oo,null),t.createElement(T,{"aria-label":o},t.createElement(lo,{type:o})),["Video","Sound"].includes(o)&&t.createElement(io,null,Ae(e.duration))))),(e==null?void 0:e.label)&&t.createElement("figcaption",{"data-testid":"fig-caption"},t.createElement(j,{label:e.label})))),co=e=>e.body?e.body.type:"Image",uo=({items:e})=>{const n=M(),r=k(),{activeCanvas:i,vault:o}=r,[a,l]=t.useState(""),[c,s]=t.useState([]),[d,h]=t.useState(0),u=t.useRef(null),y="painting",f=p=>{i!==p&&n({type:"updateActiveCanvas",canvasId:p})};t.useEffect(()=>{if(!c.length){const p=["Image","Sound","Video"],v=e.map(E=>Ve(o,E,y,p)).filter(E=>E.annotations.length>0);s(v)}},[e,c.length,o]),t.useEffect(()=>{c.forEach((p,v)=>{p!=null&&p.canvas&&p.canvas.id===i&&h(v)})},[i,c]),t.useEffect(()=>{const p=document.querySelector(`[data-canvas="${d}"]`);if(p instanceof HTMLElement&&u.current){const v=p.offsetLeft-u.current.offsetWidth/2+p.offsetWidth/2;u.current.scrollTo({left:v,behavior:"smooth"})}},[d]);const b=p=>l(p),g=p=>{const v=c[d+p];v!=null&&v.canvas&&f(v.canvas.id)};return t.createElement(t.Fragment,null,t.createElement(Dr,{handleFilter:b,handleCanvasToggle:g,activeIndex:d,canvasLength:c.length}),t.createElement(Wr,{"aria-label":"select item","data-testid":"media",ref:u},c.filter(p=>{var v;if((v=p.canvas)!=null&&v.label){const E=Y(p.canvas.label);if(Array.isArray(E))return E[0].toLowerCase().includes(a.toLowerCase())}}).map((p,v)=>{var E,S;return t.createElement(so,{canvas:p.canvas,canvasIndex:v,handleChange:f,isActive:i===((E=p==null?void 0:p.canvas)==null?void 0:E.id),key:(S=p==null?void 0:p.canvas)==null?void 0:S.id,thumbnail:Xt(o,p,200,200),type:co(p.annotations[0])})})))},ut=m("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all","& img":{width:"100%",height:"100%",objectFit:"contain",color:"transparent",transition:"$all"},variants:{isMedia:{true:{cursor:"pointer"}}}}),mt=m("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),pt=m(mt,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),mo=m("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${pt}`]:{backgroundColor:"$accent"},[`${ut}`]:{backgroundColor:"#6662"}}}),po=m("div",{width:"100%",height:"100%"}),fo=m("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),ho=m(Q.Trigger,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),go=m(Q.Content,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),vo=m(Q.Item,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),bo=m(Q.Label,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),ft=m(Q.Root,{position:"relative",zIndex:"5",width:"100%"}),Ce=({direction:e,title:n})=>{const r=()=>t.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),i=()=>t.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"});return t.createElement(fo,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",null,n),e==="up"&&t.createElement(r,null),e==="down"&&t.createElement(i,null))},ht=({children:e,label:n,maxHeight:r,onValueChange:i,value:o})=>t.createElement(ft,{onValueChange:i,value:o},t.createElement(ho,{"data-testid":"select-button"},t.createElement(H.SelectValue,{"data-testid":"select-button-value"}),t.createElement(H.SelectIcon,null,t.createElement(Ce,{direction:"down",title:"select"}))),t.createElement(H.SelectPortal,null,t.createElement(go,{css:{maxHeight:`${r} !important`},"data-testid":"select-content"},t.createElement(H.SelectScrollUpButton,null,t.createElement(Ce,{direction:"up",title:"scroll up for more"})),t.createElement(H.SelectViewport,null,t.createElement(H.SelectGroup,null,n&&t.createElement(bo,null,t.createElement(j,{"data-testid":"select-label",label:n})),e)),t.createElement(H.SelectScrollDownButton,null,t.createElement(Ce,{direction:"down",title:"scroll down for more"}))))),gt=e=>t.createElement(vo,{...e},e.thumbnail&&t.createElement(lt,{thumbnail:e.thumbnail}),t.createElement(H.SelectItemText,null,t.createElement(j,{label:e.label})),t.createElement(H.SelectItemIndicator,null)),ke=m("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),yo=m("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),Eo=m("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${ke}`]:{display:"block"}},false:{[`${ke}`]:{display:"none"}}}}}),J=({className:e,id:n,label:r,children:i})=>{const o=r.toLowerCase().replace(/\s/g,"-");return t.createElement(mt,{id:n,className:e,"data-testid":"openseadragon-button","data-button":o},t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${n}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",{id:`${n}-svg-title`},r),i))},xo=m("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),wo=()=>t.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),So=()=>t.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),Co=()=>t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),ko=()=>t.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),vt=()=>t.createElement(t.Fragment,null,t.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),t.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),Io=({_cloverViewerHasPlaceholder:e,config:n})=>{const r=k(),{activeCanvas:i,configOptions:o,openSeadragonViewer:a,plugins:l,vault:c,activeManifest:s}=r,d=c.get({id:i,type:"Canvas"});function h(){return l.filter(u=>{var y;return(y=u.imageViewer)==null?void 0:y.menu}).map((u,y)=>{var b,g,p,v;const f=(g=(b=u.imageViewer)==null?void 0:b.menu)==null?void 0:g.component;return t.createElement(f,{key:y,...(v=(p=u==null?void 0:u.imageViewer)==null?void 0:p.menu)==null?void 0:v.componentProps,activeManifest:s,canvas:d,viewerConfigOptions:o,openSeadragonViewer:a,useViewerDispatch:M,useViewerState:k})})}return t.createElement(xo,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:e},n.showZoomControl&&t.createElement(t.Fragment,null,t.createElement(J,{id:n.zoomInButton,label:"zoom in"},t.createElement(wo,null)),t.createElement(J,{id:n.zoomOutButton,label:"zoom out"},t.createElement(So,null))),n.showFullPageControl&&t.createElement(J,{id:n.fullPageButton,label:"full page"},t.createElement(Co,null)),n.showRotationControl&&t.createElement(t.Fragment,null,t.createElement(J,{id:n.rotateRightButton,label:"rotate right"},t.createElement(vt,null)),t.createElement(J,{id:n.rotateLeftButton,label:"rotate left"},t.createElement(vt,null))),n.showHomeControl&&t.createElement(J,{id:n.homeButton,label:"reset"},t.createElement(ko,null)),h())},$o=({ariaLabel:e,config:n,uri:r,_cloverViewerHasPlaceholder:i,imageType:o,openSeadragonCallback:a})=>{const[l,c]=t.useState(),[s,d]=t.useState(),h=M(),u=t.useRef(!1);return t.useEffect(()=>(u.current||(u.current=!0,s||d(ne(n))),()=>s==null?void 0:s.destroy()),[]),t.useEffect(()=>{s&&a&&a(s)},[s,a]),t.useEffect(()=>{s&&r!==l&&(s==null||s.forceRedraw(),c(r))},[s,l,r]),t.useEffect(()=>{if(l&&s)switch(o){case"simpleImage":s==null||s.addSimpleImage({url:l});break;case"tiledImage":Jt(l).then(y=>{try{if(!y)throw new Error(`No tile source found for ${l}`);s==null||s.addTiledImage({tileSource:y,success:()=>{typeof h=="function"&&h({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(f){console.error(f)}});break;default:s==null||s.close(),console.warn(`Unable to render ${l} in OpenSeadragon as type: "${o}"`);break}},[o,l]),t.createElement(Eo,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":n.id,hasNavigator:n.showNavigator},t.createElement(Io,{_cloverViewerHasPlaceholder:i,config:n}),n.showNavigator&&t.createElement(ke,{id:n.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),t.createElement(yo,{id:n.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...e&&{"aria-label":e}}))};function Ao(e){return{id:`openseadragon-${e}`,navigatorId:`openseadragon-navigator-${e}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${e}`,homeButton:`reset-${e}`,rotateLeftButton:`rotateLeft-${e}`,rotateRightButton:`rotateRight-${e}`,zoomInButton:`zoomIn-${e}`,zoomOutButton:`zoomOut-${e}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}}}const To=({_cloverViewerHasPlaceholder:e=!1,body:n,instanceId:r,isTiledImage:i=!1,label:o,src:a="",openSeadragonCallback:l,openSeadragonConfig:c={}})=>{const s=r||te.v4(),d=typeof o=="string"?o:P(o),h={...Ao(s),...c},{imageType:u,uri:y}=n?sn(n):cn(a,i);return y?t.createElement(Ie.ErrorBoundary,{FallbackComponent:We},t.createElement($o,{_cloverViewerHasPlaceholder:e,ariaLabel:d,config:h,imageType:u,key:s,uri:y,openSeadragonCallback:l})):null},Lo=({isMedia:e,label:n,placeholderCanvas:r,setIsInteractive:i})=>{const{vault:o}=k(),a=se(o,r),l=a?a[0]:void 0,c=n?Y(n):["placeholder image"];return t.createElement(ut,{onClick:()=>i(!0),isMedia:e,className:"clover-viewer-placeholder"},t.createElement("img",{src:(l==null?void 0:l.id)||"",alt:c.join(),height:l==null?void 0:l.height,width:l==null?void 0:l.width}))},Mo=m("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),zo=t.forwardRef((e,n)=>{const r=t.useRef(null),i=t.useCallback(()=>{var f,b;if((f=n.current)!=null&&f.currentTime&&((b=n.current)==null?void 0:b.currentTime)>0)return;const a=n.current;if(!a)return;const l=new AudioContext,c=l.createMediaElementSource(a),s=l.createAnalyser(),d=r.current;if(!d)return;d.width=a.offsetWidth,d.height=a.offsetHeight;const h=d.getContext("2d");c.connect(s),s.connect(l.destination),s.fftSize=256;const u=s.frequencyBinCount,y=new Uint8Array(u);setInterval(function(){o(s,h,u,y,d.width,d.height)},20)},[n]);t.useEffect(()=>{!n||!n.current||(n.current.onplay=i)},[i,n]);function o(a,l,c,s,d,h){const u=d/c*2.6;let y,f=0;a.getByteFrequencyData(s),l.fillStyle="#000000",l.fillRect(0,0,d,h);for(let b=0;b<c;b++)y=s[b]*2,l.fillStyle="rgba(78, 42, 132, 1)",l.fillRect(f,h-y,u,y),f+=u+6}return t.createElement(Mo,{ref:r,role:"presentation"})}),Po=m("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),Fo=({resource:e,ignoreCaptionLabels:n})=>{const r=Y(e.label,"en");return Array.isArray(r)&&r.some(o=>n.includes(o))?null:t.createElement("track",{key:e.id,src:e.id,label:Array.isArray(r)?r[0]:r,srcLang:"en","data-testid":"player-track"})},Vo=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],Bo=({allSources:e,annotationResources:n,painting:r})=>{const[i,o]=t.useState(0),[a,l]=t.useState(),c=t.useRef(null),s=(r==null?void 0:r.type)==="Sound",d=k(),{activeCanvas:h,configOptions:u,vault:y}=d;return t.useEffect(()=>{if(!r.id||!c.current)return;if(c!=null&&c.current){const g=c.current;g.src=r.id,g.load()}if(r.id.split(".").pop()!=="m3u8"&&r.format&&!Vo.includes(r.format))return;const f={xhrSetup:function(g,p){g.withCredentials=!!u.withCredentials}},b=new B(f);return b.attachMedia(c.current),b.on(B.Events.MEDIA_ATTACHED,function(){b.loadSource(r.id)}),b.on(B.Events.ERROR,function(g,p){if(p.fatal)switch(p.type){case B.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${g} network error encountered, try to recover`),b.startLoad();break;case B.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${g} media error encountered, try to recover`),b.recoverMediaError();break;default:b.destroy();break}}),()=>{if(b&&c.current){const g=c.current;b.detachMedia(),b.destroy(),g.currentTime=0}}},[u.withCredentials,r.id]),t.useEffect(()=>{var v,E,S,$;const f=y.get(h),b=(v=f.accompanyingCanvas)!=null&&v.id?se(y,(E=f.accompanyingCanvas)==null?void 0:E.id):null,g=(S=f.placeholderCanvas)!=null&&S.id?se(y,($=f.placeholderCanvas)==null?void 0:$.id):null;!!(b&&g)?l(i===0?g[0].id:b[0].id):(b&&l(b[0].id),g&&l(g[0].id))},[h,i,y]),t.useEffect(()=>{if(c!=null&&c.current){const f=c.current;return f==null||f.addEventListener("timeupdate",()=>o(f.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[]),t.createElement(Po,{css:{backgroundColor:u.canvasBackgroundColor,maxHeight:u.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},t.createElement("video",{id:"clover-iiif-video",key:r.id,ref:c,controls:!0,height:r.height,width:r.width,crossOrigin:"anonymous",poster:a,style:{maxHeight:u.canvasHeight,position:"relative",zIndex:"1"}},e.map(f=>t.createElement("source",{src:f.id,type:f.format,key:f.id})),(n==null?void 0:n.length)>0&&n.map(f=>{const b=[];return f.items.forEach(g=>{y.get(g.id).body.forEach(v=>{const E=y.get(v.id);b.push(E)})}),b.map(g=>t.createElement(Fo,{resource:g,ignoreCaptionLabels:u.ignoreCaptionLabels||[],key:g.id}))}),"Sorry, your browser doesn't support embedded videos."),s&&t.createElement(zo,{ref:c}))},Ho=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",{id:"close-svg-title"},"close"),t.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),_o=({isMedia:e})=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",{id:"open-svg-title"},"open"),e?t.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):t.createElement(t.Fragment,null,t.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),t.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),Oo=({handleToggle:e,isInteractive:n,isMedia:r})=>t.createElement(pt,{onClick:e,isInteractive:n,isMedia:r,"data-testid":"placeholder-toggle"},n?t.createElement(Ho,null):t.createElement(_o,{isMedia:r})),No=({activeCanvas:e,annotationResources:n,isMedia:r,painting:i})=>{var w,z,V,D,W;const[o,a]=t.useState(0),[l,c]=t.useState(!1),{configOptions:s,customDisplays:d,openSeadragonViewer:h,vault:u,viewerId:y}=k(),f=M(),b=u.get(e),g=(w=b==null?void 0:b.placeholderCanvas)==null?void 0:w.id,p=!!g,v=(i==null?void 0:i.length)>1,E=g&&!l&&!r,S=`${y}-${Dt(e+o)}`,$=()=>c(!l),A=x=>{const L=i.findIndex(G=>G.id===x);a(L)},C=d.find(x=>{var Tt;let L=!1;const{canvasId:G,paintingFormat:ee}=x.target;if(Array.isArray(G)&&G.length>0&&(L=G.includes(e)),Array.isArray(ee)&&ee.length>0){const Lt=((Tt=i[o])==null?void 0:Tt.format)||"";L=!!(Lt&&ee.includes(Lt))}return L}),O=[];(V=(z=n[0])==null?void 0:z.items)==null||V.forEach(x=>{const L=u.get(x.id);O.push(L)}),t.useEffect(()=>{var x;O&&h&&((x=s.annotationOverlays)!=null&&x.renderOverlays)&&(De(h,"annotation-overlay"),_e(h,b,s.annotationOverlays,O,"annotation-overlay"))},[b,O,h,s]);const N=x=>{x&&(h==null?void 0:h.id)!==`openseadragon-${S}`&&f({type:"updateOpenSeadragonViewer",openSeadragonViewer:x})},q=(D=C==null?void 0:C.display)==null?void 0:D.component;return t.createElement(mo,{className:"clover-viewer-painting"},t.createElement(po,{style:{backgroundColor:s.canvasBackgroundColor,height:"100%"}},g&&!r&&t.createElement(Oo,{handleToggle:$,isInteractive:l,isMedia:r}),E&&!r&&t.createElement(Lo,{isMedia:r,label:b==null?void 0:b.label,placeholderCanvas:g,setIsInteractive:c}),!E&&!C&&(r?t.createElement(Bo,{allSources:i,painting:i[o],annotationResources:n}):i&&t.createElement(To,{_cloverViewerHasPlaceholder:p,body:i[o],instanceId:S,key:S,openSeadragonCallback:N,openSeadragonConfig:s.openSeadragon})),!E&&q&&t.createElement(q,{id:e,annotationBody:i[o],...C==null?void 0:C.display.componentProps})),v&&t.createElement(ht,{value:(W=i[o])==null?void 0:W.id,onValueChange:A,maxHeight:"200px"},i==null?void 0:i.map(x=>t.createElement(gt,{value:x==null?void 0:x.id,key:x==null?void 0:x.id,label:x==null?void 0:x.label}))))},Do=({activeCanvas:e,annotationResources:n,searchServiceUrl:r,setContentSearchResource:i,contentSearchResource:o,isAudioVideo:a,items:l,painting:c})=>{const{isInformationOpen:s,showPageNavigation:d,configOptions:h}=k(),{informationPanel:u}=h,y=(u==null?void 0:u.renderAbout)&&s,f=(u==null?void 0:u.renderAnnotation)&&n.length>0&&!u.open||o;return t.createElement(je,{className:"clover-viewer-content",style:{height:h.canvasHeight??"100%"},"data-testid":"clover-viewer-content"},t.createElement(Ge,null,t.createElement(No,{activeCanvas:e,annotationResources:n,isMedia:a,painting:c}),y&&t.createElement(Ue,null,t.createElement("span",null,s?"View Items":"More Information")),l.length>1&&d&&t.createElement(qe,{className:"clover-viewer-media-wrapper"},t.createElement(uo,{items:l,activeItem:0}))),(y||f)&&s&&t.createElement(hn,null,t.createElement(Ze,null,t.createElement(zr,{activeCanvas:e,annotationResources:n,searchServiceUrl:r,setContentSearchResource:i,contentSearchResource:o}))))},Wo=m(X.Trigger,{width:"30px",padding:"5px"}),bt=m(X.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),qo=m("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),jo=m("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${ft}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),Go=m("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),Uo=()=>{var s;const e=M(),n=k(),{activeManifest:r,collection:i,configOptions:o,vault:a}=n,l=o==null?void 0:o.canvasHeight,c=d=>{e({type:"updateActiveManifest",manifestId:d}),e({type:"updateViewerId",viewerId:te.v4()})};return t.createElement("div",{style:{margin:"0.75rem"}},t.createElement(ht,{label:i.label,maxHeight:l,value:r,onValueChange:c},(s=i==null?void 0:i.items)==null?void 0:s.map(d=>t.createElement(gt,{value:d.id,key:d.id,thumbnail:d!=null&&d.thumbnail?a.get(d==null?void 0:d.thumbnail):void 0,label:d.label}))))},Zo=(e,n=2500)=>{const[r,i]=t.useState(),o=t.useCallback(()=>{navigator.clipboard.writeText(e).then(()=>i("copied"),()=>i("failed"))},[e]);return t.useEffect(()=>{if(!r)return;const a=setTimeout(()=>i(void 0),n);return()=>clearTimeout(a)},[r]),[r,o]},Xo=m("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),Yo=({status:e})=>e?t.createElement(Xo,{"data-copy-status":e},e):null,yt=({textPrompt:e,textToCopy:n})=>{const[r,i]=Zo(n);return t.createElement("button",{onClick:i},e," ",t.createElement(Yo,{status:r}))},Jo=()=>{const e="#ed1d33",n="#2873ab";return t.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},t.createElement("title",null,"IIIF Manifest Options"),t.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},t.createElement("g",{transform:"scale(0.1)"},t.createElement("path",{style:{fill:n},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),t.createElement("path",{style:{fill:n},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),t.createElement("path",{style:{fill:e},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),t.createElement("path",{style:{fill:e},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),t.createElement("path",{style:{fill:n},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),t.createElement("path",{style:{fill:n},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),t.createElement("path",{style:{fill:e},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},Ko=m(ae.Root,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),Qo=m(ae.Thumb,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),Ro=m("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"}),ei=m("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),ti=()=>{var a,l;const{configOptions:e}=k(),n=M(),[r,i]=t.useState((a=e==null?void 0:e.informationPanel)==null?void 0:a.open),o=((l=e==null?void 0:e.informationPanel)==null?void 0:l.toggleLabel)??"More information";return t.useEffect(()=>{n({type:"updateInformationOpen",isInformationOpen:r})},[r,n]),t.createElement(ei,null,t.createElement(Ro,{htmlFor:"information-toggle",css:r?{opacity:"1"}:{}},o),t.createElement(Ko,{checked:r,onCheckedChange:()=>i(!r),id:"information-toggle","aria-label":"information panel toggle",name:"toggled?"},t.createElement(Qo,null)))},ni=m(ae.Root,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),ri=m(ae.Thumb,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),oi=m("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"}),ii=m("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),ai=()=>{var a,l;const{configOptions:e}=k(),n=M(),[r,i]=t.useState((a=e==null?void 0:e.pages)==null?void 0:a.show),o=((l=e==null?void 0:e.pages)==null?void 0:l.toggleLabel)??"Show pages";return t.useEffect(()=>{n({type:"updateShowPageNavigation",showPageNavigation:r})},[r,n]),t.createElement(ii,null,t.createElement(oi,{htmlFor:"show-pages-toggle",css:r?{opacity:"1"}:{}},o),t.createElement(ni,{checked:r,onCheckedChange:()=>i(!r),id:"show-pages-toggle","aria-label":"show pages toggle",name:"toggled?"},t.createElement(ri,null)))},li=m(X.Trigger,{width:"30px",padding:"5px"}),si=m(bt,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});function ci(e){const{vault:n}=k();try{const r=e&&n.get(e);if(!r)throw new Error(`Vault entity ${e} not found.`);return(r==null?void 0:r["@id"])||(r==null?void 0:r.id)}catch(r){return console.error(r),e}}function Et(e,n){const r=[];if(!e)return r;for(const i of e)if(i.id){const o=n.get(i.id);o&&r.push(o)}return r}function di(){const{activeCanvas:e,activeManifest:n,vault:r}=k(),[i,o]=t.useState({root:[],canvas:[]});return t.useEffect(()=>{const a=r.get(n),l=r.get(e),c=a==null?void 0:a.rendering,s=l==null?void 0:l.rendering,d=Et(c,r),h=Et(s,r);o({root:d,canvas:h})},[e,n,r]),{...i}}function xt(e,n){return e.map(({format:r,id:i,label:o})=>{const a=ci(i);return{format:r,id:a,label:P(o)||n}})}function ui(){const e=di(),n=xt((e==null?void 0:e.root)||[],"Root Rendering Label"),r=xt((e==null?void 0:e.canvas)||[],"Canvas Rendering Label");return{allPages:n,individualPages:r}}const mi=()=>{const{allPages:e,individualPages:n}=ui(),r=e.length>0||n.length>0,i=o=>{window.open(o,"_blank")};return r?t.createElement(X,null,t.createElement(li,{"data-testid":"download-button"},t.createElement(T,null,t.createElement(T.Download,null))),t.createElement(si,{"data-testid":"download-content"},n.length>0&&t.createElement(t.Fragment,null,t.createElement("h3",null,"Individual Pages"),t.createElement("ul",null,n.map(({format:o,id:a,label:l})=>t.createElement("li",{key:l},t.createElement("button",{onClick:()=>i(a)},l," (",o,")"))))),e.length>0&&t.createElement(t.Fragment,null,t.createElement("h3",null,"All Pages"),t.createElement("ul",null,e.map(({format:o,id:a,label:l})=>t.createElement("li",{key:l},t.createElement("button",{onClick:()=>i(a)},l," (",o,")"))))))):null},wt=e=>{const n=()=>window.matchMedia?window.matchMedia(e).matches:!1,[r,i]=t.useState(n);return t.useEffect(()=>{const o=()=>i(n);return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)}),r},pi=({manifest:e,manifestId:n,manifestLabel:r})=>{const i=k(),{collection:o,configOptions:a}=i,l=M(),[c,s]=t.useState(0);t.useEffect(()=>{s(0)},[]);const{informationPanel:d,showDownload:h,showIIIFBadge:u,showTitle:y,headerNavigation:f}=a,b=h||u||(d==null?void 0:d.renderToggle),g=wt(ve.sm);return t.createElement(jo,{className:"clover-viewer-header"},o!=null&&o.items?t.createElement(Uo,null):t.createElement(qo,{className:y?"":"visually-hidden"},y&&t.createElement(j,{label:r,className:"label"}),f&&t.createElement("span",{className:"headerNavigation",dangerouslySetInnerHTML:{__html:f}}),t.createElement("button",{onClick:p=>{if(p.preventDefault(),!e.items[c-1])return;const v=e.items[c-1].id;s(c-1),l({type:"updateActiveCanvas",canvasId:v})}},"Previous page"),t.createElement("button",{onClick:p=>{if(p.preventDefault(),!e.items[c+1])return;const v=e.items[c+1].id;s(c+1),l({type:"updateActiveCanvas",canvasId:v})}},"Next page")),b&&t.createElement(Go,null,h&&t.createElement(mi,null),u&&t.createElement(X,null,t.createElement(Wo,null,t.createElement(Jo,null)),t.createElement(bt,null,(o==null?void 0:o.items)&&t.createElement("button",{onClick:p=>{p.preventDefault(),window.open(o.id,"_blank")}},"View Collection"),t.createElement("button",{onClick:p=>{p.preventDefault(),window.open(n,"_blank")}},"View Manifest")," ",(o==null?void 0:o.items)&&t.createElement(yt,{textPrompt:"Copy Collection URL",textToCopy:o.id}),t.createElement(yt,{textPrompt:"Copy Manifest URL",textToCopy:n}))),(d==null?void 0:d.renderToggle)&&!g&&t.createElement(ti,null),t.createElement(ai,null)))},fi=(e=!1)=>{const[n,r]=t.useState(e);return t.useLayoutEffect(()=>{if(!n)return;const i=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=i}},[n]),t.useEffect(()=>{n!==e&&r(e)},[e]),[n,r]},hi=({manifest:e,theme:n,iiifContentSearchQuery:r})=>{var W;const i=k(),o=M(),{activeCanvas:a,isInformationOpen:l,vault:c,contentSearchVault:s,configOptions:d,openSeadragonViewer:h}=i,u=["100%","auto"],y=(d==null?void 0:d.canvasHeight)&&u.includes(d==null?void 0:d.canvasHeight),[f,b]=t.useState(!1),[g,p]=t.useState(!1),[v,E]=t.useState([]),[S,$]=t.useState([]),[A,C]=t.useState(),[O,N]=fi(!1),q=wt(ve.sm),[w,z]=t.useState(),V=t.useCallback(x=>{o({type:"updateInformationOpen",isInformationOpen:x})},[o]);t.useEffect(()=>{var x;(x=d==null?void 0:d.informationPanel)!=null&&x.open&&V(!q)},[q,(W=d==null?void 0:d.informationPanel)==null?void 0:W.open,V]),t.useEffect(()=>{if(!q){N(!1);return}N(l)},[l,q,N]),t.useEffect(()=>{const x=se(c,a);x&&(p(["Sound","Video"].indexOf(x[0].type)>-1),E(x));const L=Zt(c,a);L.length>0&&o({type:"updateInformationOpen",isInformationOpen:!0}),$(L),b(L.length!==0)},[a,c,o]);const D=e.service.some(x=>x.type==="SearchService2");return t.useEffect(()=>{if(D){const x=e.service.find(L=>L.type==="SearchService2");x&&z(x.id)}},[e,D]),t.useEffect(()=>{var x,L,G;w&&((x=d.informationPanel)==null?void 0:x.renderContentSearch)!==!1&&Fe(s,w,(G=(L=d.localeText)==null?void 0:L.contentSearch)==null?void 0:G.tabLabel,r).then(ee=>{C(ee)})},[w]),t.useEffect(()=>{if(!h||!A)return;const x=c.get({id:a,type:"Canvas"});De(h,"content-search-overlay"),dn(s,A,h,x,d)},[h,A]),t.createElement(Ie.ErrorBoundary,{FallbackComponent:We},t.createElement(gn,{className:`${n} clover-viewer`,css:{background:d==null?void 0:d.background},"data-body-locked":O,"data-absolute-position":y,"data-information-panel":f,"data-information-panel-open":l},t.createElement(me.Root,{open:l,onOpenChange:V},t.createElement(pi,{manifest:e,manifestLabel:e.label,manifestId:e.id}),t.createElement(Do,{activeCanvas:a,painting:v,annotationResources:S,searchServiceUrl:w,setContentSearchResource:C,contentSearchResource:A,items:e.items,isAudioVideo:g}))))},St={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function gi(e){return{ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText,headers:e.getAllResponseHeaders(),data:e.responseText,json:()=>JSON.parse(e.responseText)}}function Ct(e,n=null){return{ok:!1,status:e.status,statusText:e.statusText,headers:e.getAllResponseHeaders(),data:n||e.statusText,json:()=>JSON.parse(n||e.statusText)}}function vi(e,n=St){const r=n.headers||St.headers;return new Promise((i,o)=>{const a=new XMLHttpRequest;a.open("get",e),a.withCredentials=n.withCredentials,r&&Object.keys(r).forEach(l=>a.setRequestHeader(l,r[l])),a.onload=()=>{i(gi(a))},a.onerror=()=>{o(Ct(a,"Failed to make request."))},a.ontimeout=()=>{o(Ct(a,"Request took longer than expected."))},a.send()})}const bi=({canvasIdCallback:e=()=>{},customDisplays:n=[],plugins:r=[],customTheme:i,iiifContent:o,id:a,manifestId:l,options:c,iiifContentSearchQuery:s})=>{var u,y,f;let d=o;a&&(d=a),l&&(d=l);const h=Me((y=(u=c==null?void 0:c.informationPanel)==null?void 0:u.vtt)==null?void 0:y.autoScroll);return t.createElement(Ut,{initialState:{...le,customDisplays:n,plugins:r,isAutoScrollEnabled:h.enabled,isInformationOpen:!!((f=c==null?void 0:c.informationPanel)!=null&&f.open),showPageNavigation:!0,vault:new ue.Vault({customFetcher:b=>vi(b,{withCredentials:c==null?void 0:c.withCredentials,headers:c==null?void 0:c.requestHeaders}).then(g=>JSON.parse(g.data))})}},t.createElement(yi,{iiifContent:d,canvasIdCallback:e,customTheme:i,options:c,iiifContentSearchQuery:s}))},yi=({canvasIdCallback:e,customTheme:n,iiifContent:r,options:i,iiifContentSearchQuery:o})=>{const a=M(),l=k(),{activeCanvas:c,activeManifest:s,isLoaded:d,vault:h}=l,[u,y]=t.useState(),[f,b]=t.useState();let g={};if(n&&(g=$e.createTheme("custom",n)),t.useEffect(()=>{e&&e(c)},[c,e]),t.useEffect(()=>{s&&h.loadManifest(s).then(v=>{b(v),a({type:"updateActiveCanvas",canvasId:Rt(r,v)})}).catch(v=>{console.error(`Manifest failed to load: ${v}`)}).finally(()=>{a({type:"updateIsLoaded",isLoaded:!0})})},[r,s,a,h]),t.useEffect(()=>{a({type:"updateConfigOptions",configOptions:i});const v=Qt(r);h.load(v).then(E=>{y(E)}).catch(E=>{console.error(`The IIIF resource ${r} failed to load: ${E}`)})},[a,r,i,h]),t.useEffect(()=>{if((u==null?void 0:u.type)==="Collection"){a({type:"updateCollection",collection:u});const v=en(r,u);v&&a({type:"updateActiveManifest",manifestId:v})}else(u==null?void 0:u.type)==="Manifest"&&a({type:"updateActiveManifest",manifestId:u.id})},[a,r,u]),!d)return t.createElement(t.Fragment,null,"Loading");if(!f||!f.items)return console.log(`The IIIF manifest ${r} failed to load.`),t.createElement(t.Fragment,null);if(f.items.length===0)return console.log(`The IIIF manifest ${r} does not contain canvases.`),t.createElement(t.Fragment,null);const p=(i==null?void 0:i.initialPage)??0;return p>0&&(f!=null&&f.items)&&f.items[p-1]&&c!==f.items[p-1].id&&(a({type:"updateActiveCanvas",canvasId:f.items[p-1].id}),i&&(i.initialPage=void 0)),t.createElement(hi,{manifest:f,theme:g,key:f.id,iiifContentSearchQuery:o})};I.default=bi,Object.defineProperties(I,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
