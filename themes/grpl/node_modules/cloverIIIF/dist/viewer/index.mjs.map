{"version":3,"file":"index.mjs","sources":["../../src/lib/utils.ts","../../src/context/viewer-context.tsx","../../src/hooks/use-iiif/getAnnotationResources.ts","../../src/hooks/use-iiif/getCanvasByCriteria.ts","../../src/hooks/use-iiif/getLabel.ts","../../src/hooks/use-iiif/getPaintingResource.ts","../../src/hooks/use-iiif/getThumbnail.ts","../../src/lib/openseadragon-svg.ts","../../src/lib/annotation-helpers.ts","../../src/lib/iiif.ts","../../src/types/open-seadragon.ts","../../src/lib/openseadragon-helpers.ts","../../src/styles/stitches.config.tsx","../../src/components/UI/ErrorFallback/ErrorFallback.styled.tsx","../../src/components/UI/ErrorFallback/ErrorFallback.tsx","../../src/components/Viewer/Viewer/Viewer.styled.tsx","../../src/components/Viewer/InformationPanel/InformationPanel.styled.tsx","../../src/components/Viewer/InformationPanel/Annotation/Item.styled.tsx","../../src/components/Viewer/InformationPanel/Annotation/PlainText.tsx","../../src/components/Viewer/InformationPanel/Annotation/HTML.tsx","../../src/hooks/use-webvtt.ts","../../src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled.tsx","../../src/components/Viewer/InformationPanel/Annotation/VTT/Cue.tsx","../../src/components/Viewer/InformationPanel/Menu.styled.tsx","../../src/components/Viewer/InformationPanel/Menu.tsx","../../src/components/Viewer/InformationPanel/Annotation/VTT/VTT.tsx","../../src/components/Viewer/InformationPanel/Annotation/Image.tsx","../../src/components/Viewer/InformationPanel/Annotation/Item.tsx","../../src/components/Viewer/InformationPanel/Annotation/Page.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/Item.styled.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/PlainText.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/Item.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/Page.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/ContentSearchForm.styled.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/ContentSearchForm.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/ContentSearch.tsx","../../src/components/Viewer/InformationPanel/About/About.styled.ts","../../src/lib/label-helpers.ts","../../src/lib/html-element.ts","../../src/components/Primitives/Label/Label.tsx","../../src/hooks/useGetImageResource.ts","../../src/components/Primitives/ContentResource/ContentResource.tsx","../../src/components/Primitives/Homepage/Homepage.tsx","../../src/context/primitives-context.tsx","../../src/components/Primitives/Markup/Markup.tsx","../../src/components/Primitives/Value/Value.tsx","../../src/components/Primitives/Value/CustomValue.tsx","../../src/components/Primitives/Metadata/Item.tsx","../../src/lib/custom.ts","../../src/components/Primitives/Metadata/Metadata.tsx","../../src/components/Primitives/PartOf/PartOf.tsx","../../src/components/Primitives/Rendering/Rendering.tsx","../../src/components/Primitives/RequiredStatement/RequiredStatement.tsx","../../src/components/Primitives/SeeAlso/SeeAlso.tsx","../../src/components/Primitives/Summary/Summary.tsx","../../src/components/Primitives/Thumbnail/Thumbnail.tsx","../../src/components/Viewer/Properties/Homepage.tsx","../../src/components/Viewer/Properties/Id.tsx","../../src/components/Viewer/Properties/Metadata.tsx","../../src/components/Viewer/Properties/Rendering.tsx","../../src/components/Viewer/Properties/RequiredStatement.tsx","../../src/components/Viewer/Properties/Rights.tsx","../../src/components/Viewer/Properties/SeeAlso.tsx","../../src/components/Viewer/Properties/Summary.tsx","../../src/components/Viewer/Properties/Thumbnail.tsx","../../src/components/Viewer/InformationPanel/About/About.tsx","../../src/lib/plugin-helpers.ts","../../src/components/Viewer/InformationPanel/InformationPanel.tsx","../../src/components/Viewer/Media/Controls.styled.tsx","../../src/hooks/useKeyPress.ts","../../src/components/Viewer/Media/Controls.tsx","../../src/components/Viewer/Media/Media.styled.tsx","../../src/components/UI/Icons/Add.tsx","../../src/components/UI/Icons/Audio.tsx","../../src/components/UI/Icons/Close.tsx","../../src/components/UI/Icons/Download.tsx","../../src/components/UI/Icons/Image.tsx","../../src/components/UI/Icons/Video.tsx","../../src/components/UI/Icon/Icon.styled.tsx","../../src/components/UI/Icon/Icon.tsx","../../src/components/UI/Popover/Popover.styled.tsx","../../src/components/UI/Popover/Popover.tsx","../../src/components/UI/Tag/Tag.tsx","../../src/components/Viewer/Media/Thumbnail.styled.tsx","../../src/components/Viewer/Media/Thumbnail.tsx","../../src/hooks/use-iiif/getResourceType.ts","../../src/components/Viewer/Media/Media.tsx","../../src/components/Viewer/Painting/Placeholder.styled.tsx","../../src/components/Image/Controls/Button.styled.tsx","../../src/components/Viewer/Painting/Toggle.styled.ts","../../src/components/Viewer/Painting/Painting.styled.tsx","../../src/components/UI/Select/Select.styled.tsx","../../src/components/UI/Select/Icon.tsx","../../src/components/UI/Select/Select.tsx","../../src/components/UI/Select/Option.tsx","../../src/components/Image/Image.styled.tsx","../../src/components/Image/Controls/Button.tsx","../../src/components/Image/Controls/Controls.styled.tsx","../../src/components/Image/Controls/Controls.tsx","../../src/components/Image/OSD/OSD.tsx","../../src/components/Image/OSD/defaults.ts","../../src/components/Image/index.tsx","../../src/components/Viewer/Painting/Placeholder.tsx","../../src/components/Viewer/Player/AudioVisualizer.styled.tsx","../../src/components/Viewer/Player/AudioVisualizer.tsx","../../src/components/Viewer/Player/Player.styled.tsx","../../src/components/Viewer/Player/Track.tsx","../../src/lib/hls.ts","../../src/components/Viewer/Player/Player.tsx","../../src/components/Viewer/Painting/Toggle.tsx","../../src/components/Viewer/Painting/Painting.tsx","../../src/components/Viewer/Viewer/Content.tsx","../../src/components/Viewer/Viewer/Header.styled.ts","../../src/components/Viewer/Collection/Collection.tsx","../../src/hooks/useCopyToClipboard.ts","../../src/components/Viewer/CopyText.tsx","../../src/components/Viewer/Viewer/IIIFBadge.tsx","../../src/components/Viewer/Viewer/Toggle.styled.ts","../../src/components/Viewer/Viewer/Toggle.tsx","../../src/components/Viewer/Viewer/ShowPagesToggle.styled.tsx","../../src/components/Viewer/Viewer/ShowPagesToggle.tsx","../../src/components/Viewer/Viewer/Download.styled.ts","../../src/hooks/useGetVaultEntityId.tsx","../../src/hooks/use-iiif/useRendering.ts","../../src/hooks/useViewerDownload.tsx","../../src/components/Viewer/Viewer/Download.tsx","../../src/hooks/useMediaQuery.ts","../../src/components/Viewer/Viewer/Header.tsx","../../src/hooks/useBodyLocked.ts","../../src/components/Viewer/Viewer/Viewer.tsx","../../src/lib/xhr.ts","../../src/components/Viewer/index.tsx"],"sourcesContent":["export const cleanTime = (standardNotation: string) => {\n  const array = standardNotation.toString().split(\":\");\n  const hours: number = Math.ceil(parseInt(array[0]));\n  const minutes: number = Math.ceil(parseInt(array[1]));\n  const seconds: string = zeroPad(Math.ceil(parseInt(array[2])), 2);\n\n  // Insure time with Hours is formatted as \"HH:MM:SS\"\n  const formattedMinutes =\n    hours !== 0 && minutes < 10 ? (minutes + \"\").padStart(2, \"0\") : minutes;\n\n  let time: string = `${formattedMinutes}:${seconds}`;\n\n  if (hours !== 0) {\n    time = `${hours}:${time}`;\n  }\n\n  return time;\n};\n\nexport const convertTime = (duration: number) => {\n  const standardNotation: string = new Date(duration * 1000)\n    .toISOString()\n    .substr(11, 8);\n  return cleanTime(standardNotation);\n};\n\nexport const convertTimeToSeconds = (standardNotation: string) => {\n  const hms: Array<string> = standardNotation.split(\":\");\n  const seconds: number = +hms[0] * 60 * 60 + +hms[1] * 60 + +hms[2];\n  return seconds;\n};\n\nexport const deepMerge = (target, source) => {\n  if (typeof target !== \"object\" || target === null) {\n    return source;\n  }\n\n  for (const key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      target[key] = deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n};\n\nexport const hashCode = (s: string) => {\n  return s.split(\"\").reduce(function (a, b) {\n    a = (a << 5) - a + b.charCodeAt(0);\n    return a & a;\n  }, 0);\n};\n\nexport const getRealPropertyValue = (\n  obj: { [key: string]: any },\n  property: string,\n) => {\n  const value = Object.hasOwn(obj, property)\n    ? obj[property].toString()\n    : undefined;\n  return value;\n};\n\nconst zeroPad = (num: number, places: number) =>\n  String(num).padStart(places, \"0\");\n","import OpenSeadragon, { Options as OpenSeadragonOptions } from \"openseadragon\";\nimport React, { useReducer } from \"react\";\n\nimport { CollectionNormalized } from \"@iiif/presentation-3\";\nimport { IncomingHttpHeaders } from \"http\";\nimport { Vault } from \"@iiif/vault\";\nimport { deepMerge } from \"src/lib/utils\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport type AutoScrollSettings = {\n  behavior: string; // ScrollBehavior (\"auto\" | \"instant\" | \"smooth\")\n  block: string; // ScrollLogicalPosition (\"center\" | \"end\" | \"nearest\" | \"start\")\n};\n\nexport type AutoScrollOptions = {\n  enabled: boolean;\n  settings: AutoScrollSettings;\n};\n\nexport type ViewerConfigOptions = {\n  annotationOverlays?: OverlayOptions;\n  background?: string;\n  canvasBackgroundColor?: string;\n  canvasHeight?: string;\n  contentSearch?: {\n    searchResultsLimit?: number;\n    overlays?: OverlayOptions;\n    zoomToFirst?: boolean;\n  };\n  ignoreCaptionLabels?: string[];\n  pages?: {\n    show?: boolean;\n    toggleLabel?: string;\n  };\n  informationPanel?: {\n    open?: boolean;\n    renderAbout?: boolean;\n    renderSupplementing?: boolean;\n    renderToggle?: boolean;\n    renderAnnotation?: boolean;\n    toggleLabel?: string;\n    vtt?: {\n      autoScroll?: AutoScrollOptions | AutoScrollSettings | boolean;\n    };\n    renderContentSearch?: boolean;\n    defaultTab?: string;\n  };\n  openSeadragon?: OpenSeadragonOptions;\n  requestHeaders?: IncomingHttpHeaders;\n  showDownload?: boolean;\n  headerNavigation?: string;\n  showIIIFBadge?: boolean;\n  showTitle?: boolean;\n  withCredentials?: boolean;\n  localeText?: {\n    contentSearch?: {\n      tabLabel?: string;\n      formPlaceholder?: string;\n      noSearchResults?: string;\n      loading?: string;\n      moreResults?: string;\n    };\n  };\n  initialSearch?: string;\n  initialPage?: number;\n};\n\nexport type OverlayOptions = {\n  backgroundColor?: string;\n  borderColor?: string;\n  borderType?: string;\n  borderWidth?: string;\n  opacity?: string;\n  renderOverlays?: boolean;\n  zoomLevel?: number;\n};\n\nconst defaultAutoScrollSettings: AutoScrollSettings = {\n  behavior: \"smooth\",\n  block: \"center\",\n};\n\nconst defaultConfigOptions = {\n  annotationOverlays: {\n    backgroundColor: \"#6666ff\",\n    borderColor: \"#000099\",\n    borderType: \"solid\",\n    borderWidth: \"1px\",\n    opacity: \"0.5\",\n    renderOverlays: true,\n    zoomLevel: 2,\n  },\n  background: \"transparent\",\n  canvasBackgroundColor: \"#6662\",\n  canvasHeight: \"500px\",\n  contentSearch: {\n    searchResultsLimit: 20,\n    zoomToFirst: false,\n    overlays: {\n      backgroundColor: \"#ff6666\",\n      borderColor: \"#990000\",\n      borderType: \"solid\",\n      borderWidth: \"1px\",\n      opacity: \"0.5\",\n      renderOverlays: true,\n      zoomLevel: 4,\n    },\n  },\n  ignoreCaptionLabels: [],\n  pages: {\n    show: true,\n    toggleLabel: \"Pages\",\n  },\n  informationPanel: {\n    vtt: {\n      autoScroll: {\n        enabled: true,\n        settings: defaultAutoScrollSettings,\n      },\n    },\n    open: true,\n    renderAbout: true,\n    renderSupplementing: true,\n    renderToggle: true,\n    renderAnnotation: true,\n    renderContentSearch: true,\n  },\n  openSeadragon: {},\n  requestHeaders: { \"Content-Type\": \"application/json\" },\n  showDownload: true,\n  showIIIFBadge: true,\n  showTitle: true,\n  withCredentials: false,\n  localeText: {\n    contentSearch: {\n      tabLabel: \"Search Results\",\n      formPlaceholder: \"Enter search words\",\n      noSearchResults: \"No search results\",\n      loading: \"Loading...\",\n      moreResults: \"more results\",\n    },\n  },\n};\n\nexport type CustomDisplay = {\n  display: {\n    component: React.ElementType;\n    componentProps?: Record<string, unknown>;\n  };\n  target: {\n    canvasId?: string[];\n    paintingFormat?: string[];\n  };\n};\nexport type PluginConfig = {\n  id: string;\n  imageViewer?: {\n    menu?: {\n      component: React.ElementType;\n      componentProps?: Record<string, unknown>;\n    };\n  };\n  informationPanel?: {\n    component: React.ElementType;\n    componentProps?: Record<string, unknown>;\n    label: string;\n  };\n};\n\nexport interface ViewerContextStore {\n  activeCanvas: string;\n  activeManifest: string;\n  OSDImageLoaded?: boolean;\n  collection?: CollectionNormalized | Record<string, never>;\n  configOptions: ViewerConfigOptions;\n  customDisplays: Array<CustomDisplay>;\n  plugins: Array<PluginConfig>;\n  isAutoScrollEnabled?: boolean;\n  isAutoScrolling?: boolean;\n  isInformationOpen: boolean;\n  showPageNavigation: boolean;\n  isLoaded: boolean;\n  isUserScrolling?: number | undefined;\n  vault: Vault;\n  contentSearchVault: Vault;\n  openSeadragonViewer: OpenSeadragon.Viewer | null;\n  openSeadragonId?: string;\n  viewerId?: string;\n  informationPanelCounts: object;\n}\n\nexport interface ViewerAction {\n  type: string;\n  canvasId: string;\n  collection: CollectionNormalized;\n  configOptions: ViewerConfigOptions;\n  isAutoScrollEnabled: boolean;\n  isAutoScrolling: boolean;\n  isInformationOpen: boolean;\n  showPageNavigation: boolean;\n  isLoaded: boolean;\n  isUserScrolling: number | undefined;\n  manifestId: string;\n  OSDImageLoaded?: boolean;\n  vault: Vault;\n  contentSearchVault: Vault;\n  openSeadragonViewer: OpenSeadragon.Viewer;\n  viewerId: string;\n  panel: string;\n  count: number;\n}\n\nexport function expandAutoScrollOptions(\n  value: AutoScrollOptions | AutoScrollSettings | boolean | undefined,\n): AutoScrollOptions {\n  let result: AutoScrollOptions = {\n    ...defaultConfigOptions.informationPanel.vtt.autoScroll,\n  };\n  if (typeof value === \"object\") {\n    result = \"enabled\" in value ? value : { enabled: true, settings: value };\n  }\n  if (value === false) result.enabled = false;\n  validateAutoScrollSettings(result.settings);\n  return result;\n}\n\nfunction validateAutoScrollSettings({ behavior, block }: AutoScrollSettings) {\n  const validBehaviors = [\"auto\", \"instant\", \"smooth\"];\n  const validPositions = [\"center\", \"end\", \"nearest\", \"start\"];\n  if (!validBehaviors.includes(behavior))\n    throw TypeError(`'${behavior}' not in ${validBehaviors.join(\" | \")}`);\n  if (!validPositions.includes(block))\n    throw TypeError(`'${block}' not in ${validPositions.join(\" | \")}`);\n}\n\nconst expandedAutoScrollOptions = expandAutoScrollOptions(\n  defaultConfigOptions?.informationPanel?.vtt?.autoScroll,\n);\n\nexport const defaultState: ViewerContextStore = {\n  activeCanvas: \"\",\n  activeManifest: \"\",\n  OSDImageLoaded: false,\n  collection: {},\n  configOptions: defaultConfigOptions,\n  customDisplays: [],\n  plugins: [],\n  isAutoScrollEnabled: expandedAutoScrollOptions.enabled,\n  isAutoScrolling: false,\n  isInformationOpen: defaultConfigOptions?.informationPanel?.open,\n  showPageNavigation: defaultConfigOptions?.pages?.show,\n  isLoaded: false,\n  isUserScrolling: undefined,\n  vault: new Vault(),\n  contentSearchVault: new Vault(),\n  openSeadragonViewer: null,\n  viewerId: uuidv4(),\n  informationPanelCounts: {},\n};\n\nconst ViewerStateContext =\n  React.createContext<ViewerContextStore>(defaultState);\nconst ViewerDispatchContext =\n  React.createContext<ViewerContextStore>(defaultState);\n\nfunction viewerReducer(state: ViewerContextStore, action: ViewerAction) {\n  switch (action.type) {\n    case \"updateActiveCanvas\": {\n      /**\n       * Set canvasId to empty string if it comes back undefined.\n       */\n      if (!action.canvasId) action.canvasId = \"\";\n      return {\n        ...state,\n        activeCanvas: action.canvasId,\n      };\n    }\n    case \"updateActiveManifest\": {\n      return {\n        ...state,\n        activeManifest: action.manifestId,\n      };\n    }\n    case \"updateOSDImageLoaded\": {\n      return {\n        ...state,\n        OSDImageLoaded: action.OSDImageLoaded,\n      };\n    }\n    case \"updateAutoScrollAnnotationEnabled\": {\n      return {\n        ...state,\n        isAutoScrollEnabled: action.isAutoScrollEnabled,\n      };\n    }\n    case \"updateAutoScrolling\": {\n      return {\n        ...state,\n        isAutoScrolling: action.isAutoScrolling,\n      };\n    }\n    case \"updateCollection\": {\n      return {\n        ...state,\n        collection: action.collection,\n      };\n    }\n    case \"updateConfigOptions\": {\n      return {\n        ...state,\n        configOptions: deepMerge(state.configOptions, action.configOptions),\n      };\n    }\n    case \"updateInformationOpen\": {\n      return {\n        ...state,\n        isInformationOpen: action.isInformationOpen,\n      };\n    }\n    case \"updateShowPageNavigation\": {\n      return {\n        ...state,\n        showPageNavigation: action.showPageNavigation,\n      };\n    }\n    case \"updateIsLoaded\": {\n      return {\n        ...state,\n        isLoaded: action.isLoaded,\n      };\n    }\n    case \"updateUserScrolling\": {\n      return {\n        ...state,\n        isUserScrolling: action.isUserScrolling,\n      };\n    }\n    case \"updateOpenSeadragonViewer\": {\n      return {\n        ...state,\n        openSeadragonViewer: action.openSeadragonViewer,\n      };\n    }\n    case \"updateViewerId\": {\n      return {\n        ...state,\n        viewerId: action.viewerId,\n      };\n    }\n    case \"updateInformationPanelCount\": {\n      const c = state.informationPanelCounts ?? {};\n      c[action.panel] = action.count;\n      return {\n        ...state,\n        informationPanelCounts: c,\n      };\n    }\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`);\n    }\n  }\n}\n\ninterface ViewerProviderProps {\n  initialState?: ViewerContextStore;\n  children: React.ReactNode;\n}\n\nconst ViewerProvider: React.FC<ViewerProviderProps> = ({\n  initialState = defaultState,\n  children,\n}) => {\n  const [state, dispatch] = useReducer<\n    React.Reducer<ViewerContextStore, ViewerAction>\n  >(viewerReducer, initialState);\n\n  return (\n    <ViewerStateContext.Provider value={state}>\n      <ViewerDispatchContext.Provider\n        value={dispatch as unknown as ViewerContextStore}\n      >\n        {children}\n      </ViewerDispatchContext.Provider>\n    </ViewerStateContext.Provider>\n  );\n};\n\nfunction useViewerState() {\n  const context = React.useContext(ViewerStateContext);\n  if (context === undefined) {\n    throw new Error(\"useViewerState must be used within a ViewerProvider\");\n  }\n  return context;\n}\n\nfunction useViewerDispatch() {\n  const context = React.useContext(ViewerDispatchContext);\n  if (context === undefined) {\n    throw new Error(\"useViewerDispatch must be used within a ViewerProvider\");\n  }\n  return context;\n}\n\nexport { ViewerProvider, useViewerState, useViewerDispatch };\n","import {\n  AnnotationResources,\n  AnnotationResource,\n  ContentSearchQuery,\n} from \"src/types/annotations\";\nimport { CanvasNormalized } from \"@iiif/presentation-3\";\n\nexport const getAnnotationResources = (\n  vault: any,\n  activeCanvas: string,\n): AnnotationResources => {\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  if (!canvas?.annotations || !canvas.annotations[0]) return [];\n\n  const annotationPages: AnnotationResources = vault.get(canvas.annotations);\n\n  /**\n   * Filter out annotation pages that don't have any Annotations in the items array.\n   */\n  return annotationPages\n    .filter((annotationPage) => {\n      if (!annotationPage.items || !annotationPage.items.length) return false;\n      return annotationPage;\n    })\n    .map((annotationPage) => {\n      /**\n       * If the annotation page doesn't have a label, add a default label.\n       * Set this value in a CONFIG and not here.\n       */\n      const label = annotationPage.label || { none: [\"Annotations\"] };\n      return { ...annotationPage, label };\n    });\n};\n\nexport const getContentSearchResources = async (\n  contentSearchVault: any,\n  searchUrl: string,\n  tabLabel: string,\n  searchQuery?: ContentSearchQuery,\n): Promise<AnnotationResource> => {\n  if (searchQuery == undefined || searchQuery[\"q\"] == undefined) {\n    // must return a label because Information Panel tab requires a label\n    return { label: { none: [tabLabel] } } as unknown as AnnotationResource;\n  }\n\n  // TODO: handle other query params (e.g. motivation, date, user) defined in\n  // Content Search spec\n  const url = `${searchUrl}?q=${searchQuery[\"q\"].trim()}`;\n\n  let annotationPage;\n  try {\n    annotationPage = await contentSearchVault.load(url);\n  } catch (error) {\n    console.log(\"Could not load content search.\");\n    return {} as AnnotationResource;\n  }\n\n  if (annotationPage.label == undefined) {\n    annotationPage.label = { none: [tabLabel] };\n  }\n  return annotationPage;\n};\n","import {\n  Annotation,\n  AnnotationPageNormalized,\n  Canvas,\n  CanvasNormalized,\n  ContentResource,\n  ExternalResourceTypes,\n  IIIFExternalWebResource,\n} from \"@iiif/presentation-3\";\n\nexport interface CanvasEntity {\n  canvas: CanvasNormalized | undefined;\n  accompanyingCanvas: Canvas | undefined;\n  annotationPage: AnnotationPageNormalized | undefined;\n  annotations: Array<Annotation | undefined>;\n}\n\nexport const getCanvasByCriteria = (\n  vault: any,\n  item: Canvas,\n  motivation: string,\n  paintingType: Array<ExternalResourceTypes>,\n): CanvasEntity => {\n  const entity: CanvasEntity = {\n    canvas: undefined,\n    accompanyingCanvas: undefined,\n    annotationPage: undefined,\n    annotations: [],\n  };\n\n  const filterAnnotations = (annotation: Annotation) => {\n    if (annotation) {\n      // Handle invalid annotations\n      if (!annotation.body || !annotation.motivation) {\n        console.error(\n          `Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'`,\n          annotation,\n        );\n        return;\n      }\n\n      let annotationBody = annotation.body as\n        | ContentResource\n        | ContentResource[];\n\n      if (Array.isArray(annotationBody)) annotationBody = annotationBody[0];\n\n      // console.log(\"annotationBody\", annotationBody);\n\n      const resource: IIIFExternalWebResource = vault.get(annotationBody.id);\n\n      if (!resource) return;\n      switch (motivation) {\n        case \"painting\":\n          if (\n            annotation.target === item.id &&\n            annotation.motivation &&\n            annotation.motivation[0] === \"painting\" &&\n            paintingType.includes(resource.type)\n          )\n            annotation.body = resource;\n          return !!annotation;\n        case \"supplementing\":\n          return;\n        default: {\n          throw new Error(`Invalid annotation motivation.`);\n        }\n      }\n    }\n  };\n\n  entity.canvas = vault.get(item);\n\n  if (entity.canvas) {\n    entity.annotationPage = vault.get(entity.canvas.items[0]);\n    entity.accompanyingCanvas = entity.canvas?.accompanyingCanvas\n      ? vault.get(entity.canvas?.accompanyingCanvas)\n      : undefined;\n  }\n\n  /**\n   * get all annotations on an annotation page resource\n   * and add them to the annotations array on the canvas entity\n   */\n  if (entity.annotationPage) {\n    /**\n     * get all initial annotation page resources\n     */\n    const annotationPageResources = vault\n      .get(entity.annotationPage.items)\n      .map((item) => {\n        return {\n          body: vault.get(item.body[0].id),\n          motivation: item.motivation,\n          type: \"Annotation\",\n        };\n      });\n\n    const annotations: Annotation[] = [];\n    annotationPageResources.forEach((annotation) => {\n      /**\n       * determine if type is a choice of multiple annotations\n       * if so, add each annotation to the annotations array\n       */\n      if (annotation.body.type === \"Choice\") {\n        annotation.body.items.forEach((item) =>\n          annotations.push({\n            ...annotation,\n            id: item.id,\n            body: vault.get(item.id),\n          }),\n        );\n\n        /**\n         * if not, add the single annotation to the annotations array\n         */\n      } else {\n        annotations.push(annotation);\n      }\n    });\n\n    /**\n     * filter annotations and scrub invalid annotations\n     */\n    entity.annotations = annotations.filter(filterAnnotations);\n  }\n\n  return entity;\n};\n","import { InternationalString } from \"@iiif/presentation-3\";\n\n// Get string from a IIIF pres 3 label by language code\nexport const getLabel = (\n  label: InternationalString,\n  language: string = \"en\",\n) => {\n  /*\n   * If no label exists, return an empty string.\n   */\n  if (!label) return \"\";\n\n  /*\n   * If InternationalString code does not exist on label, then\n   * return what may be there, ex: label.none[0] OR label.fr[0]\n   */\n  if (!label[language]) {\n    const codes: Array<string> = Object.getOwnPropertyNames(label);\n    if (codes.length > 0) return label[codes[0]];\n  }\n\n  /*\n   * Return label value for InternationalString code `en`\n   */\n  return label[language];\n};\n","import { IIIFExternalWebResource } from \"@iiif/presentation-3\";\nimport { getCanvasByCriteria } from \"src/hooks/use-iiif\";\n\nexport const getPaintingResource = (\n  vault: any,\n  id: string,\n): IIIFExternalWebResource[] | undefined => {\n  const canvasEntity = getCanvasByCriteria(\n    vault,\n    { id, type: \"Canvas\" },\n    \"painting\",\n    [\"Image\", \"Sound\", \"Video\"],\n  );\n\n  if (canvasEntity.annotations.length === 0) return;\n\n  if (canvasEntity.annotations && canvasEntity.annotations)\n    return canvasEntity.annotations.map(\n      (item) => item?.body,\n    ) as IIIFExternalWebResource[];\n\n  return;\n};\n","import { CanvasEntity } from \"src/hooks/use-iiif/getCanvasByCriteria\";\nimport { IIIFExternalWebResource } from \"@iiif/presentation-3\";\n\nexport const getThumbnail = (\n  vault: any,\n  entity: CanvasEntity,\n  width: number,\n  height: number,\n) => {\n  /*\n   * 1. Initiate empty candidates array.\n   */\n  const candidates: Array<IIIFExternalWebResource> = [];\n\n  /*\n   * 2. Check if canvas has an explicitly assigned IIIF thumbnail.\n   */\n  if (entity.canvas)\n    if (entity.canvas.thumbnail.length > 0) {\n      const canvasThumbnail: IIIFExternalWebResource = vault.get(\n        entity.canvas.thumbnail[0],\n      );\n      candidates.push(canvasThumbnail);\n    }\n\n  if (entity.annotations[0]) {\n    /*\n     * 3. Check if painting annotation has an explicitly assigned IIIF thumbnail.\n     */\n    if (entity.annotations[0].thumbnail)\n      if (entity.annotations[0].thumbnail.length > 0) {\n        const annotationThumbnail: IIIFExternalWebResource = vault.get(\n          entity.annotations[0].thumbnail[0],\n        );\n        candidates.push(annotationThumbnail);\n      }\n\n    /*\n     * 4. Check if painting annotation is of type Image.\n     */\n    if (!entity.annotations[0].body) return;\n    const annotationBody = entity.annotations[0]\n      .body as IIIFExternalWebResource;\n\n    if (annotationBody.type === \"Image\") candidates.push(annotationBody);\n  }\n\n  /*\n   * 5. Validate candidates and make selection.\n   */\n  if (candidates.length === 0) return;\n\n  const selectedCandidate: IIIFExternalWebResource = {\n    id: candidates[0].id,\n    format: candidates[0].format,\n    type: candidates[0].type,\n    width: width,\n    height: height,\n  };\n\n  /*\n   * 6. Return (for time being crudely) constructed image object.\n   */\n  const thumbnailContent = selectedCandidate;\n\n  return thumbnailContent;\n};\n","// OpenSeadragon SVG Overlay plugin 0.0.5\n// https://github.com/openseadragon/svg-overlay/issues/34#issuecomment-1147992921\nimport OpenSeadragon from \"openseadragon\";\n\nlet $ = window.OpenSeadragon;\n\nif (!$) {\n  $ = OpenSeadragon;\n  if (!$) {\n    throw new Error(\"OpenSeadragon is missing.\");\n  }\n}\n\nconst svgNS = \"http://www.w3.org/2000/svg\";\n\n// ----------\nif ($.Viewer) {\n  // @ts-expect-error: svgOverlay does not exist on Viewer\n  $.Viewer.prototype.svgOverlay = function () {\n    if (this._svgOverlayInfo) {\n      return this._svgOverlayInfo;\n    }\n\n    this._svgOverlayInfo = new Overlay(this);\n    return this._svgOverlayInfo;\n  };\n}\n// ----------\nconst Overlay = function (viewer) {\n  // eslint-disable-next-line @typescript-eslint/no-this-alias\n  const self = this;\n\n  this._viewer = viewer;\n  this._containerWidth = 0;\n  this._containerHeight = 0;\n\n  this._svg = document.createElementNS(svgNS, \"svg\");\n  this._svg.style.position = \"absolute\";\n  this._svg.style.left = 0;\n  this._svg.style.top = 0;\n  this._svg.style.width = \"100%\";\n  this._svg.style.height = \"100%\";\n  this._viewer.canvas.appendChild(this._svg);\n\n  this._node = document.createElementNS(svgNS, \"g\");\n  this._svg.appendChild(this._node);\n\n  this._viewer.addHandler(\"animation\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"open\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"rotate\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"flip\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"resize\", function () {\n    self.resize();\n  });\n\n  this.resize();\n};\n\n// ----------\nOverlay.prototype = {\n  // ----------\n  node: function () {\n    return this._node;\n  },\n\n  // ----------\n  resize: function () {\n    if (this._containerWidth !== this._viewer.container.clientWidth) {\n      this._containerWidth = this._viewer.container.clientWidth;\n      this._svg.setAttribute(\"width\", this._containerWidth);\n    }\n\n    if (this._containerHeight !== this._viewer.container.clientHeight) {\n      this._containerHeight = this._viewer.container.clientHeight;\n      this._svg.setAttribute(\"height\", this._containerHeight);\n    }\n\n    const p = this._viewer.viewport.pixelFromPoint(new $.Point(0, 0), true);\n    const zoom = this._viewer.viewport.getZoom(true);\n    const rotation = this._viewer.viewport.getRotation();\n    const flipped = this._viewer.viewport.getFlip();\n    // TODO: Expose an accessor for _containerInnerSize in the OSD API so we don't have to use the private variable.\n    const containerSizeX = this._viewer.viewport._containerInnerSize.x;\n    let scaleX = containerSizeX * zoom;\n    const scaleY = scaleX;\n\n    if (flipped) {\n      // Makes the x component of the scale negative to flip the svg\n      scaleX = -scaleX;\n      // Translates svg back into the correct coordinates when the x scale is made negative.\n      p.x = -p.x + containerSizeX;\n    }\n\n    this._node.setAttribute(\n      \"transform\",\n      \"translate(\" +\n        p.x +\n        \",\" +\n        p.y +\n        \") scale(\" +\n        scaleX +\n        \",\" +\n        scaleY +\n        \") rotate(\" +\n        rotation +\n        \")\",\n    );\n  },\n  // ----------\n  onClick: function (node, handler) {\n    // TODO: Fast click for mobile browsers\n\n    new $.MouseTracker({\n      element: node,\n      clickHandler: handler,\n    }).setTracking(true);\n  },\n};\n\nexport const OsdSvgOverlay = (viewer) => {\n  return new Overlay(viewer);\n};\n","import { AnnotationTarget } from \"@iiif/presentation-3\";\nimport { ParsedAnnotationTarget } from \"src/types/annotations\";\n\ntype AnnotationTargetExtended = AnnotationTarget & {\n  selector?: any;\n  source?: string;\n  svg?: string;\n};\n\nconst parseAnnotationTarget = (target: AnnotationTargetExtended | string) => {\n  let parsedTarget: ParsedAnnotationTarget = {\n    id: typeof target === \"string\" ? target : target.source,\n  };\n\n  if (typeof target === \"string\") {\n    if (target.includes(\"#xywh=\")) {\n      const parts = target.split(\"#xywh=\");\n      if (parts && parts[1]) {\n        const [x, y, w, h] = parts[1].split(\",\").map((value) => Number(value));\n        parsedTarget = {\n          id: parts[0],\n          rect: {\n            x,\n            y,\n            w,\n            h,\n          },\n        };\n      }\n    } else if (target.includes(\"#t=\")) {\n      const parts = target.split(\"#t=\");\n      if (parts && parts[1]) {\n        parsedTarget = {\n          id: parts[0],\n          t: parts[1],\n        };\n      }\n    }\n  } else if (typeof target === \"object\") {\n    if (target.selector?.type === \"PointSelector\") {\n      parsedTarget = {\n        id: target.source,\n        point: {\n          x: target.selector.x!,\n          y: target.selector.y!,\n        },\n      };\n    } else if (target.selector?.type === \"SvgSelector\") {\n      parsedTarget = {\n        id: target.source,\n        svg: target.selector.value,\n      };\n    }\n  }\n\n  return parsedTarget;\n};\n\nexport { parseAnnotationTarget };\n","import {\n  Canvas,\n  CollectionNormalized,\n  IIIFExternalWebResource,\n  ImageService,\n  ManifestNormalized,\n  Service,\n} from \"@iiif/presentation-3\";\nimport { decodeContentState } from \"@iiif/vault-helpers\";\n\nexport const getCanvasResource = (canvas: Canvas) => {\n  if (canvas?.items) {\n    const annotationPage = canvas?.items[0];\n    if (annotationPage?.items) {\n      const resource = annotationPage?.items[0].body as IIIFExternalWebResource;\n      if (resource?.hasOwnProperty(\"id\")) {\n        return resource.id as string;\n      }\n    }\n  }\n};\n\nexport const getInfoResponse = (id: string) =>\n  fetch(`${id.replace(/\\/$/, \"\")}/info.json`)\n    .then((response) => response.json())\n    .then((json) => json)\n    .catch((error: any) => {\n      console.error(\n        `The IIIF tilesource ${id.replace(\n          /\\/$/,\n          \"\",\n        )}/info.json failed to load: ${error}`,\n      );\n    });\n\nexport const getImageServiceURI = (service: Service[] | undefined) => {\n  let imageService: ImageService;\n  let imageServiceURI: string | undefined;\n\n  if (Array.isArray(service)) {\n    imageService = service[0] as ImageService;\n    if (imageService) {\n      let id: string | undefined;\n      \"@id\" in imageService\n        ? (id = imageService[\"@id\"])\n        : (id = imageService.id);\n\n      imageServiceURI = id;\n    }\n  }\n\n  return imageServiceURI;\n};\n\nconst parseIiifContent = (iiifContent: string) => {\n  let resourceId;\n  let active;\n  if (isURL(iiifContent)) {\n    resourceId = iiifContent;\n    active = {};\n  } else {\n    const json = JSON.parse(decodeContentState(iiifContent));\n    switch (json?.type) {\n      // https://iiif.io/api/content-state/1.0/#51-a-region-of-a-canvas-in-a-manifest\n      // https://iiif.io/api/content-state/1.0/#52-start-playing-at-a-point-in-a-recording\n      // https://iiif.io/api/content-state/1.0/#53-multiple-targets-for-a-comparison-view\n      // https://iiif.io/api/content-state/1.0/#54-search-results\n      case \"SpecificResource\":\n      case \"Range\":\n      case \"Annotation\":\n        resourceId = json?.target.partOf[0].id;\n        active = {\n          manifest: resourceId,\n          canvas: json?.target.id,\n        };\n        break;\n      case \"Canvas\":\n        resourceId = json?.partOf[0].id;\n        active = {\n          manifest: resourceId,\n          canvas: json?.id,\n        };\n        break;\n      case \"Manifest\":\n        resourceId = json?.id;\n        active = {\n          collection: json?.partOf[0]?.id,\n          manifest: json?.id,\n        };\n        break;\n      case \"Collection\":\n        resourceId = json?.id;\n        active = {\n          collection: resourceId,\n        };\n        break;\n    }\n  }\n  return { resourceId, active };\n};\n\nexport const decodeContentStateContainerURI = (iiifContent: string) => {\n  const { resourceId, active } = parseIiifContent(iiifContent);\n  return active.collection || active.manifest || resourceId;\n};\n\nexport const getActiveCanvas = (\n  iiifContent: string,\n  manifest: ManifestNormalized,\n) => {\n  const canvases = manifest.items.map((item) => item.id);\n  const { active } = parseIiifContent(iiifContent);\n  const canvas = active.canvas;\n  return canvases.includes(canvas) ? canvas : canvases[0];\n};\n\nexport const getActiveManifest = (\n  iiifContent: string,\n  collection: CollectionNormalized,\n) => {\n  const { active } = parseIiifContent(iiifContent);\n  const manifest = active.manifest;\n  const manifests = collection.items\n    .filter((item) => item.type === \"Manifest\")\n    .map((manifest) => manifest.id);\n  if (manifests.length == 0) return null;\n  return manifests.includes(manifest) ? manifest : manifests[0];\n};\n\nconst isURL = (url: string) => {\n  try {\n    new URL(url);\n  } catch {\n    return false;\n  }\n  return true;\n};\n","export enum OpenSeadragonImageTypes {\n  TiledImage = \"tiledImage\",\n  SimpleImage = \"simpleImage\",\n}\n","import {\n  Annotation,\n  AnnotationNormalized,\n  IIIFExternalWebResource,\n  type CanvasNormalized,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\nimport OpenSeadragon from \"openseadragon\";\nimport {\n  type OverlayOptions,\n  type ViewerConfigOptions,\n} from \"src/context/viewer-context\";\nimport { OsdSvgOverlay } from \"src/lib/openseadragon-svg\";\nimport { parseAnnotationTarget } from \"src/lib/annotation-helpers\";\n\nimport { ParsedAnnotationTarget } from \"src/types/annotations\";\nimport { getImageServiceURI } from \"src/lib/iiif\";\nimport { OpenSeadragonImageTypes } from \"src/types/open-seadragon\";\n\nexport function addOverlaysToViewer(\n  viewer: OpenSeadragon.Viewer,\n  canvas: CanvasNormalized,\n  configOptions: OverlayOptions,\n  annotations: Annotation[] | AnnotationNormalized[],\n  overlaySelector: string,\n): void {\n  if (!viewer) return;\n\n  const scale = 1 / canvas.width;\n\n  annotations.forEach((annotation) => {\n    if (!annotation.target) return;\n\n    const parsedAnnotationTarget = parseAnnotationTarget(annotation.target);\n    const { point, rect, svg } = parsedAnnotationTarget;\n\n    if (rect) {\n      const { x, y, w, h } = rect;\n      addRectangularOverlay(\n        viewer,\n        x * scale,\n        y * scale,\n        w * scale,\n        h * scale,\n        configOptions,\n        overlaySelector,\n      );\n    }\n\n    if (point) {\n      const { x, y } = point;\n      const svg = `\n        <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n          <circle cx=\"${x}\" cy=\"${y}\" r=\"20\" />\n        </svg>\n      `;\n\n      addSvgOverlay(viewer, svg, configOptions, scale, overlaySelector);\n    }\n\n    if (svg) {\n      addSvgOverlay(viewer, svg, configOptions, scale, overlaySelector);\n    }\n  });\n}\n\nexport function createOpenSeadragonRect(\n  canvas: CanvasNormalized,\n  parsedAnnotationTarget: ParsedAnnotationTarget,\n  zoomLevel: number,\n) {\n  let x,\n    y,\n    w = 40,\n    h = 40;\n\n  if (parsedAnnotationTarget.rect) {\n    x = parsedAnnotationTarget.rect.x;\n    y = parsedAnnotationTarget.rect.y;\n    w = parsedAnnotationTarget.rect.w;\n    h = parsedAnnotationTarget.rect.h;\n  }\n\n  if (parsedAnnotationTarget.point) {\n    x = parsedAnnotationTarget.point.x;\n    y = parsedAnnotationTarget.point.y;\n  }\n\n  // TODO: How to handle SVG where no rect or point exists?\n  // @ts-ignore\n  if (parseAnnotationTarget.svg) {\n  }\n\n  const scale = 1 / canvas.width;\n  const rect = new OpenSeadragon.Rect(\n    x * scale - ((w * scale) / 2) * (zoomLevel - 1),\n    y * scale - ((h * scale) / 2) * (zoomLevel - 1),\n    w * scale * zoomLevel,\n    h * scale * zoomLevel,\n  );\n\n  return rect;\n}\n\n/**\n * Add a rectangular overlay to an OpenSeadragon viewer\n */\nfunction addRectangularOverlay(\n  viewer: OpenSeadragon.Viewer,\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  configOptions: OverlayOptions,\n  overlaySelector: string,\n): void {\n  const rect = new OpenSeadragon.Rect(x, y, w, h);\n  const div = document.createElement(\"div\");\n\n  if (configOptions) {\n    const { backgroundColor, opacity, borderType, borderColor, borderWidth } =\n      configOptions;\n\n    div.style.backgroundColor = backgroundColor as string;\n    div.style.opacity = opacity as string;\n    div.style.border = `${borderType} ${borderWidth} ${borderColor}`;\n    div.className = overlaySelector;\n  }\n\n  viewer.addOverlay(div, rect);\n}\n\nfunction convertSVGStringToHTML(svgString) {\n  if (!svgString) return null;\n  const template = document.createElement(\"template\");\n  template.innerHTML = svgString.trim();\n  const result = template.content.children;\n\n  return result[0];\n}\n\nexport function addSvgOverlay(\n  viewer: any,\n  svgString: string,\n  configOptions: OverlayOptions,\n  scale: number,\n  overlaySelector: string,\n) {\n  const svgEl = convertSVGStringToHTML(svgString);\n  if (svgEl) {\n    for (const child of svgEl.children) {\n      svg_processChild(viewer, child, configOptions, scale, overlaySelector);\n    }\n  }\n}\n\nfunction svg_processChild(\n  viewer: any,\n  child: ChildNode,\n  configOptions: OverlayOptions,\n  scale: number,\n  overlaySelector: string,\n) {\n  if (child.nodeName === \"#text\") {\n    svg_handleTextNode(child);\n  } else {\n    const newElement = svg_handleElementNode(child, configOptions, scale);\n    const overlay = OsdSvgOverlay(viewer);\n    overlay.node().append(newElement);\n    overlay._svg?.setAttribute(\"class\", overlaySelector);\n\n    // BUG: svg with children elements aren't formated correctly.\n    child.childNodes.forEach((child) => {\n      svg_processChild(viewer, child, configOptions, scale, overlaySelector);\n    });\n  }\n}\n\nexport function svg_handleElementNode(\n  child: any,\n  configOptions: OverlayOptions,\n  scale: number,\n) {\n  let hasStrokeColor = false;\n  let hasStrokeWidth = false;\n  let hasFillColor = false;\n  let hasFillOpacity = false;\n\n  const newElement = document.createElementNS(\n    \"http://www.w3.org/2000/svg\",\n    child.nodeName,\n  );\n\n  if (child.attributes.length > 0) {\n    for (let index = 0; index < child.attributes.length; index++) {\n      const element = child.attributes[index];\n      switch (element.name) {\n        case \"fill\":\n          hasFillColor = true;\n          break;\n        case \"stroke\":\n          hasStrokeColor = true;\n          break;\n        case \"stroke-width\":\n          hasStrokeWidth = true;\n          break;\n        case \"fill-opacity\":\n          hasFillOpacity = true;\n          break;\n      }\n      newElement.setAttribute(element.name, element.textContent);\n    }\n  }\n\n  if (!hasStrokeColor) {\n    newElement.style.stroke = configOptions?.borderColor as string;\n  }\n  if (!hasStrokeWidth) {\n    newElement.style.strokeWidth = configOptions?.borderWidth as string;\n  }\n  if (!hasFillColor) {\n    newElement.style.fill = configOptions?.backgroundColor as string;\n  }\n  if (!hasFillOpacity) {\n    newElement.style.fillOpacity = configOptions?.opacity as string;\n  }\n  newElement.setAttribute(\"transform\", `scale(${scale})`);\n\n  return newElement;\n}\n\nfunction svg_handleTextNode(child: ChildNode) {\n  if (!child.textContent) {\n    return;\n  }\n  if (child.textContent.includes(\"\\n\")) {\n    return;\n  }\n  console.log(\n    \"nodeName:\",\n    child.nodeName,\n    \", textContent:\",\n    child.textContent,\n    \", childNodes.length\",\n    child.childNodes.length,\n  );\n}\n\nexport const parseImageBody = (body: IIIFExternalWebResource) => {\n  const hasImageService =\n    Array.isArray(body?.service) && body?.service.length > 0;\n\n  const uri = hasImageService ? getImageServiceURI(body?.service) : body?.id;\n  const imageType: OpenSeadragonImageTypes = hasImageService\n    ? OpenSeadragonImageTypes.TiledImage\n    : OpenSeadragonImageTypes.SimpleImage;\n\n  return {\n    uri,\n    imageType,\n  };\n};\n\nexport const parseSrc = (src: string, isTiledImage: boolean) => {\n  const imageType = isTiledImage\n    ? OpenSeadragonImageTypes.TiledImage\n    : OpenSeadragonImageTypes.SimpleImage;\n\n  return {\n    uri: src,\n    imageType,\n  };\n};\nexport function removeOverlaysFromViewer(\n  viewer: OpenSeadragon.Viewer,\n  overlaySelector: string,\n) {\n  if (!viewer) return;\n\n  if (!overlaySelector.startsWith(\".\")) {\n    overlaySelector = \".\" + overlaySelector;\n  }\n  const elements = document.querySelectorAll(overlaySelector);\n  if (elements) {\n    elements.forEach((element) => viewer.removeOverlay(element));\n  }\n}\n\nexport function panToTarget(openSeadragonViewer, zoomLevel, target, canvas) {\n  const parsedAnnotationTarget = parseAnnotationTarget(target);\n\n  const { point, rect, svg } = parsedAnnotationTarget;\n\n  if (point || rect || svg) {\n    const rect = createOpenSeadragonRect(\n      canvas,\n      parsedAnnotationTarget,\n      zoomLevel,\n    );\n    openSeadragonViewer?.viewport.fitBounds(rect);\n  }\n}\n\nexport function addContentSearchOverlays(\n  contentSearchVault: any,\n  contentSearch: AnnotationPageNormalized,\n  openSeadragonViewer,\n  canvas: CanvasNormalized,\n  configOptions: ViewerConfigOptions,\n) {\n  if (!contentSearch?.items) return;\n  if (contentSearch?.items.length === 0) return;\n\n  const annotations: Array<AnnotationNormalized> = [];\n  contentSearch.items.forEach((item) => {\n    const annotation = contentSearchVault.get(item.id) as AnnotationNormalized;\n\n    if (typeof annotation.target === \"string\") {\n      if (annotation.target.startsWith(canvas.id)) {\n        annotations.push(annotation as unknown as AnnotationNormalized);\n      }\n    }\n  });\n\n  if (openSeadragonViewer && configOptions.contentSearch?.overlays) {\n    addOverlaysToViewer(\n      openSeadragonViewer,\n      canvas,\n      configOptions.contentSearch.overlays,\n      annotations,\n      \"content-search-overlay\",\n    );\n  }\n}\n","import { createStitches } from \"@stitches/react\";\n\nconst hue = 209;\n\nexport const theme = {\n  colors: {\n    /*\n     * Black and dark grays in a light theme.\n     * Must contrast to 4.5 or greater with `secondary`.\n     */\n    primary: \"#1a1d1e\",\n    primaryMuted: \"#26292b\",\n    primaryAlt: \"#151718\",\n\n    /*\n     * Key brand color(s).\n     * Must contrast to 4.5 or greater with `secondary`.\n     */\n    accent: `hsl(${hue} 100% 38.2%)`,\n    accentMuted: `hsl(${hue} 80% 61.8%)`,\n    accentAlt: `hsl(${hue} 80% 30%)`,\n\n    /*\n     * White and light grays in a light theme.\n     * Must contrast to 4.5 or greater with `primary` and  `accent`.\n     */\n    secondary: \"#FFFFFF\",\n    secondaryMuted: \"#e6e8eb\",\n    secondaryAlt: \"#c1c8cd\",\n  },\n  fontSizes: {\n    1: \"12px\",\n    2: \"13px\",\n    3: \"15px\",\n    4: \"17px\",\n    5: \"19px\",\n    6: \"21px\",\n    7: \"27px\",\n    8: \"35px\",\n    9: \"59px\",\n  },\n  lineHeights: {\n    1: \"12px\",\n    2: \"13px\",\n    3: \"15px\",\n    4: \"17px\",\n    5: \"19px\",\n    6: \"21px\",\n    7: \"27px\",\n    8: \"35px\",\n    9: \"59px\",\n  },\n  sizes: {\n    1: \"5px\",\n    2: \"10px\",\n    3: \"15px\",\n    4: \"20px\",\n    5: \"25px\",\n    6: \"35px\",\n    7: \"45px\",\n    8: \"65px\",\n    9: \"80px\",\n  },\n  space: {\n    1: \"5px\",\n    2: \"10px\",\n    3: \"15px\",\n    4: \"20px\",\n    5: \"25px\",\n    6: \"35px\",\n    7: \"45px\",\n    8: \"65px\",\n    9: \"80px\",\n  },\n  radii: {\n    1: \"4px\",\n    2: \"6px\",\n    3: \"8px\",\n    4: \"12px\",\n    round: \"50%\",\n    pill: \"9999px\",\n  },\n  transitions: {\n    all: \"all 300ms cubic-bezier(0.16, 1, 0.3, 1)\",\n  },\n  zIndices: {\n    1: \"100\",\n    2: \"200\",\n    3: \"300\",\n    4: \"400\",\n    max: \"999\",\n  },\n};\n\nexport const media = {\n  xxs: \"(max-width: 349px)\",\n  xs: \"(max-width: 575px)\",\n  sm: \"(max-width: 767px)\",\n  md: \"(max-width: 991px)\",\n  lg: \"(max-width: 90rem)\",\n  xl: \"(min-width: calc(90rem + 1px))\",\n};\n\nexport type { CSS, VariantProps } from \"@stitches/react\";\n\nexport const { styled, css, keyframes, createTheme } = createStitches({\n  theme,\n  media,\n});\n","import { styled } from \"src/styles/stitches.config\";\n\nconst ErrorFallbackStyled = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\",\n});\n\nconst Headline = styled(\"p\", {\n  fontWeight: \"bold\",\n  fontSize: \"x-large\",\n});\n\nconst ErrorBody = styled(\"span\", {\n  fontSize: \"medium\",\n});\n\nexport { ErrorFallbackStyled, ErrorBody, Headline };\n","import {\n  ErrorBody,\n  ErrorFallbackStyled,\n  Headline,\n} from \"src/components/UI/ErrorFallback/ErrorFallback.styled\";\n\nimport React from \"react\";\n\ninterface ErrorFallbackProps {\n  error: Error;\n}\n\nconst ErrorFallback: React.FC<ErrorFallbackProps> = ({ error }) => {\n  const { message } = error;\n\n  return (\n    <ErrorFallbackStyled role=\"alert\">\n      <Headline data-testid=\"headline\">Something went wrong</Headline>\n      {message && <ErrorBody>{`Error message: ${message}`} </ErrorBody>}\n    </ErrorFallbackStyled>\n  );\n};\n\nexport default ErrorFallback;\n","import * as Collapsible from \"@radix-ui/react-collapsible\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst MediaWrapper = styled(\"div\", {\n  position: \"relative\",\n  zIndex: \"0\",\n});\n\nconst Content = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"row\",\n  flexGrow: \"1\",\n  overflow: \"hidden\",\n\n  \"@sm\": {\n    flexDirection: \"column\",\n  },\n});\n\nconst Main = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  flexGrow: \"1\",\n  flexShrink: \"1\",\n  width: \"61.8%\",\n\n  \"@sm\": {\n    width: \"100%\",\n  },\n});\n\nconst CollapsibleTrigger = styled(Collapsible.Trigger, {\n  display: \"none\",\n  border: \"none\",\n  padding: \"0\",\n  transition: \"$all\",\n  opacity: \"1\",\n  background: \"#6663\",\n  margin: \"1rem 0\",\n  borderRadius: \"6px\",\n\n  \"&[data-information-panel='false']\": {\n    opacity: \"0\",\n    marginTop: \"-59px\",\n  },\n\n  \"@sm\": {\n    display: \"flex\",\n\n    \"> span\": {\n      display: \"flex\",\n      flexGrow: \"1\",\n      fontSize: \"0.8333em\",\n      justifyContent: \"center\",\n      padding: \"0.5rem\",\n      fontFamily: \"inherit\",\n    },\n  },\n});\n\nconst CollapsibleContent = styled(Collapsible.Content, {\n  width: \"100%\",\n  display: \"flex\",\n});\n\nconst Aside = styled(\"aside\", {\n  display: \"flex\",\n  flexGrow: \"1\",\n  flexShrink: \"0\",\n  width: \"38.2%\",\n  maxHeight: \"100%\",\n\n  \"@sm\": {\n    width: \"100%\",\n  },\n});\n\nconst Wrapper = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  fontSmooth: \"auto\",\n  webkitFontSmoothing: \"antialiased\",\n\n  '&[data-absolute-position=\"true\"]': {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\",\n    zIndex: \"0\",\n  },\n\n  \"> div\": {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexGrow: \"1\",\n    justifyContent: \"flex-start\",\n    height: \"100%\",\n    maxHeight: \"100%\",\n\n    \"@sm\": {\n      [`& ${Content}`]: {\n        flexGrow: \"1\",\n      },\n\n      [`& ${Main}`]: {\n        flexGrow: \"0\",\n      },\n    },\n  },\n\n  \"@sm\": {\n    padding: \"0\",\n  },\n\n  \"&[data-information-panel-open='true']\": {\n    \"@sm\": {\n      position: \"fixed\",\n      height: \"100%\",\n      width: \"100%\",\n      top: \"0\",\n      left: \"0\",\n      zIndex: \"2500000000\",\n\n      [`& ${MediaWrapper}`]: {\n        display: \"none\",\n      },\n\n      [`& ${CollapsibleTrigger}`]: {\n        margin: \"1rem\",\n      },\n\n      [`& ${CollapsibleContent}`]: {\n        height: \"100%\",\n      },\n    },\n  },\n});\n\nexport {\n  Wrapper,\n  Content,\n  Main,\n  MediaWrapper,\n  CollapsibleContent,\n  CollapsibleTrigger,\n  Aside,\n};\n","import React, { ReactNode } from \"react\";\nimport * as Tabs from \"@radix-ui/react-tabs\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst Wrapper = styled(Tabs.Root, {\n  display: \"flex\",\n  flexDirection: \"column\",\n  width: \"100%\",\n  height: \"100%\",\n  flexGrow: \"1\",\n  flexShrink: \"0\",\n  position: \"relative\",\n  zIndex: \"1\",\n  maskImage: `linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)`,\n\n  \"@sm\": {\n    marginTop: \"0.5rem\",\n    boxShadow: \"none\",\n  },\n});\n\nconst List = styled(Tabs.List, {\n  display: \"flex\",\n  flexGrow: \"0\",\n  margin: \"0 1.618rem\",\n  borderBottom: \"4px solid #6663\",\n\n  \"@sm\": {\n    margin: \"0 1rem\",\n  },\n});\n\nconst Trigger = styled(Tabs.Trigger, {\n  display: \"flex\",\n  position: \"relative\",\n  padding: \"0.5rem 1rem\",\n  background: \"none\",\n  backgroundColor: \"transparent\",\n  fontFamily: \"inherit\",\n  border: \"none\",\n  opacity: \"0.7\",\n  fontSize: \"1rem\",\n  marginRight: \"1rem\",\n  lineHeight: \"1rem\",\n  whiteSpace: \"nowrap\",\n  cursor: \"pointer\",\n  fontWeight: 400,\n  transition: \"$all\",\n\n  \"&::after\": {\n    width: \"0\",\n    height: \"4px\",\n    content: \"\",\n    position: \"absolute\",\n    bottom: \"-4px\",\n    left: \"0\",\n    transition: \"$all\",\n  },\n\n  \"&[data-state='active']\": {\n    opacity: \"1\",\n    fontWeight: 700,\n\n    \"&::after\": {\n      width: \"100%\",\n      backgroundColor: \"$accent\",\n    },\n  },\n});\n\nconst Content = styled(Tabs.Content, {\n  display: \"flex\",\n  flexGrow: \"1\",\n  flexShrink: \"0\",\n  position: \"absolute\",\n  top: \"0\",\n  left: \"0\",\n\n  \"&[data-state='active']\": {\n    width: \"100%\",\n    height: \"calc(100% - 2rem)\",\n    padding: \"1.618rem 0\",\n  },\n});\n\ninterface Scrollable {\n  handleScroll?: (e) => void;\n  children?: ReactNode;\n  className?: string;\n}\n\nconst ScrollableComponent: React.FC<Scrollable> = ({\n  handleScroll,\n  children,\n  className,\n}) => (\n  <div className={className} onScroll={handleScroll}>\n    {children}\n  </div>\n);\n\nconst Scroll = styled(ScrollableComponent, {\n  position: \"relative\",\n  height: \"100%\",\n  width: \"100%\",\n  overflowY: \"scroll\",\n});\n\nexport { Content, List, Scroll, Trigger, Wrapper };\n","import { CSS, styled } from \"src/styles/stitches.config\";\n\nconst annotationItemRow: CSS = {\n  position: \"relative\",\n  cursor: \"pointer\",\n  display: \"flex\",\n  width: \"100%\",\n  justifyContent: \"space-between\",\n  textAlign: \"left\",\n  margin: \"0\",\n  padding: \"0.5rem 1.618rem\",\n  fontFamily: \"inherit\",\n  lineHeight: \"1.25em\",\n  fontSize: \"1rem\",\n  color: \"inherit\",\n  border: \"none\",\n  background: \"none\",\n};\n\nconst ButtonStyled = styled(\"button\", {\n  textAlign: \"left\",\n\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n});\n\nconst Group = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  width: \"100%\",\n});\n\nconst Item = styled(\"div\", {\n  ...annotationItemRow,\n});\n\nconst ItemHTMLWrapper = styled(\"div\", {\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n});\n\nexport { annotationItemRow, ButtonStyled, Group, Item, ItemHTMLWrapper };\n","import { ButtonStyled } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemPlainTextProps = {\n  value: string;\n  handleClick: (e) => void;\n};\n\nconst AnnotationItemPlainText: React.FC<AnnotationItemPlainTextProps> = ({\n  value,\n  handleClick,\n}) => {\n  return <ButtonStyled onClick={handleClick}>{value}</ButtonStyled>;\n};\n\nexport default AnnotationItemPlainText;\n","import { ItemHTMLWrapper } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemHTMLProps = {\n  value: string;\n  handleClick: (e) => void;\n};\n\nconst AnnotationItemHTML: React.FC<AnnotationItemHTMLProps> = ({\n  value,\n  handleClick,\n}) => {\n  return (\n    <ItemHTMLWrapper\n      dangerouslySetInnerHTML={{ __html: value }}\n      onClick={handleClick}\n    />\n  );\n};\n\nexport default AnnotationItemHTML;\n","// @ts-nocheck\n\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport interface NodeWebVttCue {\n  identifier?: string;\n  start: number;\n  end: number;\n  text: string;\n  styles?: string;\n  children?: Array<NodeWebVttCue>;\n}\nexport interface NodeWebVttCueNested extends NodeWebVttCue {\n  children?: Array<NodeWebVttCueNested>;\n}\n\nconst useWebVtt = () => {\n  function addIdentifiersToParsedCues(\n    cues: Array<NodeWebVttCue>,\n  ): Array<NodeWebVttCue> {\n    return cues.map((cue) => {\n      const identifier = cue.identifier || uuidv4();\n      return { ...cue, identifier };\n    });\n  }\n\n  /**\n   * This function takes an array of NodeWebVttCue items as input, where each item\n   * is an object with properties identifier, start, end, text, and styles. It\n   * iterates through the array of items and uses a stack to keep track of nested\n   * items. It compares the current item's start with the end of the items in the\n   * stack. If the current item's start is smaller than the end of the top item\n   * in the stack, it is considered a child of the top item and added to its\n   * children property. If the current item's start is greater than the end\n   * of the top item in the stack, it is considered a top-level item and added to\n   * the nestedItems array. The resulting nestedItems array contains the items\n   * organized into nested structures based on their start and end values.\n   */\n  function createNestedCues(flat: Array<NodeWebVttCue>): Array<NodeWebVttCue> {\n    const nestedItems = [];\n    const stack = [];\n\n    const cues = addIdentifiersToParsedCues(flat);\n\n    for (const item of cues) {\n      while (stack.length > 0 && stack[stack.length - 1].end <= item.start) {\n        stack.pop();\n      }\n\n      if (stack.length > 0) {\n        if (!stack[stack.length - 1].children) {\n          stack[stack.length - 1].children = [];\n        }\n        stack[stack.length - 1].children?.push(item);\n        stack.push(item);\n      } else {\n        nestedItems.push(item);\n        stack.push(item);\n      }\n    }\n\n    return nestedItems;\n  }\n\n  /**\n   * Is a cue a child of another cue\n   * @param cue Object\n   * @param cues Array\n   * @returns Boolean\n   */\n  function isChild(\n    cue: NodeWebVttCue,\n    cues: Array<NodeWebVttCue> = [],\n  ): boolean {\n    return cues.some(\n      (currentCue) =>\n        cue.start >= currentCue.start && cue.end <= currentCue.end,\n    );\n  }\n\n  /**\n   * Sort Cues by cue start time\n   * @param cues\n   * @returns Array\n   */\n  function orderCuesByTime(\n    cues: Array<NodeWebVttCue> = [],\n  ): Array<NodeWebVttCue> {\n    return cues.sort((cue1, cue2) => cue1.start - cue2.start);\n  }\n\n  return {\n    addIdentifiersToParsedCues,\n    createNestedCues,\n    isChild,\n    orderCuesByTime,\n  };\n};\n\nexport default useWebVtt;\n","import * as RadioGroup from \"@radix-ui/react-radio-group\";\n\nimport { keyframes, styled } from \"src/styles/stitches.config\";\n\nimport { annotationItemRow } from \"src/components/Viewer/InformationPanel/Annotation/Item.styled\";\n\nconst spin = keyframes({\n  from: { transform: \"rotate(360deg)\" },\n  to: { transform: \"rotate(0deg)\" },\n});\n\nexport const Group = styled(RadioGroup.Root, {\n  display: \"flex\",\n  flexDirection: \"column\",\n  width: \"100%\",\n});\n\nexport const Item = styled(RadioGroup.Item, {\n  ...annotationItemRow,\n\n  \"@sm\": {\n    padding: \"0.5rem 1rem\",\n    fontSize: \"0.8333rem\",\n  },\n\n  \"&::before\": {\n    content: \"\",\n    width: \"12px\",\n    height: \"12px\",\n    borderRadius: \"12px\",\n    position: \"absolute\",\n    backgroundColor: \"$primaryMuted\",\n    opacity: \"0\",\n    left: \"8px\",\n    marginTop: \"3px\",\n    boxSizing: \"content-box\",\n\n    \"@sm\": {\n      content: \"unset\",\n    },\n  },\n\n  \"&::after\": {\n    content: \"\",\n    width: \"4px\",\n    height: \"6px\",\n    position: \"absolute\",\n    backgroundColor: \"$secondary\",\n    opacity: \"0\",\n    clipPath: \"polygon(100% 50%, 0 100%, 0 0)\",\n    left: \"13px\",\n    marginTop: \"6px\",\n    boxSizing: \"content-box\",\n\n    \"@sm\": {\n      content: \"unset\",\n    },\n  },\n\n  strong: {\n    marginLeft: \"1rem\",\n  },\n\n  \"&:hover\": {\n    color: \"$accent\",\n\n    \"&::before\": {\n      backgroundColor: \"$accent\",\n      opacity: \"1\",\n    },\n\n    \"&::after\": {\n      content: \"\",\n      width: \"4px\",\n      height: \"6px\",\n      position: \"absolute\",\n      backgroundColor: \"$secondary\",\n      clipPath: \"polygon(100% 50%, 0 100%, 0 0)\",\n      opacity: \"1\",\n    },\n  },\n\n  \"&[aria-checked='true']\": {\n    backgroundColor: \"#6663\",\n\n    \"&::before\": {\n      content: \"\",\n      width: \"6px\",\n      height: \"6px\",\n      position: \"absolute\",\n      backgroundColor: \"transparent\",\n      border: \"3px solid $accentMuted\",\n      borderRadius: \"12px\",\n      left: \"8px\",\n      marginTop: \"4px\",\n      opacity: \"1\",\n      animation: \"1s linear infinite\",\n      animationName: spin,\n      boxSizing: \"content-box\",\n\n      \"@sm\": {\n        content: \"unset\",\n      },\n    },\n\n    \"&::after\": {\n      content: \"\",\n      width: \"6px\",\n      height: \"6px\",\n      position: \"absolute\",\n      backgroundColor: \"transparent\",\n      border: \"3px solid $accent\",\n      clipPath: \"polygon(100% 0, 100% 100%, 0 0)\",\n      borderRadius: \"12px\",\n      left: \"8px\",\n      marginTop: \"4px\",\n      opacity: \"1\",\n      animation: \"1.5s linear infinite\",\n      animationName: spin,\n      boxSizing: \"content-box\",\n\n      \"@sm\": {\n        content: \"unset\",\n      },\n    },\n  },\n});\n","import React, { useEffect, useRef, useState } from \"react\";\n\nimport { AutoScrollOptions } from \"src/context/viewer-context\";\nimport { Item } from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled\";\nimport { convertTime } from \"src/lib/utils\";\nimport {\n  ViewerContextStore,\n  useViewerDispatch,\n  useViewerState,\n} from \"src/context/viewer-context\";\n\nconst AutoScrollDisableTime = 750;\n\ninterface Props {\n  label: string;\n  start: number;\n  end: number;\n}\n\nconst findScrollableParent = (\n  element: HTMLElement | null,\n): HTMLElement | null => {\n  while (element && element !== document.body) {\n    const overflowY = window.getComputedStyle(element).overflowY;\n    const isScrollable = overflowY !== \"visible\" && overflowY !== \"hidden\";\n\n    if (isScrollable && element.scrollHeight > element.clientHeight) {\n      return element;\n    }\n\n    element = element.parentNode as HTMLElement;\n  }\n\n  return null;\n};\n\nconst Cue: React.FC<Props> = ({ label, start, end }) => {\n  const dispatch: any = useViewerDispatch();\n  const {\n    configOptions,\n    isAutoScrollEnabled,\n    isUserScrolling,\n  }: ViewerContextStore = useViewerState();\n  const autoScrollOptions = configOptions?.informationPanel?.vtt\n    ?.autoScroll as AutoScrollOptions;\n\n  const [isActive, updateIsActive] = useState(false);\n  const ref = useRef<HTMLButtonElement>(null);\n\n  const video = document.getElementById(\n    \"clover-iiif-video\",\n  ) as HTMLVideoElement;\n\n  useEffect(() => {\n    video?.addEventListener(\"timeupdate\", () => {\n      const { currentTime } = video;\n      updateIsActive(start <= currentTime && currentTime < end);\n    });\n\n    return () => document.removeEventListener(\"timeupdate\", () => {});\n  }, [end, start, video]);\n\n  useEffect(() => {\n    const withAutoScrollDisabled = (func) => {\n      dispatch({ type: \"updateAutoScrolling\", isAutoScrolling: true });\n      func();\n      setTimeout(\n        () => dispatch({ type: \"updateAutoScrolling\", isAutoScrolling: false }),\n        AutoScrollDisableTime,\n      );\n    };\n\n    if (isAutoScrollEnabled && isActive && ref.current && !isUserScrolling) {\n      /*\n       * reimplement HTMLElement.scrollIntoView() block behaviors\n       * using parent.scrollTo() to prevent outer element scrolling\n       */\n\n      const element = ref.current;\n      if (element && element instanceof HTMLElement) {\n        const parent = findScrollableParent(element);\n        if (parent && parent instanceof HTMLElement) {\n          let top;\n          switch (autoScrollOptions?.settings?.block) {\n            case \"center\":\n              const parentRect = parent.getBoundingClientRect();\n              top =\n                element.offsetTop +\n                element.offsetHeight -\n                Math.floor((parentRect.bottom - parentRect.top) / 2);\n              break;\n            case \"end\":\n              top =\n                element.offsetTop +\n                element.offsetHeight -\n                (parent.clientHeight - element.clientHeight) +\n                2;\n              break;\n            default:\n              top = element.offsetTop - 2;\n              break;\n          }\n          withAutoScrollDisabled(() =>\n            parent.scrollTo({\n              top,\n              left: 0,\n              behavior: autoScrollOptions?.settings?.behavior as ScrollBehavior,\n            }),\n          );\n        }\n      }\n    }\n  }, [\n    autoScrollOptions,\n    isActive,\n    isUserScrolling,\n    isAutoScrollEnabled,\n    dispatch,\n  ]);\n\n  const handleClick = () => {\n    if (video) {\n      video.pause();\n      video.currentTime = start;\n      video.play();\n    }\n  };\n\n  return (\n    <Item\n      ref={ref}\n      aria-checked={isActive}\n      data-testid=\"information-panel-cue\"\n      onClick={handleClick}\n      value={label}\n    >\n      {label}\n      <strong>{convertTime(start)}</strong>\n    </Item>\n  );\n};\n\nexport default Cue;\n","import { Item } from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nexport const MenuStyled = styled(\"ul\", {\n  listStyle: \"none\",\n  paddingLeft: \"1rem\",\n  position: \"relative\",\n\n  \"&&:first-child\": {\n    paddingLeft: \"0\",\n  },\n\n  \"& li ul\": {\n    [`& ${Item}`]: {\n      backgroundColor: \"unset\",\n\n      \"&::before\": {\n        content: \"none\",\n      },\n      \"&::after\": {\n        content: \"none\",\n      },\n    },\n  },\n\n  \"&:first-child\": {\n    margin: \"0 0 1.618rem\",\n  },\n});\n","import Cue from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue\";\nimport { MenuStyled } from \"src/components/Viewer/InformationPanel/Menu.styled\";\nimport { NodeWebVttCueNested } from \"src/hooks/use-webvtt\";\nimport React from \"react\";\n\ninterface MenuProps {\n  items: Array<NodeWebVttCueNested>;\n}\nconst Menu: React.FC<MenuProps> = ({ items }) => {\n  return (\n    <MenuStyled>\n      {items.map((item) => {\n        const { text, start, end, children, identifier } = item;\n        return (\n          <li key={identifier}>\n            <Cue label={text} start={start} end={end} />\n            {children && <Menu items={children} />}\n          </li>\n        );\n      })}\n    </MenuStyled>\n  );\n};\nexport default Menu;\n","import React, { useEffect } from \"react\";\nimport useWebVtt, {\n  NodeWebVttCue,\n  NodeWebVttCueNested,\n} from \"src/hooks/use-webvtt\";\n\nimport { Group } from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled\";\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport Menu from \"src/components/Viewer/InformationPanel/Menu\";\nimport { getLabel } from \"src/hooks/use-iiif\";\nimport { parse } from \"node-webvtt\";\n\ntype AnnotationItemVTTProps = {\n  label: InternationalString | undefined;\n  vttUri: string;\n};\n\nconst AnnotationItemVTT: React.FC<AnnotationItemVTTProps> = ({\n  label,\n  vttUri,\n}) => {\n  const [cues, setCues] = React.useState<Array<NodeWebVttCueNested>>([]);\n  const { createNestedCues, orderCuesByTime } = useWebVtt();\n  const [isNetworkError, setIsNetworkError] = React.useState<Error>();\n\n  useEffect(\n    () => {\n      if (vttUri)\n        fetch(vttUri, {\n          headers: {\n            \"Content-Type\": \"text/plain\",\n            Accept: \"application/json\",\n          },\n        })\n          .then((response) => response.text())\n          .then((data) => {\n            const flatCues = parse(data)\n              .cues as unknown as Array<NodeWebVttCue>;\n            const orderedCues = orderCuesByTime(flatCues);\n            const nestedCues = createNestedCues(orderedCues);\n            setCues(nestedCues);\n          })\n          .catch((error) => {\n            console.error(vttUri, error.toString());\n            setIsNetworkError(error);\n          });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [vttUri],\n  ); // NOTE: Do not include createNestedCues and orderCuesByTime in the dependency array as it will cause an infinite loop\n\n  return (\n    <Group\n      data-testid=\"annotation-item-vtt\"\n      aria-label={`navigate ${getLabel(label as InternationalString, \"en\")}`}\n    >\n      {isNetworkError && (\n        <div data-testid=\"error-message\">\n          Network Error: {isNetworkError.toString()}\n        </div>\n      )}\n      <Menu items={cues} />\n    </Group>\n  );\n};\n\nexport default AnnotationItemVTT;\n","import { ButtonStyled } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemImageProps = {\n  caption: string;\n  handleClick: (e) => void;\n  imageUri: string;\n};\n\nconst AnnotationItemImage: React.FC<AnnotationItemImageProps> = ({\n  caption,\n  handleClick,\n  imageUri,\n}) => {\n  return (\n    <ButtonStyled onClick={handleClick}>\n      <img src={imageUri} alt={`A visual annotation for ${caption}`} />\n      <span>{caption}</span>\n    </ButtonStyled>\n  );\n};\n\nexport default AnnotationItemImage;\n","import React from \"react\";\nimport { Item as ItemStyled } from \"src/components/Viewer/InformationPanel/Annotation/Item.styled\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\nimport {\n  AnnotationNormalized,\n  type CanvasNormalized,\n  EmbeddedResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\nimport AnnotationItemPlainText from \"./PlainText\";\nimport AnnotationItemHTML from \"./HTML\";\nimport AnnotationItemVTT from \"./VTT/VTT\";\nimport { panToTarget } from \"src/lib/openseadragon-helpers\";\nimport AnnotationItemImage from \"./Image\";\n\ntype Props = {\n  annotation: AnnotationNormalized;\n};\n\nexport const AnnotationItem: React.FC<Props> = ({ annotation }) => {\n  const { target } = annotation;\n\n  const viewerState: ViewerContextStore = useViewerState();\n  const { openSeadragonViewer, vault, activeCanvas, configOptions } =\n    viewerState;\n\n  const annotationBody: Array<\n    EmbeddedResource & {\n      label?: InternationalString;\n    }\n  > = annotation.body.map((body) => vault.get(body.id));\n\n  const annotationBodyFormat =\n    annotationBody.find((body) => body.format)?.format || \"\";\n\n  const annotationBodyValue =\n    annotationBody.find((body) => body.value)?.value || \"\";\n\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  function handleClick() {\n    if (!target) return;\n\n    const zoomLevel = configOptions.annotationOverlays?.zoomLevel || 1;\n    panToTarget(openSeadragonViewer, zoomLevel, target, canvas);\n  }\n\n  function renderItemBody() {\n    switch (annotationBodyFormat) {\n      case \"text/plain\":\n        return (\n          <AnnotationItemPlainText\n            value={annotationBodyValue}\n            handleClick={handleClick}\n          />\n        );\n      case \"text/html\":\n        return (\n          <AnnotationItemHTML\n            value={annotationBodyValue}\n            handleClick={handleClick}\n          />\n        );\n      case \"text/vtt\":\n        return (\n          <AnnotationItemVTT\n            label={annotationBody[0].label}\n            vttUri={annotationBody[0].id || \"\"}\n          />\n        );\n      case annotationBodyFormat.match(/^image\\//)?.input:\n        const imageUri =\n          annotationBody.find((body) => !body.id?.includes(\"vault://\"))?.id ||\n          \"\";\n        return (\n          <AnnotationItemImage\n            caption={annotationBodyValue}\n            handleClick={handleClick}\n            imageUri={imageUri}\n          />\n        );\n      default:\n        return (\n          <AnnotationItemPlainText\n            value={annotationBodyValue}\n            handleClick={handleClick}\n          />\n        );\n    }\n  }\n\n  return <ItemStyled>{renderItemBody()}</ItemStyled>;\n};\n\nexport default AnnotationItem;\n","import {\n  AnnotationNormalized,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\n\nimport AnnotationItem from \"src/components/Viewer/InformationPanel/Annotation/Item\";\nimport { Group } from \"src/components/Viewer/InformationPanel/Annotation/Item.styled\";\nimport React from \"react\";\n\ntype Props = {\n  annotationPage: AnnotationPageNormalized;\n};\nexport const AnnotationPage: React.FC<Props> = ({ annotationPage }) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { vault } = viewerState;\n\n  if (\n    !annotationPage ||\n    !annotationPage.items ||\n    annotationPage.items?.length === 0\n  )\n    return <></>;\n\n  const annotations = annotationPage.items.map((item) => {\n    return vault.get(item.id) as AnnotationNormalized;\n  });\n\n  if (!annotations) return <></>;\n\n  return (\n    <Group data-testid=\"annotation-page\">\n      {annotations?.map((annotation) => (\n        <AnnotationItem key={annotation.id} annotation={annotation} />\n      ))}\n    </Group>\n  );\n};\n\nexport default AnnotationPage;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst ButtonStyled = styled(\"button\", {\n  textAlign: \"left\",\n\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n});\n\nconst Item = styled(\"li\", {\n  margin: \"0.25rem 0\",\n});\n\nconst List = styled(\"ol\", {\n  listStyleType: \"auto\",\n  marginBottom: \"1rem\",\n  listStylePosition: \"inside\",\n});\n\nconst Container = styled(\"div\", {\n  margin: \"0.5rem 1.618rem\",\n});\n\nconst ResultsHeader = styled(\"div\", {\n  fontWeight: \"bold\",\n});\n\nconst ResultsFooter = styled(\"div\", {\n  marginBottom: \"1rem\",\n});\n\nexport { Item, List, ButtonStyled, Container, ResultsHeader, ResultsFooter };\n","import { ButtonStyled } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemPlainTextProps = {\n  value: string;\n  handleClick: (e) => void;\n  target: string;\n  canvas: string;\n};\n\nconst AnnotationItemPlainText: React.FC<AnnotationItemPlainTextProps> = ({\n  value,\n  handleClick,\n  target,\n  canvas,\n}) => {\n  return (\n    <ButtonStyled\n      onClick={handleClick}\n      data-target={target}\n      data-canvas={canvas}\n    >\n      {value}\n    </ButtonStyled>\n  );\n};\n\nexport default AnnotationItemPlainText;\n","import React, { useEffect } from \"react\";\nimport { Item as ItemStyled } from \"./Item.styled\";\n\nimport {\n  ViewerContextStore,\n  useViewerState,\n  useViewerDispatch,\n} from \"src/context/viewer-context\";\nimport {\n  type CanvasNormalized,\n  AnnotationNormalized,\n  EmbeddedResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\nimport { panToTarget } from \"src/lib/openseadragon-helpers\";\n\nimport AnnotationItemPlainText from \"./PlainText\";\n\ntype Props = {\n  annotation: AnnotationNormalized;\n  activeContentSearchTarget?: string;\n  setActiveContentSearchTarget: React.Dispatch<\n    React.SetStateAction<string | undefined>\n  >;\n};\n\nexport const ContentSearchItem: React.FC<Props> = ({\n  annotation,\n  activeContentSearchTarget,\n  setActiveContentSearchTarget,\n}) => {\n  const dispatch: any = useViewerDispatch();\n  const viewerState: ViewerContextStore = useViewerState();\n  const {\n    openSeadragonViewer,\n    vault,\n    contentSearchVault,\n    activeCanvas,\n    configOptions,\n    OSDImageLoaded,\n  } = viewerState;\n\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  const annotationBody: Array<\n    EmbeddedResource & {\n      label?: InternationalString;\n    }\n  > = annotation.body.map((body) => contentSearchVault.get(body.id));\n\n  const annotationBodyValue =\n    annotationBody.find((body) => body.value)?.value || \"\";\n\n  let annotationTarget;\n  if (annotation.target) {\n    if (typeof annotation.target === \"string\") {\n      annotationTarget = annotation.target;\n    }\n  }\n\n  let annotationCanvas;\n  if (annotationTarget) {\n    const parts = annotationTarget.split(\"#xywh\");\n    if (parts.length > 1) {\n      annotationCanvas = parts[0];\n    }\n  }\n\n  const zoomLevel = configOptions.contentSearch?.overlays?.zoomLevel || 1;\n\n  // zoom to activeTarget when openSeadragonViewer changes\n  useEffect(() => {\n    if (!OSDImageLoaded) return;\n    if (!openSeadragonViewer) return;\n    if (!annotation.target) return;\n    if (annotation.target != activeContentSearchTarget) return;\n\n    panToTarget(openSeadragonViewer, zoomLevel, annotationTarget, canvas);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [openSeadragonViewer, OSDImageLoaded]);\n\n  function handleClick(e) {\n    if (!openSeadragonViewer) return;\n\n    const target = JSON.parse(e.target.dataset.target);\n    const canvasId = e.target.dataset.canvas;\n\n    // if activeCanvas does not change, then zoom to target\n    if (activeCanvas === canvasId) {\n      panToTarget(openSeadragonViewer, zoomLevel, annotationTarget, canvas);\n\n      // else change canvas and then zoom to target\n    } else {\n      dispatch({\n        type: \"updateOSDImageLoaded\",\n        OSDImageLoaded: false,\n      });\n      dispatch({\n        type: \"updateActiveCanvas\",\n        canvasId: canvasId,\n      });\n      setActiveContentSearchTarget(target);\n    }\n  }\n\n  const targetJson = JSON.stringify(annotationTarget);\n\n  return (\n    <ItemStyled>\n      <AnnotationItemPlainText\n        target={targetJson}\n        canvas={annotationCanvas}\n        value={annotationBodyValue}\n        handleClick={handleClick}\n      />\n    </ItemStyled>\n  );\n};\n\nexport default ContentSearchItem;\n","import React, { useState } from \"react\";\nimport {\n  AnnotationNormalized,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\nimport ContentSearchItem from \"./Item\";\nimport { List, ResultsHeader, ResultsFooter } from \"./Item.styled\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\nimport { getLabel } from \"src/hooks/use-iiif\";\n\nlet zoomedTo = false;\n\ntype Props = {\n  annotationPage: AnnotationPageNormalized;\n};\ntype GroupedAnnotations = {\n  [k: string]: AnnotationNormalized[];\n};\nexport const ContentSearchPage: React.FC<Props> = ({ annotationPage }) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { contentSearchVault, configOptions } = viewerState;\n  const [activeContentSearchTarget, setActiveContentSearchTarget] = useState<\n    string | undefined\n  >();\n\n  const searchResultsLimit = configOptions.contentSearch?.searchResultsLimit;\n  const zoomToFirst = configOptions.contentSearch?.zoomToFirst ? true : false;\n\n  const searchText = configOptions.localeText?.contentSearch;\n  function formatAnnotationPage(annotationPage: AnnotationPageNormalized) {\n    const groupedAnnotations: GroupedAnnotations = {};\n    annotationPage.items.forEach((item) => {\n      const annotation = contentSearchVault.get(\n        item.id,\n      ) as AnnotationNormalized;\n      let label = \"\";\n      if (annotation.label) {\n        const internationalLabel = getLabel(annotation.label);\n        if (internationalLabel) {\n          label = internationalLabel[0];\n        }\n      }\n\n      if (groupedAnnotations[label] == undefined) {\n        groupedAnnotations[label] = [];\n      }\n      groupedAnnotations[label].push(annotation);\n\n      if (!zoomedTo && zoomToFirst) {\n        if (typeof annotation.target === \"string\") {\n          setActiveContentSearchTarget(annotation.target);\n          zoomedTo = true;\n        }\n      }\n    });\n    return groupedAnnotations;\n  }\n\n  function renderSearchResults(\n    annotations: AnnotationNormalized[],\n  ): React.JSX.Element[] {\n    const annotationsShown = searchResultsLimit\n      ? annotations.slice(0, searchResultsLimit)\n      : annotations;\n\n    return annotationsShown.map((annotation, i) => (\n      <ContentSearchItem\n        key={i}\n        annotation={annotation}\n        activeContentSearchTarget={activeContentSearchTarget}\n        setActiveContentSearchTarget={setActiveContentSearchTarget}\n      />\n    ));\n  }\n\n  function renderMoreResultsMessage(annotations: AnnotationNormalized[]) {\n    if (searchResultsLimit) {\n      const moreCount = annotations.length - searchResultsLimit;\n      if (moreCount > 0) {\n        return (\n          <ResultsFooter>\n            {moreCount} {searchText?.moreResults}\n          </ResultsFooter>\n        );\n      }\n    }\n  }\n\n  if (\n    !annotationPage ||\n    !annotationPage.items ||\n    annotationPage.items?.length === 0\n  )\n    return <p>{searchText?.noSearchResults}</p>;\n\n  return (\n    <>\n      {Object.entries(formatAnnotationPage(annotationPage)).map(\n        ([label, annotations], i) => {\n          return (\n            <div key={i}>\n              <ResultsHeader className=\"content-search-results-title\">\n                {label}\n              </ResultsHeader>\n              <List className=\"content-search-results\">\n                {renderSearchResults(annotations)}\n              </List>\n              {renderMoreResultsMessage(annotations)}\n            </div>\n          );\n        },\n      )}\n    </>\n  );\n};\n\nexport default ContentSearchPage;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst FormStyled = styled(\"div\", {\n  \".content-search-form\": { display: \"flex\", marginBottom: \"1rem\" },\n\n  input: {\n    padding: \".25rem\",\n    marginRight: \"1rem\",\n  },\n});\n\nconst ButtonStyled = styled(\"button\", {\n  display: \"flex\",\n  background: \"none\",\n  border: \"none\",\n  width: \"2rem\",\n  height: \"2rem\",\n  padding: \"0\",\n  margin: \"0\",\n  fontWeight: \"700\",\n  borderRadius: \"2rem\",\n  backgroundColor: \"$accent\",\n  color: \"$secondary\",\n  cursor: \"pointer\",\n  boxSizing: \"content-box\",\n  transition: \"$all\",\n\n  svg: {\n    height: \"60%\",\n    width: \"60%\",\n    padding: \"20%\",\n    fill: \"$secondary\",\n    stroke: \"$secondary\",\n    opacity: \"1\",\n    filter: \"drop-shadow(5px 5px 5px #000D)\",\n    boxSizing: \"inherit\",\n    transition: \"$all\",\n  },\n\n  \"&:disabled\": {\n    backgroundColor: \"transparent\",\n    boxShadow: \"none\",\n    svg: { opacity: \"0.25\" },\n  },\n});\n\nexport { FormStyled, ButtonStyled };\n","import React, { useState, useEffect } from \"react\";\nimport * as Form from \"@radix-ui/react-form\";\nimport { AnnotationPageNormalized } from \"@iiif/presentation-3\";\nimport { getContentSearchResources } from \"src/hooks/use-iiif\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\nimport { AnnotationResource } from \"src/types/annotations\";\nimport { FormStyled, ButtonStyled } from \"./ContentSearchForm.styled\";\n\ntype Props = {\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationResource | undefined>\n  >;\n  activeCanvas: string;\n  setLoading: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nconst SearchContent: React.FC<Props> = ({\n  searchServiceUrl,\n  setContentSearchResource,\n  setLoading,\n}) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { contentSearchVault, openSeadragonViewer, configOptions } =\n    viewerState;\n  const searchText = configOptions.localeText?.contentSearch;\n\n  const initialSearch = configOptions.initialSearch;\n\n  const [searchTerms, setSearchTerms] = useState<string | undefined>(\n    initialSearch,\n  );\n\n  async function searchSubmitHandler(e) {\n    if (e) {\n      e.preventDefault();\n    }\n    const tabLabel = searchText?.tabLabel as string;\n\n    if (!openSeadragonViewer) return;\n    if (!searchServiceUrl) return;\n    if (!searchTerms || searchTerms.trim() === \"\") {\n      // must return a label because Information Panel tab requires a label\n      setContentSearchResource({\n        label: { none: [tabLabel] },\n      } as unknown as AnnotationPageNormalized);\n      return;\n    }\n\n    setLoading(true);\n\n    getContentSearchResources(contentSearchVault, searchServiceUrl, tabLabel, {\n      q: searchTerms,\n    }).then((resources) => {\n      setContentSearchResource(resources);\n      setLoading(false);\n    });\n  }\n\n  const handleChange = (e: any) => {\n    e.preventDefault();\n    setSearchTerms(e.target.value);\n  };\n\n  // Force load of initial search, if configured, on viewer load\n  useEffect(() => {\n    if (initialSearch) {\n      setSearchTerms(initialSearch);\n      searchSubmitHandler(null);\n    }\n  }, [openSeadragonViewer]);\n\n  return (\n    <FormStyled>\n      <Form.Root onSubmit={searchSubmitHandler} className=\"content-search-form\">\n        <Form.Field\n          className=\"FormField\"\n          name=\"searchTerms\"\n          onChange={handleChange}\n        >\n          <Form.Control placeholder={searchText?.formPlaceholder} />\n        </Form.Field>\n\n        <Form.Submit asChild>\n          <ButtonStyled type=\"submit\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n              <title>Search</title>\n              <path d=\"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z\" />\n            </svg>\n          </ButtonStyled>\n        </Form.Submit>\n      </Form.Root>\n    </FormStyled>\n  );\n};\n\nexport default SearchContent;\n","import React, { useState } from \"react\";\nimport ContentSearchAnnotationPage from \"src/components/Viewer/InformationPanel/ContentSearch/Page\";\nimport { AnnotationPageNormalized } from \"@iiif/presentation-3\";\nimport ContentSearchForm from \"src/components/Viewer/InformationPanel/ContentSearch/ContentSearchForm\";\nimport { AnnotationResource } from \"src/types/annotations\";\nimport { Container } from \"./Item.styled\";\n\ntype ContentSearchProps = {\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationPageNormalized | undefined>\n  >;\n  activeCanvas: string;\n  annotationPage: AnnotationResource;\n};\n\nconst ContentSearch: React.FC<ContentSearchProps> = ({\n  searchServiceUrl,\n  setContentSearchResource,\n  activeCanvas,\n  annotationPage,\n}) => {\n  const [loading, setLoading] = useState(false);\n\n  return (\n    <Container>\n      <ContentSearchForm\n        searchServiceUrl={searchServiceUrl}\n        setContentSearchResource={setContentSearchResource}\n        activeCanvas={activeCanvas}\n        setLoading={setLoading}\n      />\n      {!loading && (\n        <ContentSearchAnnotationPage annotationPage={annotationPage} />\n      )}\n      {loading && <span>Loading...</span>}\n    </Container>\n  );\n};\n\nexport default ContentSearch;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst AboutContent = styled(\"div\", {\n  padding: \" 0 1.618rem 2rem\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  overflow: \"scroll\",\n  position: \"absolute\",\n  fontWeight: \"400\",\n  fontSize: \"1rem\",\n  zIndex: \"0\",\n\n  img: {\n    maxWidth: \"100px\",\n    maxHeight: \"100px\",\n    objectFit: \"contain\",\n    color: \"transparent\",\n    margin: \"0 0 1rem\",\n    borderRadius: \"3px\",\n    backgroundColor: \"$secondaryMuted\",\n  },\n\n  video: {\n    display: \"none\",\n  },\n\n  \"a, a:visited\": {\n    color: \"$accent\",\n  },\n\n  p: {\n    fontSize: \"1rem\",\n    lineHeight: \"1.45em\",\n    margin: \"0\",\n  },\n\n  dl: {\n    margin: \"0\",\n\n    dt: {\n      fontWeight: \"700\",\n      margin: \"1rem 0 0.25rem\",\n    },\n\n    dd: {\n      margin: \"0\",\n    },\n  },\n\n  \".manifest-property-title\": {\n    fontWeight: \"700\",\n    margin: \"1rem 0 0.25rem\",\n  },\n\n  \"ul, ol\": {\n    padding: \"0\",\n    margin: \"0\",\n\n    li: {\n      fontSize: \"1rem\",\n      lineHeight: \"1.45em\",\n      listStyle: \"none\",\n      margin: \"0.25rem 0 0.25rem\",\n    },\n  },\n});\n\nconst AboutStyled = styled(\"div\", {\n  position: \"relative\",\n  width: \"100%\",\n  height: \"100%\",\n  zIndex: \"0\",\n});\n\nexport { AboutContent, AboutStyled };\n","import { InternationalString } from \"@iiif/presentation-3\";\n\nexport const getLabelEntries = (\n  label?: InternationalString,\n  lang: string = \"none\",\n) => {\n  /*\n   * If no label exists, return an empty string.\n   */\n  if (!label) return null;\n\n  /*\n   * If label is not a IIIF Presentation API 3.0 shape, return the string\n   */\n  if (typeof label === \"string\") return [label];\n\n  /*\n   * If InternationalString code does not exist on label, then\n   * return what may be there, ex: label.none[0] OR label.fr[0]\n   */\n  if (!label[lang]) {\n    const codes: Array<string> = Object.getOwnPropertyNames(label);\n    if (codes.length > 0) return label[codes[0]];\n  }\n\n  /*\n   * Return label value for InternationalString code `en`\n   */\n  if (!label[lang]) return null;\n  if (!Array.isArray(label[lang])) return null;\n\n  return label[lang] as string[];\n};\n\nexport const getLabelAsString = (\n  label: InternationalString | undefined,\n  lang: string = \"none\",\n  delimiter: string = \", \",\n) => {\n  const entries = getLabelEntries(label, lang);\n  return Array.isArray(entries) ? entries.join(`${delimiter}`) : entries;\n};\n","import sanitizeHtml from \"sanitize-html\";\n\nfunction createMarkup(html: string) {\n  return { __html: sanitizeHTML(html) };\n}\n\nfunction sanitizeAttributes(props: any, remove: string[]) {\n  const entries = Object.keys(props).filter((key) =>\n    !remove.includes(key) ? key : null,\n  );\n\n  const attributes = new Object();\n  entries.forEach((key) => {\n    attributes[key] = props[key];\n  });\n\n  return attributes as React.HTMLAttributes<HTMLElement>;\n}\n\nfunction sanitizeHTML(html: string) {\n  return sanitizeHtml(html, {\n    allowedAttributes: {\n      a: [\"href\"],\n      img: [\"alt\", \"src\", \"height\", \"width\"],\n    },\n    allowedSchemes: [\"http\", \"https\", \"mailto\"],\n    allowedTags: [\n      \"a\",\n      \"b\",\n      \"br\",\n      \"i\",\n      \"img\",\n      \"p\",\n      \"small\",\n      \"span\",\n      \"sub\",\n      \"sup\",\n    ],\n  });\n}\n\nexport { createMarkup, sanitizeAttributes, sanitizeHTML };\n","import { PrimitivesLabel } from \"src/types/primitives\";\nimport React from \"react\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledLabel = styled(\"span\", {});\n\nconst Label: React.FC<PrimitivesLabel> = (props) => {\n  const { as, label } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"label\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <StyledLabel as={as} {...attributes}>\n      {getLabelAsString(label, attributes.lang as string) as string}\n    </StyledLabel>\n  );\n};\n\nexport default Label;\n","import { IIIFExternalWebResource, ImageService } from \"@iiif/presentation-3\";\n\nexport const useGetImageResource = (\n  resource: IIIFExternalWebResource,\n  size: string = \"200,\",\n  region: string = \"full\",\n) => {\n  /**\n   * defenseively ensure resource is not an array\n   */\n  if (Array.isArray(resource)) resource = resource[0];\n\n  const { id, service } = resource;\n\n  let imageService: ImageService | undefined;\n\n  /**\n   * return resource id if service does not exist\n   */\n  if (!service) return id;\n\n  if (Array.isArray(resource.service) && resource.service.length > 0)\n    imageService = service[0] as ImageService;\n\n  if (imageService) {\n    if (imageService[\"@id\"])\n      return `${imageService[\"@id\"]}/${region}/${size}/0/default.jpg`;\n\n    if (imageService.id)\n      return `${imageService.id}/${region}/${size}/0/default.jpg`;\n  }\n};\n","import React, { useCallback, useEffect, useRef } from \"react\";\n\nimport Hls from \"hls.js\";\nimport { PrimitivesContentResource } from \"src/types/primitives\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { useGetImageResource } from \"src/hooks/useGetImageResource\";\n\nconst StyledResource = styled(\"img\", { objectFit: \"cover\" });\n\nconst ContentResource: React.FC<PrimitivesContentResource> = (props) => {\n  const mediaRef = useRef(null);\n  const { contentResource, altAsLabel, region = \"full\" } = props;\n\n  let alt: string | undefined;\n  if (altAsLabel) alt = getLabelAsString(altAsLabel) as string;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"contentResource\", \"altAsLabel\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  const { type, id, width = 200, height = 200, duration } = contentResource;\n\n  useEffect(() => {\n    /**\n     * Check that IIIF content resource ID exists and\n     * we have a reffed <video> for attaching HLS\n     */\n    if (!id && !mediaRef.current) return;\n    if ([\"Image\"].includes(type)) return;\n\n    /**\n     * Eject HLS attachment if file extension from\n     * the IIIF content resource ID is not .m3u8\n     */\n    if (!id.includes(\"m3u8\")) return;\n\n    // Bind hls.js package to our <video /> element and then load the media source\n    const hls = new Hls();\n\n    if (mediaRef.current) {\n      hls.attachMedia(mediaRef.current);\n      hls.on(Hls.Events.MEDIA_ATTACHED, function () {\n        hls.loadSource(id as string);\n      });\n    }\n\n    // Handle errors\n    hls.on(Hls.Events.ERROR, function (event, data) {\n      if (data.fatal) {\n        switch (data.type) {\n          case Hls.ErrorTypes.NETWORK_ERROR:\n            // try to recover network error\n            console.error(\n              `fatal ${event} network error encountered, try to recover`,\n            );\n            hls.startLoad();\n            break;\n          case Hls.ErrorTypes.MEDIA_ERROR:\n            console.error(\n              `fatal ${event} media error encountered, try to recover`,\n            );\n            hls.recoverMediaError();\n            break;\n          default:\n            // cannot recover\n            hls.destroy();\n            break;\n        }\n      }\n    });\n\n    return () => {\n      if (hls) {\n        hls.detachMedia();\n        hls.destroy();\n      }\n    };\n  }, [id, type]);\n\n  const playLoop = useCallback(() => {\n    if (!mediaRef.current) return;\n\n    let startTime = 0;\n    let loopTime = 30;\n\n    if (duration) loopTime = duration;\n    if (!id.split(\"#t=\") && duration) startTime = duration * 0.1;\n\n    if (id.split(\"#t=\").pop()) {\n      const fragment = id.split(\"#t=\").pop();\n      if (fragment) startTime = parseInt(fragment.split(\",\")[0]);\n    }\n\n    const media: HTMLVideoElement = mediaRef.current;\n    media.autoplay = true;\n    media.currentTime = startTime;\n\n    setTimeout(() => playLoop(), loopTime * 1000);\n  }, [duration, id]);\n\n  useEffect(() => playLoop(), [playLoop]);\n\n  const imgSrc = useGetImageResource(\n    contentResource,\n    `${width},${height}`,\n    region,\n  );\n\n  switch (type) {\n    case \"Image\":\n      return (\n        <StyledResource\n          as=\"img\"\n          alt={alt}\n          css={{ width: width, height: height }}\n          key={id}\n          src={imgSrc}\n          {...attributes}\n        />\n      );\n\n    case \"Video\":\n      return (\n        <StyledResource\n          as=\"video\"\n          css={{ width: width, height: height }}\n          disablePictureInPicture\n          key={id}\n          loop\n          muted\n          onPause={playLoop}\n          ref={mediaRef}\n          src={id}\n        />\n      );\n\n    default:\n      console.warn(\n        `Resource type: ${type} is not valid or not yet supported in Primitives.`,\n      );\n      return <></>;\n  }\n};\n\nexport default ContentResource;\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { PrimitivesHomepage } from \"src/types/primitives\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst StyledHomepage = styled(\"a\", {});\n\nconst Homepage: React.FC<PrimitivesHomepage> = (props) => {\n  const { children, homepage } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"children\", \"homepage\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <>\n      {homepage &&\n        homepage.map((resource) => {\n          const label = getLabelAsString(\n            resource.label,\n            attributes.lang,\n          ) as string;\n          return (\n            <StyledHomepage\n              aria-label={children ? label : undefined}\n              href={resource.id}\n              key={resource.id}\n              {...attributes}\n            >\n              {children ? children : label}\n            </StyledHomepage>\n          );\n        })}\n    </>\n  );\n};\n\nexport default Homepage;\n","import { createContext, useContext } from \"react\";\n\nimport React from \"react\";\n\ntype PrimitivesContextStore =\n  | {\n      delimiter: string; // Separator for multi-value items\n    }\n  | undefined;\ninterface ProviderProps {\n  children: React.ReactNode;\n  initialState?: PrimitivesContextStore;\n}\n\nconst defaultState = {\n  delimiter: \", \",\n};\n\nconst PrimitivesContext = createContext<PrimitivesContextStore>(undefined);\n\nconst usePrimitivesContext = () => {\n  const context = useContext(PrimitivesContext);\n  if (context === undefined) {\n    throw new Error(\n      \"usePrimitivesContext must be used with a PrimitivesProvider\",\n    );\n  }\n  return context;\n};\n\nconst PrimitivesProvider: React.FC<ProviderProps> = ({\n  children,\n  initialState = defaultState,\n}) => {\n  const delimiter = getRealPropertyValue(initialState, \"delimiter\");\n\n  return (\n    <PrimitivesContext.Provider value={{ delimiter }}>\n      {children}\n    </PrimitivesContext.Provider>\n  );\n};\n\nconst getRealPropertyValue = (\n  obj: { [key: string]: any },\n  property: string,\n) => {\n  const value = Object.hasOwn(obj, property)\n    ? obj[property].toString()\n    : undefined;\n  return value;\n};\n\nexport {\n  PrimitivesContext,\n  PrimitivesProvider,\n  getRealPropertyValue,\n  usePrimitivesContext,\n};\n","import {\n  PrimitivesContext,\n  PrimitivesProvider,\n  usePrimitivesContext,\n} from \"src/context/primitives-context\";\nimport { createMarkup, sanitizeAttributes } from \"src/lib/html-element\";\n\nimport { PrimitivesMarkup } from \"src/types/primitives\";\nimport React from \"react\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledMarkup = styled(\"span\", {});\n\nconst Markup: React.FC<PrimitivesMarkup> = (props) => {\n  const { as, markup } = props;\n  const { delimiter } = usePrimitivesContext();\n\n  if (!markup) return <></>;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"markup\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  const html = createMarkup(\n    getLabelAsString(markup, attributes.lang as string, delimiter) as string,\n  );\n\n  return (\n    <StyledMarkup as={as} {...attributes} dangerouslySetInnerHTML={html} />\n  );\n};\n\nconst MarkupWrapper: React.FC<PrimitivesMarkup> = (props) => {\n  const context = React.useContext(PrimitivesContext);\n\n  return context ? (\n    <Markup {...props} />\n  ) : (\n    <PrimitivesProvider>\n      <Markup {...props} />\n    </PrimitivesProvider>\n  );\n};\n\nexport default MarkupWrapper;\n","import React from \"react\";\nimport { PrimitivesValue } from \"src/types/primitives\";\nimport Markup from \"src/components/Primitives/Markup/Markup\";\n\nconst Value: React.FC<PrimitivesValue> = ({ as = \"dd\", lang, value }) => (\n  <Markup markup={value} as={as} lang={lang} />\n);\n\nexport default Value;\n","import React, { Fragment, cloneElement } from \"react\";\n\nimport { PrimitivesCustomValue } from \"src/types/primitives\";\nimport { getLabelEntries } from \"src/lib/label-helpers\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { usePrimitivesContext } from \"src/context/primitives-context\";\n\nconst StyledCustomValue = styled(\"span\", {});\n\nconst CustomValue: React.FC<PrimitivesCustomValue> = ({\n  as = \"dd\",\n  customValueContent,\n  lang,\n  value,\n}) => {\n  const { delimiter } = usePrimitivesContext();\n\n  const entries = getLabelEntries(value, lang)?.map((entry) => {\n    return cloneElement(customValueContent, {\n      value: entry,\n    });\n  });\n\n  return (\n    <StyledCustomValue as={as} lang={lang}>\n      {entries?.map((entry, index) => [\n        index > 0 && `${delimiter}`,\n        <Fragment key={index}>{entry}</Fragment>,\n      ])}\n    </StyledCustomValue>\n  );\n};\n\nexport default CustomValue;\n","import React from \"react\";\nimport Label from \"../Label/Label\";\nimport Value from \"../Value/Value\";\nimport { PrimitivesMetadataItem } from \"src/types/primitives\";\nimport CustomValue from \"../Value/CustomValue\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\n\nconst MetadataItem: React.FC<PrimitivesMetadataItem> = (props) => {\n  const { item, lang, customValueContent } = props;\n  const { label, value } = item;\n\n  /**\n   * Create value for data-label attribute for use as a selector\n   */\n  const dataAttribute = getLabelAsString(label)\n    ?.replace(\" \", \"-\")\n    .toLowerCase();\n\n  return (\n    <div role=\"group\" data-label={dataAttribute}>\n      <Label as=\"dt\" label={label} lang={lang} />\n      {customValueContent ? (\n        <CustomValue\n          as=\"dd\"\n          customValueContent={customValueContent}\n          value={value}\n          lang={lang}\n        />\n      ) : (\n        <Value as=\"dd\" value={value} lang={lang} />\n      )}\n    </div>\n  );\n};\n\nexport default MetadataItem;\n","import { InternationalString } from \"@iiif/presentation-3\";\nimport { PrimitivesCustomValueContent } from \"../types/primitives\";\nimport { getLabelAsString } from \"./label-helpers\";\n\nexport function parseCustomContent(\n  label: InternationalString,\n  valueArray: PrimitivesCustomValueContent[],\n) {\n  const customContent = valueArray\n    .filter((entry) => {\n      const { matchingLabel } = entry;\n      const lang = Object.keys(entry.matchingLabel)[0];\n      const labelPattern = getLabelAsString(matchingLabel, lang);\n\n      if (getLabelAsString(label, lang) === labelPattern) return true;\n    })\n    .map((entry) => entry.Content);\n\n  if (!Array.isArray(customContent)) return;\n\n  return customContent[0];\n}\n","import MetadataItem from \"src/components/Primitives/Metadata/Item\";\nimport { PrimitivesMetadata } from \"src/types/primitives\";\nimport { PrimitivesProvider } from \"src/context/primitives-context\";\nimport React from \"react\";\nimport { getRealPropertyValue } from \"src/lib/utils\";\nimport { parseCustomContent } from \"src/lib/custom\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledMetadata = styled(\"dl\", {});\n\nconst Metadata: React.FC<PrimitivesMetadata> = (props) => {\n  const { as, customValueContent, metadata } = props;\n\n  if (!Array.isArray(metadata)) return <></>;\n\n  const delimiter = getRealPropertyValue(props, \"customValueDelimiter\");\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\n    \"as\",\n    \"customValueContent\",\n    \"customValueDelimiter\",\n    \"metadata\",\n  ];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <PrimitivesProvider\n      {...(typeof delimiter === \"string\"\n        ? { initialState: { delimiter: delimiter as string } }\n        : undefined)}\n    >\n      {metadata.length > 0 && (\n        <StyledMetadata as={as} {...attributes}>\n          {metadata.map((item, index) => {\n            const customValue = customValueContent\n              ? parseCustomContent(item.label, customValueContent)\n              : undefined;\n\n            return (\n              <MetadataItem\n                customValueContent={customValue}\n                item={item}\n                key={index}\n                lang={attributes?.lang}\n              />\n            );\n          })}\n        </StyledMetadata>\n      )}\n    </PrimitivesProvider>\n  );\n};\n\nexport default Metadata;\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { PrimitivesPartOf } from \"src/types/primitives\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst StyledPartOf = styled(\"li\", {});\nconst StyledWrapper = styled(\"ul\", {});\n\nconst PartOf: React.FC<PrimitivesPartOf> = (props) => {\n  const { as, partOf } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"partOf\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <StyledWrapper as={as}>\n      {partOf &&\n        partOf.map((resource) => {\n          const label = resource.label\n            ? (getLabelAsString(resource.label, attributes.lang) as string)\n            : undefined;\n          return (\n            <StyledPartOf key={resource.id}>\n              <a href={resource.id} {...attributes}>\n                {label ? label : resource.id}\n              </a>\n            </StyledPartOf>\n          );\n        })}\n    </StyledWrapper>\n  );\n};\n\nexport default PartOf;\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { PrimitivesRendering } from \"src/types/primitives\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst StyledRendering = styled(\"li\", {});\nconst StyledWrapper = styled(\"ul\", {});\n\nconst Rendering: React.FC<PrimitivesRendering> = (props) => {\n  const { as, rendering } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"rendering\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <StyledWrapper as={as}>\n      {rendering &&\n        rendering.map((resource) => {\n          const label = getLabelAsString(\n            resource.label,\n            attributes.lang,\n          ) as string;\n          return (\n            <StyledRendering key={resource.id}>\n              <a href={resource.id} {...attributes} target=\"_blank\">\n                {label ? label : resource.id}\n              </a>\n            </StyledRendering>\n          );\n        })}\n    </StyledWrapper>\n  );\n};\n\nexport default Rendering;\n","import MetadataItem from \"src/components/Primitives/Metadata/Item\";\nimport { PrimitivesProvider } from \"src/context/primitives-context\";\nimport { PrimitivesRequiredStatement } from \"src/types/primitives\";\nimport React from \"react\";\nimport { getRealPropertyValue } from \"src/lib/utils\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledRequiredStatement = styled(\"dl\", {});\n\nconst RequiredStatement: React.FC<PrimitivesRequiredStatement> = (props) => {\n  const { as, requiredStatement } = props;\n\n  if (!requiredStatement) return <></>;\n\n  const delimiter = getRealPropertyValue(props, \"customValueDelimiter\");\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"customValueDelimiter\", \"requiredStatement\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <PrimitivesProvider\n      {...(typeof delimiter === \"string\"\n        ? { initialState: { delimiter: delimiter as string } }\n        : undefined)}\n    >\n      <StyledRequiredStatement as={as} {...attributes}>\n        <MetadataItem item={requiredStatement} lang={attributes.lang} />\n      </StyledRequiredStatement>\n    </PrimitivesProvider>\n  );\n};\n\nexport default RequiredStatement;\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { PrimitivesSeeAlso } from \"src/types/primitives\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst StyledSeeAlso = styled(\"li\", {});\nconst StyledWrapper = styled(\"ul\", {});\n\nconst SeeAlso: React.FC<PrimitivesSeeAlso> = (props) => {\n  const { as, seeAlso } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"seeAlso\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <StyledWrapper as={as}>\n      {seeAlso &&\n        seeAlso.map((resource) => {\n          const label = getLabelAsString(\n            resource.label,\n            attributes.lang,\n          ) as string;\n          return (\n            <StyledSeeAlso key={resource.id}>\n              <a href={resource.id} {...attributes}>\n                {label ? label : resource.id}\n              </a>\n            </StyledSeeAlso>\n          );\n        })}\n    </StyledWrapper>\n  );\n};\n\nexport default SeeAlso;\n","import Markup from \"src/components/Primitives/Markup/Markup\";\nimport { PrimitivesSummary } from \"src/types/primitives\";\nimport React from \"react\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst Summary: React.FC<PrimitivesSummary> = (props) => {\n  const { as, summary } = props;\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"customValueDelimiter\", \"summary\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return <Markup as={as} markup={summary} {...attributes} />;\n};\n\nexport default Summary;\n","import {\n  PrimitivesExternalWebResource,\n  PrimitivesThumbnail,\n} from \"src/types/primitives\";\n\nimport ContentResource from \"src/components/Primitives/ContentResource/ContentResource\";\nimport React from \"react\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst Thumbnail: React.FC<PrimitivesThumbnail> = (props) => {\n  const { thumbnail, region } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"thumbnail\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <>\n      {thumbnail &&\n        thumbnail.map((contentResource) => (\n          <ContentResource\n            contentResource={contentResource as PrimitivesExternalWebResource}\n            key={contentResource.id}\n            region={region}\n            {...attributes}\n          />\n        ))}\n    </>\n  );\n};\n\nexport default Thumbnail;\n","import { Homepage } from \"src/components/Primitives\";\nimport { PrimitivesExternalWebResource } from \"src/types/primitives\";\nimport React from \"react\";\n\ninterface PropertiesHomepageProps {\n  homepage: PrimitivesExternalWebResource[];\n}\n\nconst PropertiesHomepage: React.FC<PropertiesHomepageProps> = ({\n  homepage,\n}) => {\n  if (homepage?.length === 0) return <></>;\n\n  return (\n    <>\n      <span className=\"manifest-property-title\">Homepage</span>\n      <Homepage homepage={homepage} />\n    </>\n  );\n};\n\nexport default PropertiesHomepage;\n","import React from \"react\";\n\ninterface PropertiesIdProps {\n  id: string;\n  htmlLabel: string;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesId: React.FC<PropertiesIdProps> = ({\n  id,\n  htmlLabel,\n  parent = \"manifest\",\n}) => {\n  return (\n    <>\n      <span className=\"manifest-property-title\">{htmlLabel}</span>\n      <a href={id} target=\"_blank\" id={`iiif-${parent}-id`}>\n        {id}\n      </a>\n    </>\n  );\n};\n\nexport default PropertiesId;\n","import { MetadataItem } from \"@iiif/presentation-3\";\nimport React from \"react\";\nimport { Metadata } from \"src/components/Primitives\";\n\ninterface PropertiesMetadataProps {\n  metadata: MetadataItem[] | null;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesMetadata: React.FC<PropertiesMetadataProps> = ({\n  metadata,\n  parent = \"manifest\",\n}) => {\n  if (!metadata) return <></>;\n\n  return (\n    <>\n      <Metadata metadata={metadata} id={`iiif-${parent}-metadata`} />\n    </>\n  );\n};\n\nexport default PropertiesMetadata;\n","import { PrimitivesExternalWebResource } from \"src/types/primitives\";\nimport { Rendering } from \"src/components/Primitives\";\nimport React from \"react\";\n\ninterface PropertiesRenderingProps {\n  rendering: PrimitivesExternalWebResource[];\n}\n\nconst PropertiesRendering: React.FC<PropertiesRenderingProps> = ({\n  rendering,\n}) => {\n  if (rendering?.length === 0) return <></>;\n\n  return (\n    <>\n      <span className=\"manifest-property-title\">Alternate formats</span>\n      <Rendering rendering={rendering} />\n    </>\n  );\n};\n\nexport default PropertiesRendering;\n","import { MetadataItem } from \"@iiif/presentation-3\";\nimport React from \"react\";\nimport { RequiredStatement } from \"src/components/Primitives\";\n\ninterface PropertiesSummaryProps {\n  requiredStatement: MetadataItem | null;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesRequiredStatement: React.FC<PropertiesSummaryProps> = ({\n  requiredStatement,\n  parent = \"manifest\",\n}) => {\n  if (!requiredStatement) return <></>;\n\n  return (\n    <>\n      <RequiredStatement\n        requiredStatement={requiredStatement}\n        id={`iiif-${parent}-required-statement`}\n      />\n    </>\n  );\n};\n\nexport default PropertiesRequiredStatement;\n","import React from \"react\";\n\ninterface PropertiesRightsProps {\n  rights: string | null;\n}\n\nconst PropertiesRights: React.FC<PropertiesRightsProps> = ({ rights }) => {\n  if (!rights) return <></>;\n\n  return (\n    <>\n      <span className=\"manifest-property-title\">Rights</span>\n      <a href={rights} target=\"_blank\">\n        {rights}\n      </a>\n    </>\n  );\n};\n\nexport default PropertiesRights;\n","import { PrimitivesExternalWebResource } from \"src/types/primitives\";\nimport { SeeAlso } from \"src/components/Primitives\";\nimport React from \"react\";\n\ninterface PropertiesSeeAlsoProps {\n  seeAlso: PrimitivesExternalWebResource[];\n}\n\nconst PropertiesSeeAlso: React.FC<PropertiesSeeAlsoProps> = ({ seeAlso }) => {\n  if (seeAlso?.length === 0) return <></>;\n\n  return (\n    <>\n      <span className=\"manifest-property-title\">See Also</span>\n      <SeeAlso seeAlso={seeAlso} />\n    </>\n  );\n};\n\nexport default PropertiesSeeAlso;\n","import { InternationalString } from \"@iiif/presentation-3\";\nimport React from \"react\";\nimport { Summary } from \"src/components/Primitives\";\n\ninterface PropertiesSummaryProps {\n  summary: InternationalString | null;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesSummary: React.FC<PropertiesSummaryProps> = ({\n  summary,\n  parent = \"manifest\",\n}) => {\n  if (!summary) return <></>;\n\n  return (\n    <>\n      <Summary summary={summary} as=\"p\" id={`iiif-${parent}-summary`} />\n    </>\n  );\n};\n\nexport default PropertiesSummary;\n","import {\n  IIIFExternalWebResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\n\nimport React from \"react\";\nimport { Thumbnail } from \"src/components/Primitives\";\n\ninterface PropertiesThumbnailProps {\n  label: InternationalString | null;\n  thumbnail: IIIFExternalWebResource[];\n}\n\nconst PropertiesThumbnail: React.FC<PropertiesThumbnailProps> = ({\n  label,\n  thumbnail,\n}) => {\n  if (thumbnail?.length === 0) return <></>;\n\n  return (\n    <>\n      <Thumbnail\n        altAsLabel={label ? label : { none: [\"resource\"] }}\n        thumbnail={thumbnail}\n        style={{ backgroundColor: \"#6663\", objectFit: \"cover\" }}\n      />\n    </>\n  );\n};\n\nexport default PropertiesThumbnail;\n","import {\n  AboutContent,\n  AboutStyled,\n} from \"src/components/Viewer/InformationPanel/About/About.styled\";\nimport {\n  Homepage,\n  Id,\n  Metadata,\n  Rendering,\n  RequiredStatement,\n  Rights,\n  SeeAlso,\n  Summary,\n  Thumbnail,\n} from \"src/components/Viewer/Properties\";\nimport {\n  IIIFExternalWebResource,\n  ManifestNormalized,\n} from \"@iiif/presentation-3\";\nimport React, { useEffect, useState } from \"react\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\n\nimport { PrimitivesExternalWebResource } from \"src/types/primitives\";\n\nconst About: React.FC = () => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { activeManifest, vault } = viewerState;\n\n  const [manifest, setManifest] = useState<ManifestNormalized>();\n\n  const [homepage, setHomepage] = useState<IIIFExternalWebResource[]>([]);\n  const [seeAlso, setSeeAlso] = useState<IIIFExternalWebResource[]>([]);\n  const [rendering, setRendering] = useState<IIIFExternalWebResource[]>([]);\n  const [thumbnail, setThumbnail] = useState<IIIFExternalWebResource[]>([]);\n\n  useEffect(() => {\n    const data: ManifestNormalized = vault.get(activeManifest);\n    setManifest(data);\n\n    if (data.homepage?.length > 0) setHomepage(vault.get(data.homepage));\n    if (data.seeAlso?.length > 0) setSeeAlso(vault.get(data.seeAlso));\n    if (data.rendering?.length > 0) setRendering(vault.get(data.rendering));\n    if (data.thumbnail?.length > 0) setThumbnail(vault.get(data.thumbnail));\n  }, [activeManifest, vault]);\n\n  if (!manifest) return <></>;\n\n  return (\n    <AboutStyled>\n      <AboutContent>\n        <Thumbnail thumbnail={thumbnail} label={manifest.label} />\n        <Summary summary={manifest.summary} />\n        <Metadata metadata={manifest.metadata} />\n        <RequiredStatement requiredStatement={manifest.requiredStatement} />\n        <Rights rights={manifest.rights} />\n        <Homepage\n          homepage={homepage as unknown as PrimitivesExternalWebResource[]}\n        />\n        <SeeAlso\n          seeAlso={seeAlso as unknown as PrimitivesExternalWebResource[]}\n        />\n        <Rendering\n          rendering={rendering as unknown as PrimitivesExternalWebResource[]}\n        />\n        <Id id={manifest.id} htmlLabel=\"IIIF Manifest\" />\n      </AboutContent>\n    </AboutStyled>\n  );\n};\n\nexport default About;\n","import { type PluginConfig } from \"src/context/viewer-context\";\n\nexport function setupPlugins(plugins: PluginConfig[]) {\n  const pluginsWithInfoPanel: PluginConfig[] = [];\n  plugins.forEach((plugin) => {\n    if (plugin.informationPanel?.component) {\n      pluginsWithInfoPanel.push(plugin);\n    }\n  });\n\n  return { pluginsWithInfoPanel };\n}\n","import {\n  Content,\n  List,\n  Scroll,\n  Trigger,\n  Wrapper,\n} from \"src/components/Viewer/InformationPanel/InformationPanel.styled\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  ViewerContextStore,\n  useViewerDispatch,\n  useViewerState,\n  type PluginConfig,\n} from \"src/context/viewer-context\";\n\nimport AnnotationPage from \"src/components/Viewer/InformationPanel/Annotation/Page\";\nimport ContentSearch from \"src/components/Viewer/InformationPanel/ContentSearch/ContentSearch\";\nimport { AnnotationResources, AnnotationResource } from \"src/types/annotations\";\nimport Information from \"src/components/Viewer/InformationPanel/About/About\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\n\nimport {\n  InternationalString,\n  AnnotationPageNormalized,\n  CanvasNormalized,\n} from \"@iiif/presentation-3\";\nimport { Label } from \"src/components/Primitives\";\nimport { setupPlugins } from \"src/lib/plugin-helpers\";\n\nconst UserScrollTimeout = 1500; // 1500ms without a user-generated scroll event reverts to auto-scrolling\n\ninterface NavigatorProps {\n  activeCanvas: string;\n  annotationResources?: AnnotationResources;\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationPageNormalized | undefined>\n  >;\n  contentSearchResource?: AnnotationResource;\n}\n\nexport const InformationPanel: React.FC<NavigatorProps> = ({\n  activeCanvas,\n  annotationResources,\n  searchServiceUrl,\n  setContentSearchResource,\n  contentSearchResource,\n}) => {\n  const dispatch: any = useViewerDispatch();\n  const viewerState: ViewerContextStore = useViewerState();\n  const {\n    isAutoScrolling,\n    configOptions: { informationPanel },\n    configOptions,\n    isUserScrolling,\n    vault,\n    plugins,\n    activeManifest,\n    openSeadragonViewer,\n    informationPanelCounts,\n  } = viewerState;\n\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n  const [activeResource, setActiveResource] = useState<string>();\n\n  const renderAbout = informationPanel?.renderAbout;\n  const renderAnnotation = informationPanel?.renderAnnotation;\n  const renderContentSearch = informationPanel?.renderContentSearch;\n\n  const { pluginsWithInfoPanel } = setupPlugins(plugins);\n\n  function renderPluginInformationPanel(plugin: PluginConfig, i: number) {\n    const PluginInformationPanelComponent = plugin?.informationPanel\n      ?.component as unknown as React.ElementType;\n\n    if (PluginInformationPanelComponent === undefined) {\n      return <></>;\n    }\n\n    return (\n      <Content key={i} value={plugin.id}>\n        <PluginInformationPanelComponent\n          {...plugin?.informationPanel?.componentProps}\n          activeManifest={activeManifest}\n          canvas={canvas}\n          viewerConfigOptions={configOptions}\n          openSeadragonViewer={openSeadragonViewer}\n          useViewerDispatch={useViewerDispatch}\n          useViewerState={useViewerState}\n        />\n      </Content>\n    );\n  }\n\n  useEffect(() => {\n    if (activeResource) {\n      return;\n    } else if (informationPanel?.defaultTab) {\n      const validActiveResource = [\"manifest-about\", \"manifest-content-search\"];\n      if (canvas.annotations.length > 0) {\n        canvas.annotations.forEach((annotation) =>\n          validActiveResource.push(annotation.id),\n        );\n      }\n      if (validActiveResource.includes(informationPanel?.defaultTab)) {\n        setActiveResource(informationPanel.defaultTab);\n        // handle cases when user sets defaultTab to an invalid value\n      } else {\n        setActiveResource(\"manifest-about\");\n      }\n    } else if (renderAbout) {\n      setActiveResource(\"manifest-about\");\n    } else if (renderContentSearch) {\n      setActiveResource(\"manifest-content-search\");\n    } else if (annotationResources && annotationResources?.length > 0) {\n      setActiveResource(annotationResources[0].id);\n    }\n  }, [\n    informationPanel?.defaultTab,\n    activeCanvas,\n    activeResource,\n    renderAbout,\n    renderContentSearch,\n    annotationResources,\n    contentSearchResource,\n    canvas?.annotations,\n    plugins,\n  ]);\n\n  function handleScroll() {\n    if (!isAutoScrolling) {\n      clearTimeout(isUserScrolling);\n      const timeout = setTimeout(() => {\n        dispatch({\n          type: \"updateUserScrolling\",\n          isUserScrolling: undefined,\n        });\n      }, UserScrollTimeout);\n\n      dispatch({\n        type: \"updateUserScrolling\",\n        isUserScrolling: timeout,\n      });\n    }\n  }\n\n  const handleValueChange = (value: string) => {\n    setActiveResource(value);\n  };\n\n  return (\n    <Wrapper\n      data-testid=\"information-panel\"\n      defaultValue={activeResource}\n      onValueChange={handleValueChange}\n      orientation=\"horizontal\"\n      value={activeResource}\n      className=\"clover-viewer-information-panel\"\n    >\n      <List aria-label=\"select chapter\" data-testid=\"information-panel-list\">\n        {renderContentSearch && contentSearchResource && (\n          <Trigger value=\"manifest-content-search\">\n            <Label label={contentSearchResource.label as InternationalString} />\n          </Trigger>\n        )}\n        {renderAnnotation &&\n          annotationResources &&\n          annotationResources.map((resource, i) => (\n            <Trigger key={i} value={resource.id}>\n              <Label label={resource.label as InternationalString} />\n            </Trigger>\n          ))}\n\n        {pluginsWithInfoPanel &&\n          pluginsWithInfoPanel.map((plugin, i) => {\n            const l = getLabelAsString(\n              plugin.informationPanel?.label as unknown as InternationalString,\n            );\n            const c = informationPanelCounts[plugin.id]\n              ? \" (\" + informationPanelCounts[plugin.id] + \")\"\n              : \"\";\n            const lbl = { none: [l + c] } as unknown as InternationalString;\n            return (\n              <Trigger key={i} value={plugin.id}>\n                <Label label={lbl} />\n              </Trigger>\n            );\n          })}\n\n        {renderAbout && <Trigger value=\"manifest-about\">About</Trigger>}\n      </List>\n      <Scroll handleScroll={handleScroll}>\n        {renderContentSearch && contentSearchResource && (\n          <Content value=\"manifest-content-search\">\n            <ContentSearch\n              searchServiceUrl={searchServiceUrl}\n              setContentSearchResource={setContentSearchResource}\n              activeCanvas={activeCanvas}\n              annotationPage={contentSearchResource}\n            />\n          </Content>\n        )}\n        {renderAnnotation &&\n          annotationResources &&\n          annotationResources.map((annotationPage) => {\n            return (\n              <Content key={annotationPage.id} value={annotationPage.id}>\n                <AnnotationPage annotationPage={annotationPage} />\n              </Content>\n            );\n          })}\n\n        {pluginsWithInfoPanel &&\n          pluginsWithInfoPanel.map((plugin, i) =>\n            renderPluginInformationPanel(plugin, i),\n          )}\n        {renderAbout && (\n          <Content value=\"manifest-about\">\n            <Information />\n          </Content>\n        )}\n      </Scroll>\n    </Wrapper>\n  );\n};\n\nexport default InformationPanel;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Form = styled(\"div\", {\n  position: \"absolute\",\n  right: \"1rem\",\n  top: \"1rem\",\n  display: \"flex\",\n  justifyContent: \"flex-end\",\n  zIndex: \"1\",\n});\n\nconst Input = styled(\"input\", {\n  flexGrow: \"1\",\n  border: \"none\",\n  backgroundColor: \"$secondaryMuted\",\n  color: \"$primary\",\n  marginRight: \"1rem\",\n  height: \"2rem\",\n  padding: \"0 1rem\",\n  borderRadius: \"2rem\",\n  fontFamily: \"inherit\",\n  fontSize: \"1rem\",\n  lineHeight: \"1rem\",\n  boxShadow: \"inset 1px 1px 2px #0003\",\n\n  \"&::placeholder\": {\n    color: \"$primaryMuted\",\n  },\n});\n\nconst Button = styled(\"button\", {\n  display: \"flex\",\n  background: \"none\",\n  border: \"none\",\n  width: \"2rem !important\",\n  height: \"2rem !important\",\n  padding: \"0\",\n  margin: \"0\",\n  fontWeight: \"700\",\n  borderRadius: \"2rem\",\n  backgroundColor: \"$accent\",\n  color: \"$secondary\",\n  cursor: \"pointer\",\n  boxSizing: \"content-box !important\",\n  transition: \"$all\",\n\n  svg: {\n    height: \"60%\",\n    width: \"60%\",\n    padding: \"20%\",\n    fill: \"$secondary\",\n    stroke: \"$secondary\",\n    opacity: \"1\",\n    filter: \"drop-shadow(5px 5px 5px #000D)\",\n    boxSizing: \"inherit\",\n    transition: \"$all\",\n  },\n\n  \"&:disabled\": {\n    backgroundColor: \"transparent\",\n    boxShadow: \"none\",\n    svg: { opacity: \"0.25\" },\n  },\n});\n\nconst Direction = styled(\"div\", {\n  display: \"flex\",\n  marginRight: \"0.618rem\",\n  backgroundColor: \"$accentAlt\",\n  borderRadius: \"2rem\",\n  boxShadow: \"5px 5px 5px #0003\",\n  color: \"$secondary\",\n  alignItems: \"center\",\n\n  \"> span\": {\n    display: \"flex\",\n    margin: \"0 0.5rem\",\n    fontSize: \"0.7222rem\",\n  },\n});\n\nconst Wrapper = styled(\"div\", {\n  display: \"flex\",\n  position: \"relative\",\n  zIndex: \"1\",\n  width: \"100%\",\n  padding: \"0\",\n  transition: \"$all\",\n\n  variants: {\n    isToggle: {\n      true: {\n        paddingTop: \"2.618rem\",\n\n        [`& ${Form}`]: {\n          width: \"calc(100% - 2rem)\",\n\n          \"@sm\": {\n            width: \"calc(100% - 2rem)\",\n          },\n        },\n      },\n    },\n  },\n});\n\nexport { Button, Direction, Form, Input, Wrapper };\n","import { useEffect } from \"react\";\n/**\n * useKeyPress\n * @param {string} key - the name of the key to respond to, compared against event.key\n * @param {function} action - the action to perform on key press\n */\nconst useKeyPress = (key: string, action: () => void) => {\n  useEffect(() => {\n    function onKeyup(e: KeyboardEvent) {\n      if (e.key === key) action();\n    }\n    window.addEventListener(\"keyup\", onKeyup);\n    return () => window.removeEventListener(\"keyup\", onKeyup);\n  }, []);\n};\n\nexport default useKeyPress;\n","import {\n  Button,\n  Direction,\n  Form,\n  Input,\n  Wrapper,\n} from \"src/components/Viewer/Media/Controls.styled\";\nimport React, { useEffect, useState } from \"react\";\n\nimport useKeyPress from \"src/hooks/useKeyPress\";\n\ninterface Props {\n  handleCanvasToggle: (arg0: -1 | 1) => void;\n  handleFilter: (arg0: string) => void;\n  activeIndex: number;\n  canvasLength: number;\n}\nconst PreviousIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Arrow Back</title>\n      <path\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeMiterlimit=\"10\"\n        strokeWidth=\"45\"\n        d=\"M244 400L100 256l144-144M120 256h292\"\n      />\n    </svg>\n  );\n};\n\nconst NextIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Arrow Forward</title>\n      <path\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeMiterlimit=\"10\"\n        strokeWidth=\"45\"\n        d=\"M268 112l144 144-144 144M392 256H100\"\n      />\n    </svg>\n  );\n};\n\nconst CloseIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Close</title>\n      <path d=\"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z\" />\n    </svg>\n  );\n};\n\nconst SearchIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Search</title>\n      <path d=\"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z\" />\n    </svg>\n  );\n};\n\nconst Controls: React.FC<Props> = ({\n  handleCanvasToggle,\n  handleFilter,\n  activeIndex,\n  canvasLength,\n}) => {\n  const [toggleFilter, setToggleFilter] = useState<boolean>(false);\n  const [isNextDisabled, setIsNextDisabled] = useState<boolean>(false);\n  const [isPreviousDisabled, setIsPreviousDisabled] = useState<boolean>(false);\n\n  useEffect(() => {\n    activeIndex === 0\n      ? setIsPreviousDisabled(true)\n      : setIsPreviousDisabled(false);\n    activeIndex === canvasLength - 1\n      ? setIsNextDisabled(true)\n      : setIsNextDisabled(false);\n  }, [activeIndex, canvasLength]);\n\n  /**\n   * dismiss filtering if Escape key is pressed\n   */\n  useKeyPress(\"Escape\", () => {\n    setToggleFilter(false);\n    handleFilter(\"\");\n  });\n\n  /**\n   * reset filtering on manual toggle button press\n   */\n  const handleFilterToggle = () => {\n    setToggleFilter((prevToggleFilter) => !prevToggleFilter);\n    handleFilter(\"\");\n  };\n\n  /**\n   * handle value changes on Input\n   */\n  const handleFilterChange = (event: React.ChangeEvent<HTMLInputElement>) =>\n    handleFilter(event.target.value);\n\n  return (\n    <Wrapper isToggle={toggleFilter}>\n      <Form>\n        {toggleFilter && (\n          <Input autoFocus onChange={handleFilterChange} placeholder=\"Search\" />\n        )}\n        {!toggleFilter && (\n          <Direction>\n            <Button\n              onClick={() => handleCanvasToggle(-1)}\n              disabled={isPreviousDisabled}\n              type=\"button\"\n            >\n              <PreviousIcon />\n            </Button>\n            <span>\n              {activeIndex + 1} of {canvasLength}\n            </span>\n            <Button\n              onClick={() => handleCanvasToggle(1)}\n              disabled={isNextDisabled}\n              type=\"button\"\n            >\n              <NextIcon />\n            </Button>\n          </Direction>\n        )}\n        <Button onClick={handleFilterToggle} type=\"button\">\n          {toggleFilter ? <CloseIcon /> : <SearchIcon />}\n        </Button>\n      </Form>\n    </Wrapper>\n  );\n};\n\nexport default Controls;\n","import * as RadioGroup from \"@radix-ui/react-radio-group\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst Group = styled(RadioGroup.Root, {\n  display: \"flex\",\n  flexDirection: \"row\",\n  flexGrow: \"1\",\n  padding: \"1.618rem\",\n  overflowX: \"scroll\",\n  position: \"relative\",\n  zIndex: \"0\",\n});\n\nexport { Group };\n","import React from \"react\";\n\nconst Add: React.FC = () => (\n  <path\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    strokeWidth=\"32\"\n    d=\"M256 112v288M400 256H112\"\n  />\n);\n\nexport default Add;\n","import React from \"react\";\n\nconst Audio: React.FC = () => (\n  <>\n    <path d=\"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z\" />\n    <path d=\"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z\" />\n    <path d=\"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z\" />\n  </>\n);\n\nexport default Audio;\n","import React from \"react\";\n\nconst Close: React.FC = () => (\n  <path d=\"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z\" />\n);\n\nexport default Close;\n","import React from \"react\";\n\nconst Download: React.FC = () => (\n  <>\n    <path\n      d=\"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth=\"32\"\n    />\n    <path\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth=\"32\"\n      d=\"M176 272l80 80 80-80M256 48v288\"\n    />\n  </>\n);\n\nexport default Download;\n","import React from \"react\";\n\nconst Image: React.FC = () => (\n  <path d=\"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z\" />\n);\n\nexport default Image;\n","import React from \"react\";\n\nconst Video: React.FC = () => (\n  <path d=\"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z\" />\n);\n\nexport default Video;\n","import { styled } from \"src/styles/stitches.config\";\n\nexport const StyledIcon = styled(\"svg\", {\n  display: \"inline-flex\",\n\n  variants: {\n    isLarge: {\n      true: {\n        height: \"4rem\",\n        width: \"4rem\",\n      },\n    },\n    isMedium: {\n      true: {\n        height: \"2rem\",\n        width: \"2rem\",\n      },\n    },\n    isSmall: {\n      true: {\n        height: \"1rem\",\n        width: \"1rem\",\n      },\n    },\n  },\n});\n","import {\n  Add,\n  Audio,\n  Close,\n  Download,\n  Image,\n  Video,\n} from \"src/components/UI/Icons\";\nimport { type CSS, type VariantProps } from \"src/styles/stitches.config\";\n\nimport React from \"react\";\nimport { StyledIcon } from \"./Icon.styled\";\n\n/**\n * Define SVG sub element <title>\n */\ntype TitleShape = {\n  children: React.ReactNode;\n};\n\nconst Title: React.FC<TitleShape> = ({ children }) => {\n  return <title>{children}</title>;\n};\n\n/**\n * Define <svg>\n */\n\ntype IconShape = {\n  children: React.ReactNode | React.ReactNode[];\n};\ninterface IconComposition {\n  Add: React.FC;\n  Audio: React.FC;\n  Close: React.FC;\n  Download: React.FC;\n  Image: React.FC;\n  Title: React.FC<TitleShape>;\n  Video: React.FC;\n}\n\ntype VariantComponentProps = React.SVGAttributes<SVGElement>;\ntype IconVariants = VariantProps<typeof StyledIcon>;\ntype IconProps = VariantComponentProps &\n  IconVariants & { css?: CSS } & IconShape;\n\nconst Icon: React.FC<IconProps> & IconComposition = (props) => {\n  return (\n    <StyledIcon\n      {...props}\n      data-testid=\"icon-svg\"\n      role=\"img\"\n      viewBox=\"0 0 512 512\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      {props.children}\n    </StyledIcon>\n  );\n};\n\n/**\n * Title\n */\nIcon.Title = Title;\n\n/**\n * Path\n */\nIcon.Add = Add;\nIcon.Audio = Audio;\nIcon.Close = Close;\nIcon.Download = Download;\nIcon.Image = Image;\nIcon.Video = Video;\n\nexport { Icon };\n","import * as Popover from \"@radix-ui/react-popover\";\n\nimport { keyframes, styled } from \"src/styles/stitches.config\";\n\nconst slideDown = keyframes({\n  \"0%\": { opacity: 0, transform: \"translateY(1rem)\" },\n  \"100%\": { opacity: 1, transform: \"translateY(0)\" },\n});\n\nconst slideUp = keyframes({\n  \"0%\": { opacity: 0, transform: \"translateY(1rem)\" },\n  \"100%\": { opacity: 1, transform: \"translateY(0)\" },\n});\n\nconst StyledArrow = styled(Popover.Arrow, {\n  fill: \"$secondaryAlt\",\n});\n\nconst StyledClose = styled(Popover.Close, {\n  position: \"absolute\",\n  right: \"0\",\n  top: \"0\",\n  padding: \"0.5rem\",\n  margin: \"0\",\n  cursor: \"pointer\",\n  border: \"none\",\n  background: \"none\",\n  fill: \"inherit\",\n\n  \"&:hover\": {\n    opacity: \"0.75\",\n  },\n});\n\nconst StyledContent = styled(Popover.Content, {\n  border: \"none\",\n  backgroundColor: \"white\",\n  fill: \"inhrerit\",\n  padding: \"1rem 2rem 1rem 1rem\",\n  width: \"auto\",\n  minWidth: \"200px\",\n  maxWidth: \"350px\",\n  borderRadius: \"3px\",\n  boxShadow: \"5px 5px 13px #0002\",\n\n  /**\n   * Animate toggle\n   */\n  animationDuration: \"0.3s\",\n  animationTimingFunction: \"cubic-bezier(0.16, 1, 0.3, 1)\",\n  '&[data-side=\"top\"]': { animationName: slideUp },\n  '&[data-side=\"bottom\"]': { animationName: slideDown },\n\n  /**\n   *\n   */\n  '&[data-align=\"end\"]': {\n    [`& ${StyledArrow}`]: {\n      margin: \"0 0.7rem\",\n    },\n  },\n});\n\nconst StyledTrigger = styled(Popover.Trigger, {\n  display: \"inline-flex\",\n  padding: \"0.5rem 0\",\n  margin: \"0 0.5rem 0 0\",\n  cursor: \"pointer\",\n  border: \"none\",\n  background: \"none\",\n\n  \"> button, > span\": {\n    margin: \"0\",\n  },\n});\n\nconst StyledPopover = styled(Popover.Root, {\n  boxSizing: \"content-box\",\n});\n\nexport {\n  StyledArrow,\n  StyledClose,\n  StyledContent,\n  StyledPopover,\n  StyledTrigger,\n};\n","import { CSS, VariantProps } from \"src/styles/stitches.config\";\nimport {\n  StyledArrow,\n  StyledClose,\n  StyledContent,\n  StyledPopover,\n  StyledTrigger,\n} from \"./Popover.styled\";\n\nimport { Icon } from \"../Icon/Icon\";\nimport React from \"react\";\n\n/**\n *\n */\ntype TriggerShape = {\n  children: React.ReactNode;\n  \"aria-controls\"?: string;\n};\n\ntype TriggerComponentProps = React.ButtonHTMLAttributes<HTMLButtonElement>;\ntype TriggerProps = TriggerComponentProps & TriggerShape & { css?: CSS };\n\nconst Trigger: React.FC<TriggerProps> = (props) => {\n  return <StyledTrigger {...props}>{props.children}</StyledTrigger>;\n};\n\n/**\n *\n */\ntype ContentShape = {\n  children: React.ReactNode | React.ReactNode[];\n  id?: string;\n};\n\ntype ContentComponentProps = React.HTMLAttributes<HTMLDivElement>;\ntype ContentVariants = VariantProps<typeof StyledContent>;\ntype ContentProps = ContentComponentProps &\n  ContentShape &\n  ContentVariants & { css?: CSS };\n\nconst Content: React.FC<ContentProps> = (props) => {\n  return (\n    <StyledContent {...props}>\n      <StyledArrow />\n      <StyledClose>\n        <Icon isSmall>\n          <Icon.Close />\n        </Icon>\n      </StyledClose>\n      {props.children}\n    </StyledContent>\n  );\n};\n\n/**\n *\n */\ntype PopoverShape = {\n  children: React.ReactChild | React.ReactChild[];\n};\n\ninterface PopoverComposition {\n  Content: React.FC<ContentShape & ContentVariants>;\n  Trigger: React.FC<TriggerShape>;\n}\n\ntype PopoverProps = PopoverShape & { css?: CSS };\n\nconst Popover: React.FC<PopoverProps> & PopoverComposition = ({ children }) => {\n  return <StyledPopover>{children}</StyledPopover>;\n};\n\nPopover.Trigger = Trigger;\nPopover.Content = Content;\n\nexport { Popover };\n","import { StyledIcon } from \"../Icon/Icon.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nexport const Tag = styled(\"div\", {\n  // Reset\n  boxSizing: \"border-box\",\n\n  // Custom\n  display: \"inline-flex\",\n  alignItems: \"center\",\n  borderRadius: \"5px\",\n  padding: \"$1\",\n  marginBottom: \"$2\",\n  marginRight: \"$2\",\n  backgroundColor: \"$lightGrey\",\n  color: \"$richBlack50\",\n  textTransform: \"uppercase\",\n  fontSize: \"$2\",\n  objectFit: \"contain\",\n  lineHeight: \"1em !important\",\n\n  \"&:last-child\": {\n    marginRight: \"0\",\n  },\n\n  [`${StyledIcon}`]: {\n    position: \"absolute\",\n    left: \"$1\",\n    height: \"$3\",\n    width: \"$3\",\n  },\n\n  variants: {\n    isIcon: {\n      true: { position: \"relative\", paddingLeft: \"$5\" },\n    },\n  },\n});\n","import * as RadioGroup from \"@radix-ui/react-radio-group\";\n\nimport { Tag } from \"src/components/UI\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst Type = styled(\"span\", {\n  display: \"flex\",\n});\n\nconst Spacer = styled(\"span\", {\n  display: \"flex\",\n  width: \"1.2111rem\",\n  height: \"0.7222rem\",\n});\n\nconst Duration = styled(\"span\", {\n  display: \"inline-flex\",\n  marginLeft: \"5px\",\n  marginBottom: \"-1px\",\n});\n\nconst Item = styled(RadioGroup.Item, {\n  display: \"flex\",\n  flexShrink: \"0\",\n  margin: \"0 1.618rem 0 0\",\n  padding: \"0\",\n  cursor: \"pointer\",\n  background: \"none\",\n  border: \"none\",\n  fontFamily: \"inherit\",\n  lineHeight: \"1.25em\",\n  fontSize: \"1rem\",\n  textAlign: \"left\",\n\n  \"&:last-child\": {\n    marginRight: \"1rem\",\n  },\n\n  figure: {\n    margin: \"0\",\n    width: \"161.8px\",\n\n    \"> div\": {\n      position: \"relative\",\n      display: \"flex\",\n      backgroundColor: \"$secondaryAlt\",\n      width: \"inherit\",\n      height: \"100px\",\n      overflow: \"hidden\",\n      borderRadius: \"3px\",\n      transition: \"$all\",\n\n      img: {\n        width: \"100%\",\n        height: \"100%\",\n        objectFit: \"cover\",\n        filter: \"blur(0)\",\n        transform: \"scale3d(1, 1, 1)\",\n        transition: \"$all\",\n        color: \"transparent\",\n      },\n\n      [`& ${Type}`]: {\n        position: \"absolute\",\n        right: \"0\",\n        bottom: \"0\",\n\n        [`& ${Tag}`]: {\n          margin: \"0\",\n          paddingLeft: \"0\",\n          fontSize: \"0.7222rem\",\n          backgroundColor: \"#000d\",\n          color: \"$secondary\",\n          fill: \"$secondary\",\n          borderBottomLeftRadius: \"0\",\n          borderTopRightRadius: \"0\",\n        },\n      },\n    },\n\n    figcaption: {\n      marginTop: \"0.5rem\",\n      fontWeight: \"400\",\n      fontSize: \"0.8333rem\",\n      display: \"-webkit-box\",\n      overflow: \"hidden\",\n      MozBoxOrient: \"vertical\",\n      WebkitBoxOrient: \"vertical\",\n      WebkitLineClamp: \"5\",\n\n      \"@sm\": {\n        fontSize: \"0.8333rem\",\n      },\n    },\n  },\n\n  \"&[aria-checked='true']\": {\n    figure: {\n      \"> div\": {\n        backgroundColor: \"$primaryAlt\",\n\n        \"&::before\": {\n          position: \"absolute\",\n          zIndex: \"1\",\n          color: \"$secondaryMuted\",\n          content: \"Active Item\",\n          textTransform: \"uppercase\",\n          fontWeight: \"700\",\n          fontSize: \"0.6111rem\",\n          letterSpacing: \"0.03rem\",\n          display: \"flex\",\n          width: \"100%\",\n          height: \"100%\",\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          textAlign: \"center\",\n          textShadow: \"5px 5px 5px #0003\",\n        },\n\n        img: {\n          opacity: \"0.3\",\n          transform: \"scale3d(1.1, 1.1, 1.1)\",\n          filter: \"blur(2px)\",\n        },\n\n        [`& ${Type}`]: {\n          [`& ${Tag}`]: {\n            backgroundColor: \"$accent\",\n          },\n        },\n      },\n    },\n\n    figcaption: {\n      fontWeight: \"700\",\n    },\n  },\n});\n\nexport { Duration, Item, Spacer, Type };\n","import {\n  CanvasNormalized,\n  IIIFExternalWebResource,\n} from \"@iiif/presentation-3\";\nimport {\n  Duration,\n  Item,\n  Spacer,\n  Type,\n} from \"src/components/Viewer/Media/Thumbnail.styled\";\nimport { Icon, Tag } from \"src/components/UI\";\n\nimport { Label } from \"src/components/Primitives\";\nimport React from \"react\";\nimport { convertTime } from \"src/lib/utils\";\nimport { getLabel } from \"src/hooks/use-iiif\";\n\n/**\n * Determine appropriate icon by resource type\n */\ninterface IconPathProps {\n  type: string;\n}\n\nconst IconPath: React.FC<IconPathProps> = ({ type }) => {\n  switch (type) {\n    case \"Sound\":\n      return <Icon.Audio />;\n    case \"Image\":\n      return <Icon.Image />;\n    case \"Video\":\n      return <Icon.Video />;\n    default:\n      return <Icon.Image />;\n  }\n};\n\n/**\n * Render thumbnail for IIIF canvas item\n */\nexport interface ThumbnailProps {\n  canvas: CanvasNormalized;\n  canvasIndex: number;\n  isActive: boolean;\n  thumbnail?: IIIFExternalWebResource;\n  type: string;\n  handleChange: (arg0: string) => void;\n}\n\nconst Thumbnail: React.FC<ThumbnailProps> = ({\n  canvas,\n  canvasIndex,\n  isActive,\n  thumbnail,\n  type,\n  handleChange,\n}) => {\n  return (\n    <Item\n      aria-checked={isActive}\n      data-testid=\"media-thumbnail\"\n      data-canvas={canvasIndex}\n      onClick={() => handleChange(canvas.id)}\n      value={canvas.id}\n    >\n      <figure>\n        <div>\n          {thumbnail?.id && (\n            <img\n              src={thumbnail.id}\n              alt={canvas?.label ? (getLabel(canvas.label) as string) : \"\"}\n            />\n          )}\n\n          <Type>\n            <Tag isIcon data-testid=\"thumbnail-tag\">\n              <Spacer />\n              <Icon aria-label={type}>\n                <IconPath type={type} />\n              </Icon>\n              {[\"Video\", \"Sound\"].includes(type) && (\n                <Duration>{convertTime(canvas.duration as number)}</Duration>\n              )}\n            </Tag>\n          </Type>\n        </div>\n        {canvas?.label && (\n          <figcaption data-testid=\"fig-caption\">\n            <Label label={canvas.label} />\n          </figcaption>\n        )}\n      </figure>\n    </Item>\n  );\n};\n\nexport default Thumbnail;\n","export const getResourceType = (annotation: any): string => {\n  if (!annotation.body) return \"Image\";\n\n  return annotation.body.type;\n};\n","import {\n  Canvas,\n  CanvasNormalized,\n  ExternalResourceTypes,\n} from \"@iiif/presentation-3\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  ViewerContextStore,\n  useViewerDispatch,\n  useViewerState,\n} from \"src/context/viewer-context\";\nimport {\n  getCanvasByCriteria,\n  getLabel,\n  getThumbnail,\n} from \"src/hooks/use-iiif\";\n\nimport { CanvasEntity } from \"src/hooks/use-iiif/getCanvasByCriteria\";\nimport Controls from \"src/components/Viewer/Media/Controls\";\nimport { Group } from \"src/components/Viewer/Media/Media.styled\";\nimport Thumbnail from \"src/components/Viewer/Media/Thumbnail\";\nimport { getResourceType } from \"src/hooks/use-iiif/getResourceType\";\n\ninterface MediaProps {\n  items: Canvas[];\n  activeItem: number;\n}\n\nconst Media: React.FC<MediaProps> = ({ items }) => {\n  const dispatch: any = useViewerDispatch();\n  const state: ViewerContextStore = useViewerState();\n  const { activeCanvas, vault } = state;\n\n  const [filter, setFilter] = useState<string>(\"\");\n  const [mediaItems, setMediaItems] = useState<Array<CanvasEntity>>([]);\n  const [activeIndex, setActiveIndex] = useState<number>(0);\n\n  const scrollRef = React.useRef<HTMLDivElement>(null);\n\n  const motivation = \"painting\";\n\n  const handleChange = (canvasId: string) => {\n    if (activeCanvas !== canvasId)\n      dispatch({\n        type: \"updateActiveCanvas\",\n        canvasId: canvasId,\n      });\n  };\n\n  useEffect(() => {\n    if (!mediaItems.length) {\n      const paintingType: ExternalResourceTypes[] = [\"Image\", \"Sound\", \"Video\"];\n      const entities: CanvasEntity[] = items\n        .map((item) =>\n          getCanvasByCriteria(vault, item, motivation, paintingType),\n        )\n        .filter((canvasEntity) => canvasEntity.annotations.length > 0);\n      setMediaItems(entities);\n    }\n  }, [items, mediaItems.length, vault]);\n\n  useEffect(() => {\n    mediaItems.forEach((item, index) => {\n      if (item?.canvas)\n        if (item.canvas.id === activeCanvas) setActiveIndex(index);\n    });\n  }, [activeCanvas, mediaItems]);\n\n  useEffect(() => {\n    const element = document.querySelector<HTMLElement>(\n      `[data-canvas=\"${activeIndex}\"]`,\n    ) as Element;\n\n    if (element instanceof HTMLElement && scrollRef.current) {\n      const leftPos =\n        element.offsetLeft -\n        scrollRef.current.offsetWidth / 2 +\n        element.offsetWidth / 2;\n      scrollRef.current.scrollTo({ left: leftPos, behavior: \"smooth\" });\n    }\n  }, [activeIndex]);\n\n  const handleFilter = (value: string) => setFilter(value);\n\n  const handleCanvasToggle = (step: -1 | 1) => {\n    const canvasEntity = mediaItems[activeIndex + step];\n    if (canvasEntity?.canvas) handleChange(canvasEntity.canvas.id);\n  };\n\n  return (\n    <>\n      <Controls\n        handleFilter={handleFilter}\n        handleCanvasToggle={handleCanvasToggle}\n        activeIndex={activeIndex}\n        canvasLength={mediaItems.length}\n      />\n      <Group aria-label=\"select item\" data-testid=\"media\" ref={scrollRef}>\n        {mediaItems\n          .filter((item) => {\n            if (item.canvas?.label) {\n              const label = getLabel(item.canvas.label);\n              if (Array.isArray(label))\n                return label[0].toLowerCase().includes(filter.toLowerCase());\n            }\n          })\n          .map((item, index) => (\n            <Thumbnail\n              canvas={item.canvas as CanvasNormalized}\n              canvasIndex={index}\n              handleChange={handleChange}\n              isActive={activeCanvas === item?.canvas?.id ? true : false}\n              key={item?.canvas?.id}\n              thumbnail={getThumbnail(vault, item, 200, 200)}\n              type={getResourceType(item.annotations[0])}\n            />\n          ))}\n      </Group>\n    </>\n  );\n};\n\nexport default Media;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst PlaceholderStyled = styled(\"button\", {\n  position: \"absolute\",\n  background: \"none\",\n  border: \"none\",\n  cursor: \"zoom-in\",\n  margin: \"0\",\n  padding: \"0\",\n  width: \"100%\",\n  height: \"100%\",\n  transition: \"$all\",\n\n  \"& img\": {\n    width: \"100%\",\n    height: \"100%\",\n    objectFit: \"contain\",\n    color: \"transparent\",\n    transition: \"$all\",\n  },\n\n  variants: {\n    isMedia: {\n      true: {\n        cursor: \"pointer\",\n      },\n    },\n  },\n});\n\nexport { PlaceholderStyled };\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Item = styled(\"button\", {\n  display: \"flex\",\n  height: \"2rem\",\n  width: \"2rem\",\n  borderRadius: \"2rem\",\n  padding: \"0\",\n  margin: \"0\",\n  fontFamily: \"inherit\",\n  background: \"none\",\n  backgroundColor: \"$primary\",\n  border: \"none\",\n  color: \"white\",\n  cursor: \"pointer\",\n  marginLeft: \"0.618rem\",\n  filter: \"drop-shadow(2px 2px 5px #0003)\",\n  transition: \"$all\",\n  boxSizing: \"content-box !important\",\n\n  \"&:first-child\": {\n    marginLeft: \"0\",\n  },\n\n  \"@xs\": {\n    marginBottom: \"0.618rem\",\n    marginLeft: \"0\",\n\n    \"&:last-child\": {\n      marginBottom: \"0\",\n    },\n  },\n\n  svg: {\n    height: \"60%\",\n    width: \"60%\",\n    padding: \"20%\",\n    fill: \"$secondary\",\n    stroke: \"$secondary\",\n    filter: \"drop-shadow(2px 2px 5px #0003)\",\n    transition: \"$all\",\n    boxSizing: \"inherit\",\n  },\n\n  \"&:hover, &:focus\": {\n    backgroundColor: \"$accent\",\n  },\n\n  \"&[data-button=rotate-right]\": {\n    \"&:hover, &:focus\": {\n      svg: {\n        rotate: \"45deg\",\n      },\n    },\n  },\n\n  \"&[data-button=rotate-left]\": {\n    transform: \"scaleX(-1)\",\n\n    \"&:hover, &:focus\": {\n      svg: {\n        rotate: \"45deg\",\n      },\n    },\n  },\n\n  \"&[data-button=reset]\": {\n    \"&:hover, &:focus\": {\n      svg: {\n        rotate: \"-15deg\",\n      },\n    },\n  },\n});\n\nexport { Item };\n","import { Item as ButtonStyled } from \"src/components/Image/Controls/Button.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst ToggleStyled = styled(ButtonStyled, {\n  position: \"absolute\",\n  width: \"2rem\",\n  top: \"1rem\",\n  right: \"1rem\",\n  zIndex: 100,\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  textAlign: \"center\",\n  transition: \"$all\",\n  borderRadius: \"50%\",\n  backgroundColor: \"$accent\",\n  cursor: \"pointer\",\n\n  \"&:hover, &:focus\": {\n    backgroundColor: \"$accent !important\",\n  },\n\n  variants: {\n    isInteractive: {\n      true: {\n        \"&:hover\": {\n          opacity: \"1\",\n        },\n      },\n      false: {},\n    },\n    isMedia: {\n      true: {\n        cursor: \"pointer !important\",\n      },\n    },\n  },\n\n  compoundVariants: [\n    {\n      isInteractive: false,\n      isMedia: true,\n      css: {\n        top: \"50%\",\n        right: \"50%\",\n        width: \"4rem\",\n        height: \"4rem\",\n        transform: \"translate(50%,-50%)\",\n      },\n    },\n  ],\n});\n\nexport { ToggleStyled };\n","import { PlaceholderStyled } from \"./Placeholder.styled\";\nimport { ToggleStyled } from \"src/components/Viewer/Painting/Toggle.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst PaintingStyled = styled(\"div\", {\n  position: \"relative\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  flexGrow: \"1\",\n  flexShrink: \"1\",\n  gap: \"1rem\",\n  zIndex: \"0\",\n  overflow: \"hidden\",\n\n  \"&:hover\": {\n    [`${ToggleStyled}`]: {\n      backgroundColor: \"$accent\",\n    },\n\n    [`${PlaceholderStyled}`]: {\n      backgroundColor: \"#6662\",\n    },\n  },\n});\n\nconst PaintingCanvas = styled(\"div\", {\n  width: \"100%\",\n  height: \"100%\",\n});\n\nexport { PaintingCanvas, PaintingStyled, ToggleStyled };\n","import * as Select from \"@radix-ui/react-select\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledSelectIcon = styled(\"svg\", {\n  height: \"19px\",\n  color: \"$accent\",\n  fill: \"$accent\",\n  stroke: \"$accent\",\n  display: \"flex\",\n  margin: \"0.25rem 0.85rem\",\n});\n\nconst StyledSelectButton = styled(Select.Trigger, {\n  fontSize: \"1.25rem\",\n  fontWeight: \"400\",\n  fontFamily: \"inherit\",\n  alignSelf: \"flex-start\",\n  flexGrow: \"1\",\n  cursor: \"pointer\",\n  transition: \"$all\",\n  border: \"1px solid #6663\",\n  boxShadow: \"2px 2px 5px #0001\",\n  borderRadius: \"3px\",\n  display: \"flex\",\n  alignItems: \"center\",\n  paddingLeft: \"0.5rem\",\n  width: \"100%\",\n\n  \"@sm\": {\n    fontSize: \"1rem\",\n  },\n});\n\nconst StyledSelectContent = styled(Select.Content, {\n  borderRadius: \"3px\",\n  boxShadow: \"3px 3px 8px #0003\",\n  backgroundColor: \"$secondary\",\n  marginTop: \"2.25rem\",\n  marginLeft: \"6px\",\n  paddingBottom: \"0.25rem\",\n  maxHeight: \"calc(61.8vh - 2.5rem) !important\",\n  borderTopLeftRadius: \"0\",\n  border: \"1px solid $secondaryMuted\",\n  maxWidth: \"90vw\",\n});\n\nconst StyledSelectItem = styled(Select.Item, {\n  display: \"flex\",\n  alignItems: \"center\",\n  fontFamily: \"inherit\",\n  padding: \"0.25rem 0.5rem\",\n  color: \"$primary\",\n  fontWeight: \"400\",\n  fontSize: \"0.8333rem\",\n  cursor: \"pointer\",\n  backgroundColor: \"$secondary\",\n  width: \"calc(100% - 1rem)\",\n\n  \"> span\": {\n    whiteSpace: \"nowrap\",\n    textOverflow: \"ellipsis\",\n    overflow: \"hidden\",\n  },\n\n  '&[data-state=\"checked\"]': {\n    fontWeight: \"700\",\n    color: \"$primary !important\",\n  },\n\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n\n  img: {\n    width: \"31px\",\n    height: \"31px\",\n    marginRight: \"0.5rem\",\n    borderRadius: \"3px\",\n  },\n});\n\nconst StyledSelectLabel = styled(Select.Label, {\n  color: \"$primaryMuted\",\n  fontFamily: \"inherit\",\n  fontSize: \"0.85rem\",\n  padding: \"0.5rem 1rem 0.5rem 0.5rem\",\n  display: \"flex\",\n  alignItems: \"center\",\n  marginBottom: \"0.25rem\",\n  borderRadius: \"3px\",\n  borderTopLeftRadius: \"0\",\n  borderBottomLeftRadius: \"0\",\n  borderBottomRightRadius: \"0\",\n  backgroundColor: \"$secondaryMuted\",\n});\n\nconst StyledSelect = styled(Select.Root, {\n  position: \"relative\",\n  zIndex: \"5\",\n  width: \"100%\",\n});\n\nexport {\n  StyledSelectButton,\n  StyledSelectContent,\n  StyledSelectItem,\n  StyledSelectLabel,\n  StyledSelectIcon,\n  StyledSelect,\n};\n","import React from \"react\";\nimport { StyledSelectIcon } from \"./Select.styled\";\n\ninterface SelectIconProps {\n  direction: \"up\" | \"down\";\n  title: string;\n}\n\nconst SelectIcon: React.FC<SelectIconProps> = ({ direction, title }) => {\n  const CaretUp = () => {\n    return (\n      <path d=\"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z\" />\n    );\n  };\n\n  const CaretDown = () => {\n    return (\n      <path d=\"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z\" />\n    );\n  };\n\n  return (\n    <StyledSelectIcon\n      xmlns=\"http://www.w3.org/2000/svg\"\n      focusable=\"false\"\n      viewBox=\"0 0 512 512\"\n      role=\"img\"\n    >\n      <title>{title}</title>\n      {direction === \"up\" && <CaretUp />}\n      {direction === \"down\" && <CaretDown />}\n    </StyledSelectIcon>\n  );\n};\n\nexport default SelectIcon;\n","import {\n  SelectProps as RadixSelectProps,\n  SelectGroup,\n  SelectIcon,\n  SelectPortal,\n  SelectScrollDownButton,\n  SelectScrollUpButton,\n  SelectValue,\n  SelectViewport,\n} from \"@radix-ui/react-select\";\nimport React, { ReactNode } from \"react\";\nimport {\n  StyledSelect,\n  StyledSelectButton,\n  StyledSelectContent,\n  StyledSelectLabel,\n} from \"src/components/UI/Select/Select.styled\";\n\nimport Icon from \"./Icon\";\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport { Label } from \"src/components/Primitives\";\n\ninterface SelectProps extends RadixSelectProps {\n  children?: ReactNode[] | ReactNode;\n  label?: InternationalString;\n  maxHeight: string;\n}\n\n/**\n * generic select component\n */\nconst Select: React.FC<SelectProps> = ({\n  children,\n  label,\n  maxHeight,\n  onValueChange,\n  value,\n}) => {\n  return (\n    <StyledSelect onValueChange={onValueChange} value={value}>\n      <StyledSelectButton data-testid=\"select-button\">\n        <SelectValue data-testid=\"select-button-value\" />\n        <SelectIcon>\n          <Icon direction=\"down\" title=\"select\" />\n        </SelectIcon>\n      </StyledSelectButton>\n      <SelectPortal>\n        <StyledSelectContent\n          css={{ maxHeight: `${maxHeight} !important` }}\n          data-testid=\"select-content\"\n        >\n          <SelectScrollUpButton>\n            <Icon direction=\"up\" title=\"scroll up for more\" />\n          </SelectScrollUpButton>\n          <SelectViewport>\n            <SelectGroup>\n              {label && (\n                <StyledSelectLabel>\n                  <Label data-testid=\"select-label\" label={label} />\n                </StyledSelectLabel>\n              )}\n              {children}\n            </SelectGroup>\n          </SelectViewport>\n          <SelectScrollDownButton>\n            <Icon direction=\"down\" title=\"scroll down for more\" />\n          </SelectScrollDownButton>\n        </StyledSelectContent>\n      </SelectPortal>\n    </StyledSelect>\n  );\n};\n\nexport default Select;\n","import {\n  IIIFExternalWebResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\nimport { Label, Thumbnail } from \"src/components/Primitives\";\nimport {\n  SelectItemIndicator,\n  SelectItemProps,\n  SelectItemText,\n} from \"@radix-ui/react-select\";\n\nimport React from \"react\";\nimport { StyledSelectItem } from \"./Select.styled\";\n\nexport interface SelectOptionProps extends SelectItemProps {\n  label: InternationalString;\n  thumbnail?: IIIFExternalWebResource[];\n}\n\nconst SelectOption = (props) => (\n  <StyledSelectItem {...props}>\n    {props.thumbnail && <Thumbnail thumbnail={props.thumbnail} />}\n    <SelectItemText>\n      <Label label={props.label} />\n    </SelectItemText>\n    <SelectItemIndicator />\n  </StyledSelectItem>\n);\n\nexport default SelectOption;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Navigator = styled(\"div\", {\n  position: \"absolute !important\",\n  zIndex: \"1\",\n  top: \"1rem\",\n  left: \"1rem\",\n  width: \"161.8px\",\n  height: \"100px\",\n  backgroundColor: \"#000D\",\n  boxShadow: \"5px 5px 5px #0002\",\n  borderRadius: \"3px\",\n\n  \".displayregion\": {\n    border: \" 3px solid $accent !important\",\n    boxShadow: \"0 0 3px #0006\",\n  },\n\n  \"@sm\": {\n    width: \"123px\",\n    height: \"76px\",\n  },\n\n  \"@xs\": {\n    width: \"100px\",\n    height: \"61.8px\",\n  },\n});\n\nconst Viewport = styled(\"div\", {\n  position: \"relative\",\n  width: \"100%\",\n  height: \"100%\",\n  zIndex: \"0\",\n});\n\nconst Wrapper = styled(\"div\", {\n  width: \"100%\",\n  height: \"100%\",\n  maxHeight: \"100vh\",\n  background: \"transparent\",\n  backgroundSize: \"contain\",\n  color: \"white\",\n  position: \"relative\",\n  zIndex: \"0\",\n  overflow: \"hidden\",\n\n  variants: {\n    hasNavigator: {\n      true: {\n        [`${Navigator}`]: {\n          display: \"block\",\n        },\n      },\n      false: {\n        [`${Navigator}`]: {\n          display: \"none\",\n        },\n      },\n    },\n  },\n});\n\nexport { Navigator, Viewport, Wrapper };\n","import { Item } from \"src/components/Image/Controls/Button.styled\";\nimport React from \"react\";\n\ninterface ButtonProps {\n  className?: string;\n  id: string;\n  label: string;\n  children: React.ReactChild;\n}\n\nconst Button: React.FC<ButtonProps> = ({ className, id, label, children }) => {\n  const dataButton = label.toLowerCase().replace(/\\s/g, \"-\");\n  return (\n    <Item\n      id={id}\n      className={className}\n      data-testid=\"openseadragon-button\"\n      data-button={dataButton}\n    >\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-labelledby={`${id}-svg-title`}\n        data-testid=\"openseadragon-button-svg\"\n        focusable=\"false\"\n        viewBox=\"0 0 512 512\"\n        role=\"img\"\n      >\n        <title id={`${id}-svg-title`}>{label}</title>\n        {children}\n      </svg>\n    </Item>\n  );\n};\n\nexport default Button;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Wrapper = styled(\"div\", {\n  position: \"absolute\",\n  zIndex: \"1\",\n  top: \"1rem\",\n  right: \"1rem\",\n  display: \"flex\",\n\n  \"@xs\": {\n    flexDirection: \"column\",\n    zIndex: \"2\",\n  },\n\n  variants: {\n    hasPlaceholder: {\n      true: {\n        right: \"3.618rem\",\n\n        \"@xs\": {\n          top: \"3.618rem\",\n          right: \"1rem\",\n        },\n      },\n\n      false: {\n        right: \"1rem\",\n\n        \"@xs\": {\n          top: \"1rem\",\n          right: \"1rem\",\n        },\n      },\n    },\n  },\n});\n\nexport { Wrapper };\n","import Button from \"src/components/Image/Controls/Button\";\nimport { Options } from \"openseadragon\";\nimport React from \"react\";\nimport { Wrapper } from \"src/components/Image/Controls/Controls.styled\";\nimport {\n  ViewerContextStore,\n  useViewerState,\n  useViewerDispatch,\n} from \"src/context/viewer-context\";\nimport { CanvasNormalized } from \"@iiif/presentation-3\";\n\nconst ZoomIn = () => {\n  return (\n    <path\n      strokeLinecap=\"round\"\n      strokeMiterlimit=\"10\"\n      strokeWidth=\"45\"\n      d=\"M256 112v288M400 256H112\"\n    />\n  );\n};\n\nconst ZoomOut = () => {\n  return (\n    <path\n      strokeLinecap=\"round\"\n      strokeMiterlimit=\"10\"\n      strokeWidth=\"45\"\n      d=\"M400 256H112\"\n    />\n  );\n};\n\nconst ZoomFullScreen = () => {\n  return (\n    <path\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth=\"32\"\n      d=\"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304\"\n    />\n  );\n};\n\nconst Reset = () => {\n  return (\n    <path d=\"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z\" />\n  );\n};\n\nconst Rotate = () => {\n  return (\n    <>\n      <path\n        fill=\"none\"\n        strokeLinecap=\"round\"\n        strokeMiterlimit=\"10\"\n        strokeWidth=\"45\"\n        d=\"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128\"\n      />\n      <path d=\"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z\" />\n    </>\n  );\n};\n\nconst Controls = ({\n  _cloverViewerHasPlaceholder,\n  config,\n}: {\n  _cloverViewerHasPlaceholder: boolean;\n  config: Options;\n}) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const {\n    activeCanvas,\n    configOptions,\n    openSeadragonViewer,\n    plugins,\n    vault,\n    activeManifest,\n  } = viewerState;\n\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  function renderPlugins() {\n    return plugins\n      .filter((plugin) => plugin.imageViewer?.menu)\n      .map((plugin, i) => {\n        const PluginComponent = plugin.imageViewer?.menu\n          ?.component as unknown as React.ElementType;\n        return (\n          <PluginComponent\n            key={i}\n            {...plugin?.imageViewer?.menu?.componentProps}\n            activeManifest={activeManifest}\n            canvas={canvas}\n            viewerConfigOptions={configOptions}\n            openSeadragonViewer={openSeadragonViewer}\n            useViewerDispatch={useViewerDispatch}\n            useViewerState={useViewerState}\n          ></PluginComponent>\n        );\n      });\n  }\n\n  return (\n    <Wrapper\n      data-testid=\"clover-iiif-image-openseadragon-controls\"\n      hasPlaceholder={_cloverViewerHasPlaceholder}\n    >\n      {config.showZoomControl && (\n        <>\n          <Button id={config.zoomInButton as string} label=\"zoom in\">\n            <ZoomIn />\n          </Button>\n          <Button id={config.zoomOutButton as string} label=\"zoom out\">\n            <ZoomOut />\n          </Button>\n        </>\n      )}\n      {config.showFullPageControl && (\n        <Button id={config.fullPageButton as string} label=\"full page\">\n          <ZoomFullScreen />\n        </Button>\n      )}\n      {config.showRotationControl && (\n        <>\n          <Button id={config.rotateRightButton as string} label=\"rotate right\">\n            <Rotate />\n          </Button>\n          <Button id={config.rotateLeftButton as string} label=\"rotate left\">\n            <Rotate />\n          </Button>\n        </>\n      )}\n      {config.showHomeControl && (\n        <Button id={config.homeButton as string} label=\"reset\">\n          <Reset />\n        </Button>\n      )}\n      {renderPlugins()}\n    </Wrapper>\n  );\n};\n\nexport default Controls;\n","import {\n  Navigator,\n  Viewport,\n  Wrapper,\n} from \"src/components/Image/Image.styled\";\nimport OpenSeadragon, { Options } from \"openseadragon\";\nimport React, { useEffect, useRef, useState } from \"react\";\n\nimport Controls from \"src/components/Image/Controls/Controls\";\nimport { OpenSeadragonImageTypes } from \"src/types/open-seadragon\";\nimport { getInfoResponse } from \"src/lib/iiif\";\nimport { useViewerDispatch } from \"src/context/viewer-context\";\n\ninterface OSDProps {\n  _cloverViewerHasPlaceholder: boolean;\n  ariaLabel?: string | null;\n  config: Options;\n  uri: string | undefined;\n  imageType: OpenSeadragonImageTypes;\n  openSeadragonCallback?: (viewer: OpenSeadragon.Viewer) => void;\n}\n\nconst OSD: React.FC<OSDProps> = ({\n  ariaLabel,\n  config,\n  uri,\n  _cloverViewerHasPlaceholder,\n  imageType,\n  openSeadragonCallback,\n}) => {\n  const [osdUri, setOsdUri] = useState<string>();\n  const [openSeadragon, setOpenSeadragon] = useState<OpenSeadragon.Viewer>();\n  const dispatch: any = useViewerDispatch();\n\n  const initializeOSD = useRef(false);\n\n  useEffect(() => {\n    if (!initializeOSD.current) {\n      initializeOSD.current = true;\n\n      if (!openSeadragon) setOpenSeadragon(OpenSeadragon(config));\n    }\n\n    return () => openSeadragon?.destroy();\n  }, []);\n\n  useEffect(() => {\n    if (openSeadragon && openSeadragonCallback)\n      openSeadragonCallback(openSeadragon);\n  }, [openSeadragon, openSeadragonCallback]);\n\n  useEffect(() => {\n    if (openSeadragon && uri !== osdUri) {\n      openSeadragon?.forceRedraw();\n      setOsdUri(uri);\n    }\n  }, [openSeadragon, osdUri, uri]);\n\n  useEffect(() => {\n    if (osdUri && openSeadragon) {\n      switch (imageType) {\n        case \"simpleImage\":\n          openSeadragon?.addSimpleImage({\n            url: osdUri,\n          });\n          break;\n        case \"tiledImage\":\n          getInfoResponse(osdUri).then((tileSource) => {\n            try {\n              if (!tileSource)\n                throw new Error(`No tile source found for ${osdUri}`);\n\n              openSeadragon?.addTiledImage({\n                tileSource,\n                success: () => {\n                  // NOTE: need to check dispatch is a function, because when\n                  // using dev server, dispatch sometimes is set to\n                  // ViewerContext.defaultState object instead of a function\n                  if (typeof dispatch === \"function\") {\n                    dispatch({\n                      type: \"updateOSDImageLoaded\",\n                      OSDImageLoaded: true,\n                    });\n                  }\n                },\n              });\n            } catch (e) {\n              console.error(e);\n            }\n          });\n          break;\n        default:\n          openSeadragon?.close();\n          console.warn(\n            `Unable to render ${osdUri} in OpenSeadragon as type: \"${imageType}\"`,\n          );\n          break;\n      }\n    }\n  }, [imageType, osdUri]);\n\n  return (\n    <Wrapper\n      className=\"clover-iiif-image-openseadragon\"\n      data-testid=\"clover-iiif-image-openseadragon\"\n      data-openseadragon-instance={config.id}\n      hasNavigator={config.showNavigator}\n    >\n      <Controls\n        _cloverViewerHasPlaceholder={_cloverViewerHasPlaceholder}\n        config={config}\n      />\n      {config.showNavigator && (\n        <Navigator\n          id={config.navigatorId}\n          data-testid=\"clover-iiif-image-openseadragon-navigator\"\n        />\n      )}\n      <Viewport\n        id={config.id}\n        data-testid=\"clover-iiif-image-openseadragon-viewport\"\n        role=\"img\"\n        {...(ariaLabel && { \"aria-label\": ariaLabel })}\n      />\n    </Wrapper>\n  );\n};\n\nexport default OSD;\n","import { Options } from \"openseadragon\";\n\nfunction defaultOpenSeadragonConfiguration(\n  openSeadragonInstance: string,\n): Options {\n  return {\n    id: `openseadragon-${openSeadragonInstance}`,\n    navigatorId: `openseadragon-navigator-${openSeadragonInstance}`,\n    loadTilesWithAjax: true,\n    fullPageButton: `fullPage-${openSeadragonInstance}`,\n    homeButton: `reset-${openSeadragonInstance}`,\n    rotateLeftButton: `rotateLeft-${openSeadragonInstance}`,\n    rotateRightButton: `rotateRight-${openSeadragonInstance}`,\n    zoomInButton: `zoomIn-${openSeadragonInstance}`,\n    zoomOutButton: `zoomOut-${openSeadragonInstance}`,\n    showNavigator: true,\n    showFullPageControl: true,\n    showHomeControl: true,\n    showRotationControl: true,\n    showZoomControl: true,\n    navigatorBorderColor: \"transparent\",\n    gestureSettingsMouse: {\n      clickToZoom: true,\n      dblClickToZoom: true,\n      pinchToZoom: true,\n      scrollToZoom: false,\n    },\n  };\n}\n\nexport default defaultOpenSeadragonConfiguration;\n","import { parseImageBody, parseSrc } from \"src/lib/openseadragon-helpers\";\n\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport ErrorFallback from \"src/components/UI/ErrorFallback/ErrorFallback\";\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport OSD from \"src/components/Image/OSD/OSD\";\nimport { Options } from \"openseadragon\";\nimport React from \"react\";\nimport defaultOpenSeadragonConfig from \"src/components/Image/OSD/defaults\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { v4 as uuidv4 } from \"uuid\";\n\ninterface CloverImageProps {\n  _cloverViewerHasPlaceholder?: boolean;\n  body?: LabeledIIIFExternalWebResource;\n  instanceId?: string;\n  isTiledImage?: boolean;\n  label?: InternationalString | string;\n  src?: string;\n  openSeadragonCallback?: (viewer: any) => void;\n  openSeadragonConfig?: Options;\n}\n\nconst CloverImage: React.FC<CloverImageProps> = ({\n  _cloverViewerHasPlaceholder = false,\n  body,\n  instanceId,\n  isTiledImage = false,\n  label,\n  src = \"\",\n  openSeadragonCallback,\n  openSeadragonConfig = {},\n}) => {\n  const instance = instanceId ? instanceId : uuidv4();\n  const ariaLabel = typeof label === \"string\" ? label : getLabelAsString(label);\n  const config = {\n    ...defaultOpenSeadragonConfig(instance),\n    ...openSeadragonConfig,\n  };\n\n  const { imageType, uri } = body\n    ? parseImageBody(body)\n    : parseSrc(src, isTiledImage);\n\n  if (!uri) return null;\n\n  return (\n    <ErrorBoundary FallbackComponent={ErrorFallback}>\n      <OSD\n        _cloverViewerHasPlaceholder={_cloverViewerHasPlaceholder}\n        ariaLabel={ariaLabel}\n        config={config}\n        imageType={imageType}\n        key={instance}\n        uri={uri}\n        openSeadragonCallback={openSeadragonCallback}\n      />\n    </ErrorBoundary>\n  );\n};\n\nexport default CloverImage;\n","import { getLabel, getPaintingResource } from \"src/hooks/use-iiif\";\n\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport { PlaceholderStyled } from \"./Placeholder.styled\";\nimport React from \"react\";\nimport { useViewerState } from \"src/context/viewer-context\";\n\ninterface Props {\n  isMedia: boolean;\n  label: InternationalString | null;\n  placeholderCanvas: string;\n  setIsInteractive: (arg0: boolean) => void;\n}\n\nconst PaintingPlaceholder: React.FC<Props> = ({\n  isMedia,\n  label,\n  placeholderCanvas,\n  setIsInteractive,\n}) => {\n  const { vault } = useViewerState();\n\n  const painting = getPaintingResource(vault, placeholderCanvas);\n\n  const placeholder = painting ? painting[0] : undefined;\n  const labelAsArray = label\n    ? (getLabel(label) as string[])\n    : [\"placeholder image\"];\n\n  return (\n    <PlaceholderStyled\n      onClick={() => setIsInteractive(true)}\n      isMedia={isMedia}\n      className=\"clover-viewer-placeholder\"\n    >\n      <img\n        src={placeholder?.id || \"\"}\n        alt={labelAsArray.join()}\n        height={placeholder?.height}\n        width={placeholder?.width}\n      />\n    </PlaceholderStyled>\n  );\n};\n\nexport default PaintingPlaceholder;\n","import { styled } from \"src/styles/stitches.config\";\n\nexport const AudioVisualizerWrapper = styled(\"canvas\", {\n  position: \"absolute\",\n  width: \"100%\",\n  height: \"100%\",\n  zIndex: \"0\",\n});\n","/* eslint-disable react/display-name */\n\nimport React, { useCallback } from \"react\";\n\nimport { AudioVisualizerWrapper } from \"src/components/Viewer/Player/AudioVisualizer.styled\";\n\nconst AudioVisualizer = React.forwardRef(\n  (_props, ref: React.RefObject<HTMLVideoElement>) => {\n    const canvasRef = React.useRef<HTMLCanvasElement>(null);\n\n    const audioVisualizer = useCallback(() => {\n      // Block re-initialization if audio is already playing\n      if (ref.current?.currentTime && ref.current?.currentTime > 0) return;\n\n      const video = ref.current;\n      if (!video) return;\n\n      const context = new AudioContext();\n      const src = context.createMediaElementSource(video);\n      const analyser = context.createAnalyser();\n\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      canvas.width = video.offsetWidth;\n      canvas.height = video.offsetHeight;\n      const ctx = canvas.getContext(\"2d\");\n\n      src.connect(analyser);\n      analyser.connect(context.destination);\n\n      analyser.fftSize = 256;\n\n      const bufferLength = analyser.frequencyBinCount;\n      const dataArray = new Uint8Array(bufferLength);\n\n      setInterval(function () {\n        renderFrame(\n          analyser,\n          ctx,\n          bufferLength,\n          dataArray,\n          canvas.width,\n          canvas.height,\n        );\n      }, 20);\n    }, [ref]);\n\n    React.useEffect(() => {\n      if (!ref || !ref.current) return;\n      // Add a callback fn to the `<video>` onplay event\n\n      ref.current.onplay = audioVisualizer;\n    }, [audioVisualizer, ref]);\n\n    function renderFrame(\n      analyser: any,\n      ctx: any,\n      bufferLength: number,\n      dataArray: Uint8Array,\n      width: number,\n      height: number,\n    ) {\n      const barWidth = (width / bufferLength) * 2.6;\n      let barHeight: number;\n      let x = 0;\n\n      analyser.getByteFrequencyData(dataArray);\n\n      ctx.fillStyle = \"#000000\";\n      ctx.fillRect(0, 0, width, height);\n\n      for (let i = 0; i < bufferLength; i++) {\n        barHeight = dataArray[i] * 2;\n        ctx.fillStyle = `rgba(${78}, 42, 132, 1)`;\n        ctx.fillRect(x, height - barHeight, barWidth, barHeight);\n\n        x += barWidth + 6;\n      }\n    }\n\n    return <AudioVisualizerWrapper ref={canvasRef} role=\"presentation\" />;\n  },\n);\n\nexport default AudioVisualizer;\n","import { styled } from \"src/styles/stitches.config\";\n\nexport const PlayerWrapper = styled(\"div\", {\n  position: \"relative\",\n  backgroundColor: \"$primaryAlt\",\n  display: \"flex\",\n  flexGrow: \"0\",\n  flexShrink: \"1\",\n  height: \"100%\",\n  zIndex: \"1\",\n\n  video: {\n    backgroundColor: \"transparent\",\n    objectFit: \"contain\",\n    width: \"100%\",\n    height: \"100%\",\n    position: \"relative\",\n    zIndex: \"1\",\n  },\n});\n","import { InternationalString } from \"@iiif/presentation-3\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport React from \"react\";\nimport { getLabel } from \"src/hooks/use-iiif\";\n\nexport interface TrackProps {\n  resource: LabeledIIIFExternalWebResource;\n  ignoreCaptionLabels: string[];\n}\n\nconst Track: React.FC<TrackProps> = ({ resource, ignoreCaptionLabels }) => {\n  const label = getLabel(resource.label as InternationalString, \"en\");\n\n  const isIgnored =\n    Array.isArray(label) &&\n    label.some((value: string) => ignoreCaptionLabels.includes(value));\n\n  if (isIgnored) return null;\n\n  return (\n    <track\n      key={resource.id}\n      src={resource.id as string}\n      label={Array.isArray(label) ? label[0] : label}\n      srcLang=\"en\"\n      data-testid=\"player-track\"\n    />\n  );\n};\n\nexport default Track;\n","export const hlsMimeTypes = [\n  // Apple santioned\n  \"application/vnd.apple.mpegurl\",\n  \"vnd.apple.mpegurl\",\n  // Apple sanctioned for backwards compatibility\n  \"audio/mpegurl\",\n  // Very common\n  \"audio/x-mpegurl\",\n  // Very common\n  \"application/x-mpegurl\",\n  // Included for completeness\n  \"video/x-mpegurl\",\n  \"video/mpegurl\",\n  \"application/mpegurl\",\n];\n","import { AnnotationNormalized, CanvasNormalized } from \"@iiif/presentation-3\";\nimport Hls, { HlsConfig } from \"hls.js\";\nimport React, { useEffect } from \"react\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\n\nimport { AnnotationResources } from \"src/types/annotations\";\nimport AudioVisualizer from \"src/components/Viewer/Player/AudioVisualizer\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport { PlayerWrapper } from \"src/components/Viewer/Player/Player.styled\";\nimport Track from \"src/components/Viewer/Player/Track\";\nimport { getPaintingResource } from \"src/hooks/use-iiif\";\nimport { hlsMimeTypes } from \"src/lib/hls\";\n\n// Set referrer header as a NU domain: ie. meadow.rdc-staging.library.northwestern.edu\n\ninterface PlayerProps {\n  allSources: LabeledIIIFExternalWebResource[];\n  annotationResources: AnnotationResources;\n  painting: LabeledIIIFExternalWebResource;\n}\n\nconst Player: React.FC<PlayerProps> = ({\n  allSources,\n  annotationResources,\n  painting,\n}) => {\n  const [currentTime, setCurrentTime] = React.useState<number>(0);\n  const [poster, setPoster] = React.useState<string | undefined>();\n  const playerRef = React.useRef<HTMLVideoElement>(null);\n  const isAudio = painting?.type === \"Sound\";\n\n  const viewerState: ViewerContextStore = useViewerState();\n  const { activeCanvas, configOptions, vault } = viewerState;\n\n  /**\n   * HLS.js binding for .m3u8 files\n   * STAGING and PRODUCTION environments only\n   */\n  useEffect(() => {\n    /**\n     * Check that IIIF content resource ID exists and\n     * we have a reffed <video> for attaching HLS\n     */\n    if (!painting.id || !playerRef.current) return;\n\n    if (playerRef?.current) {\n      const video: HTMLVideoElement = playerRef.current;\n      video.src = painting.id as string;\n      video.load();\n    }\n\n    /**\n     * Eject HLS attachment if file extension from\n     * the IIIF content resource ID is not .m3u8\n     * and format is not one of many m3u8 formats.\n     */\n    if (\n      painting.id.split(\".\").pop() !== \"m3u8\" &&\n      painting.format &&\n      !hlsMimeTypes.includes(painting.format)\n    )\n      return;\n\n    // Construct HLS.js config\n    const config = {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      xhrSetup: function (xhr, url) {\n        xhr.withCredentials = !!configOptions.withCredentials;\n      },\n    } as HlsConfig;\n\n    // Bind hls.js package to our <video /> element and then load the media source\n    const hls = new Hls(config);\n    hls.attachMedia(playerRef.current);\n    hls.on(Hls.Events.MEDIA_ATTACHED, function () {\n      hls.loadSource(painting.id as string);\n    });\n\n    // Handle errors\n    hls.on(Hls.Events.ERROR, function (event, data) {\n      if (data.fatal) {\n        switch (data.type) {\n          case Hls.ErrorTypes.NETWORK_ERROR:\n            // try to recover network error\n            console.error(\n              `fatal ${event} network error encountered, try to recover`,\n            );\n            hls.startLoad();\n            break;\n          case Hls.ErrorTypes.MEDIA_ERROR:\n            console.error(\n              `fatal ${event} media error encountered, try to recover`,\n            );\n            hls.recoverMediaError();\n            break;\n          default:\n            // cannot recover\n            hls.destroy();\n            break;\n        }\n      }\n    });\n\n    return () => {\n      if (hls && playerRef.current) {\n        const video: HTMLVideoElement = playerRef.current;\n        hls.detachMedia();\n        hls.destroy();\n        video.currentTime = 0;\n      }\n    };\n  }, [configOptions.withCredentials, painting.id]);\n\n  useEffect(() => {\n    const canvas: CanvasNormalized = vault.get(activeCanvas);\n    const accompanyingCanvas = canvas.accompanyingCanvas?.id\n      ? getPaintingResource(vault, canvas.accompanyingCanvas?.id)\n      : null;\n\n    const placeholderCanvas = canvas.placeholderCanvas?.id\n      ? getPaintingResource(vault, canvas.placeholderCanvas?.id)\n      : null;\n\n    const conflictingCanvas = !!(accompanyingCanvas && placeholderCanvas);\n\n    if (conflictingCanvas) {\n      currentTime === 0\n        ? setPoster(placeholderCanvas[0].id)\n        : setPoster(accompanyingCanvas[0].id);\n    } else {\n      if (accompanyingCanvas) setPoster(accompanyingCanvas[0].id);\n      if (placeholderCanvas) setPoster(placeholderCanvas[0].id);\n    }\n  }, [activeCanvas, currentTime, vault]);\n\n  useEffect(() => {\n    if (playerRef?.current) {\n      const video: HTMLVideoElement = playerRef.current;\n      video?.addEventListener(\"timeupdate\", () =>\n        setCurrentTime(video.currentTime),\n      );\n\n      return () => document.removeEventListener(\"timeupdate\", () => {});\n    }\n  }, []);\n\n  return (\n    <PlayerWrapper\n      css={{\n        backgroundColor: configOptions.canvasBackgroundColor,\n        maxHeight: configOptions.canvasHeight,\n        position: \"relative\",\n      }}\n      data-testid=\"player-wrapper\"\n      className=\"clover-viewer-player-wrapper\"\n    >\n      <video\n        id=\"clover-iiif-video\"\n        key={painting.id}\n        ref={playerRef}\n        controls\n        height={painting.height}\n        width={painting.width}\n        crossOrigin=\"anonymous\"\n        poster={poster}\n        style={{\n          maxHeight: configOptions.canvasHeight,\n          position: \"relative\",\n          zIndex: \"1\",\n        }}\n      >\n        {allSources.map((painting) => (\n          <source src={painting.id} type={painting.format} key={painting.id} />\n        ))}\n        {annotationResources?.length > 0 &&\n          annotationResources.map((annotationPage) => {\n            const annotationBodies: LabeledIIIFExternalWebResource[] = [];\n\n            annotationPage.items.forEach((annotation) => {\n              const annotationNormalized = vault.get(\n                annotation.id,\n              ) as AnnotationNormalized;\n\n              annotationNormalized.body.forEach((body) => {\n                const annotationBody = vault.get(\n                  body.id,\n                ) as LabeledIIIFExternalWebResource;\n                annotationBodies.push(annotationBody);\n              });\n            });\n\n            return annotationBodies.map((body) => {\n              return (\n                <Track\n                  resource={body}\n                  ignoreCaptionLabels={configOptions.ignoreCaptionLabels || []}\n                  key={body.id}\n                />\n              );\n            });\n          })}\n        Sorry, your browser doesn&apos;t support embedded videos.\n      </video>\n\n      {isAudio && <AudioVisualizer ref={playerRef} />}\n    </PlayerWrapper>\n  );\n};\n\nexport default Player;\n","import React from \"react\";\nimport { ToggleStyled } from \"./Painting.styled\";\n\ninterface ToggleProps {\n  handleToggle: () => void;\n  isInteractive: boolean;\n  isMedia: boolean;\n}\n\nconst CloseIcon = () => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-labelledby=\"close-svg-title\"\n      focusable=\"false\"\n      viewBox=\"0 0 512 512\"\n      role=\"img\"\n    >\n      <title id=\"close-svg-title\">close</title>\n      <path d=\"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z\" />\n    </svg>\n  );\n};\n\nconst OpenIcon = ({ isMedia }: { isMedia: boolean }) => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-labelledby=\"open-svg-title\"\n      focusable=\"false\"\n      viewBox=\"0 0 512 512\"\n      role=\"img\"\n    >\n      <title id=\"open-svg-title\">open</title>\n\n      {isMedia ? (\n        <path d=\"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z\" />\n      ) : (\n        <>\n          <path d=\"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z\" />\n          <path d=\"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z\" />\n        </>\n      )}\n    </svg>\n  );\n};\n\nconst Toggle: React.FC<ToggleProps> = ({\n  handleToggle,\n  isInteractive,\n  isMedia,\n}) => {\n  return (\n    <ToggleStyled\n      onClick={handleToggle}\n      isInteractive={isInteractive}\n      isMedia={isMedia}\n      data-testid=\"placeholder-toggle\"\n    >\n      {isInteractive ? <CloseIcon /> : <OpenIcon isMedia={isMedia} />}\n    </ToggleStyled>\n  );\n};\n\nexport default Toggle;\n","import { AnnotationNormalized, CanvasNormalized } from \"@iiif/presentation-3\";\nimport { PaintingCanvas, PaintingStyled } from \"./Painting.styled\";\nimport React, { useEffect } from \"react\";\nimport { Select, SelectOption } from \"src/components/UI/Select\";\nimport { useViewerDispatch, useViewerState } from \"src/context/viewer-context\";\n\nimport { AnnotationResources } from \"src/types/annotations\";\nimport ImageViewer from \"src/components/Image\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport PaintingPlaceholder from \"./Placeholder\";\nimport Player from \"src/components/Viewer/Player/Player\";\nimport Toggle from \"./Toggle\";\nimport {\n  addOverlaysToViewer,\n  removeOverlaysFromViewer,\n} from \"src/lib/openseadragon-helpers\";\nimport { hashCode } from \"src/lib/utils\";\n\ninterface PaintingProps {\n  activeCanvas: string;\n  annotationResources: AnnotationResources;\n  isMedia: boolean;\n  painting: LabeledIIIFExternalWebResource[];\n}\n\nconst Painting: React.FC<PaintingProps> = ({\n  activeCanvas,\n  annotationResources,\n  isMedia,\n  painting,\n}) => {\n  const [annotationIndex, setAnnotationIndex] = React.useState<number>(0);\n  const [isInteractive, setIsInteractive] = React.useState(false);\n  const {\n    configOptions,\n    customDisplays,\n    openSeadragonViewer,\n    vault,\n    viewerId,\n  } = useViewerState();\n  const dispatch: any = useViewerDispatch();\n\n  const normalizedCanvas: CanvasNormalized = vault.get(activeCanvas);\n  const placeholderCanvas = normalizedCanvas?.placeholderCanvas?.id;\n  const hasPlaceholder = Boolean(placeholderCanvas);\n  const hasChoice = Boolean(painting?.length > 1);\n  const showPlaceholder = placeholderCanvas && !isInteractive && !isMedia;\n  const instanceId = `${viewerId}-${hashCode(activeCanvas + annotationIndex)}`;\n\n  const handleToggle = () => setIsInteractive(!isInteractive);\n\n  const handleChoiceChange = (value) => {\n    const index = painting.findIndex((resource) => resource.id === value);\n    setAnnotationIndex(index);\n  };\n\n  /**\n   * Determine whether a custom display should be used for the current canvas.\n   */\n  const customDisplay = customDisplays.find((customDisplay) => {\n    let match = false;\n    const { canvasId, paintingFormat } = customDisplay.target;\n\n    if (Array.isArray(canvasId) && canvasId.length > 0) {\n      match = canvasId.includes(activeCanvas);\n    }\n\n    if (Array.isArray(paintingFormat) && paintingFormat.length > 0) {\n      const format = painting[annotationIndex]?.format || \"\";\n      match = Boolean(format && paintingFormat.includes(format));\n    }\n    return match;\n  });\n\n  /** Retrieve annotations from Vault */\n  const annotations: Array<AnnotationNormalized> = [];\n  annotationResources[0]?.items?.forEach((item) => {\n    const annotationResource = vault.get(item.id);\n    annotations.push(annotationResource as unknown as AnnotationNormalized);\n  });\n\n  /** Draw annotation overlays */\n  useEffect(() => {\n    if (\n      annotations &&\n      openSeadragonViewer &&\n      configOptions.annotationOverlays?.renderOverlays\n    ) {\n      removeOverlaysFromViewer(openSeadragonViewer, \"annotation-overlay\");\n      addOverlaysToViewer(\n        openSeadragonViewer,\n        normalizedCanvas,\n        configOptions.annotationOverlays,\n        annotations,\n        \"annotation-overlay\",\n      );\n    }\n  }, [normalizedCanvas, annotations, openSeadragonViewer, configOptions]);\n\n  /** Update OpenSeadragon Viewer in viewer context */\n  const handleOpenSeadragonCallback = (viewer) => {\n    // @ts-ignore\n    if (viewer && openSeadragonViewer?.id !== `openseadragon-${instanceId}`) {\n      dispatch({\n        type: \"updateOpenSeadragonViewer\",\n        openSeadragonViewer: viewer,\n      });\n    }\n  };\n\n  const CustomComponent = customDisplay?.display\n    ?.component as unknown as React.ElementType;\n\n  return (\n    <PaintingStyled className=\"clover-viewer-painting\">\n      <PaintingCanvas\n        style={{\n          backgroundColor: configOptions.canvasBackgroundColor,\n          height: \"100%\",\n        }}\n      >\n        {placeholderCanvas && !isMedia && (\n          <Toggle\n            handleToggle={handleToggle}\n            isInteractive={isInteractive}\n            isMedia={isMedia}\n          />\n        )}\n        {showPlaceholder && !isMedia && (\n          <PaintingPlaceholder\n            isMedia={isMedia}\n            label={normalizedCanvas?.label}\n            placeholderCanvas={placeholderCanvas}\n            setIsInteractive={setIsInteractive}\n          />\n        )}\n\n        {/* Standard Viewer displays */}\n        {!showPlaceholder &&\n          !customDisplay &&\n          (isMedia ? (\n            <Player\n              allSources={painting}\n              painting={painting[annotationIndex]}\n              annotationResources={annotationResources}\n            />\n          ) : (\n            painting && (\n              <ImageViewer\n                _cloverViewerHasPlaceholder={hasPlaceholder}\n                body={painting[annotationIndex]}\n                instanceId={instanceId}\n                key={instanceId}\n                openSeadragonCallback={handleOpenSeadragonCallback}\n                openSeadragonConfig={configOptions.openSeadragon}\n              />\n            )\n          ))}\n\n        {/* Custom display */}\n        {!showPlaceholder && CustomComponent && (\n          <CustomComponent\n            id={activeCanvas}\n            annotationBody={painting[annotationIndex]}\n            {...customDisplay?.display.componentProps}\n          />\n        )}\n      </PaintingCanvas>\n\n      {hasChoice && (\n        <Select\n          value={painting[annotationIndex]?.id}\n          onValueChange={handleChoiceChange}\n          maxHeight={\"200px\"}\n        >\n          {painting?.map((resource) => (\n            <SelectOption\n              value={resource?.id}\n              key={resource?.id}\n              label={resource?.label}\n            />\n          ))}\n        </Select>\n      )}\n    </PaintingStyled>\n  );\n};\n\nexport default Painting;\n","import {\n  Aside,\n  CollapsibleContent,\n  CollapsibleTrigger,\n  Content,\n  Main,\n  MediaWrapper,\n} from \"src/components/Viewer/Viewer/Viewer.styled\";\nimport {\n  Canvas,\n  IIIFExternalWebResource,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\n\nimport { AnnotationResources, AnnotationResource } from \"src/types/annotations\";\nimport InformationPanel from \"src/components/Viewer/InformationPanel/InformationPanel\";\nimport Media from \"src/components/Viewer/Media/Media\";\nimport Painting from \"../Painting/Painting\";\nimport React from \"react\";\nimport { useViewerState } from \"src/context/viewer-context\";\n\nexport interface ViewerContentProps {\n  activeCanvas: string;\n  annotationResources: AnnotationResources;\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationPageNormalized | undefined>\n  >;\n  contentSearchResource?: AnnotationResource;\n  painting: IIIFExternalWebResource[];\n  items: Canvas[];\n  isAudioVideo: boolean;\n}\n\nconst ViewerContent: React.FC<ViewerContentProps> = ({\n  activeCanvas,\n  annotationResources,\n  searchServiceUrl,\n  setContentSearchResource,\n  contentSearchResource,\n  isAudioVideo,\n  items,\n  painting,\n}) => {\n  const { isInformationOpen, showPageNavigation, configOptions } =\n    useViewerState();\n  const { informationPanel } = configOptions;\n\n  /**\n   * The information panel should be rendered if toggled true and if\n   * there is content (About or Supplementing Resources) to display.\n   */\n\n  const isAside = informationPanel?.renderAbout && isInformationOpen;\n\n  const isForcedAside =\n    (informationPanel?.renderAnnotation &&\n      annotationResources.length > 0 &&\n      !informationPanel.open) ||\n    contentSearchResource;\n\n  return (\n    <Content\n      className=\"clover-viewer-content\"\n      style={{ height: configOptions.canvasHeight ?? \"100%\" }}\n      data-testid=\"clover-viewer-content\"\n    >\n      <Main>\n        <Painting\n          activeCanvas={activeCanvas}\n          annotationResources={annotationResources}\n          isMedia={isAudioVideo}\n          painting={painting}\n        />\n\n        {isAside && (\n          <CollapsibleTrigger>\n            <span>{isInformationOpen ? \"View Items\" : \"More Information\"}</span>\n          </CollapsibleTrigger>\n        )}\n\n        {items.length > 1 && showPageNavigation && (\n          <MediaWrapper className=\"clover-viewer-media-wrapper\">\n            <Media items={items} activeItem={0} />\n          </MediaWrapper>\n        )}\n      </Main>\n      {(isAside || isForcedAside) && isInformationOpen && (\n        <Aside>\n          <CollapsibleContent>\n            <InformationPanel\n              activeCanvas={activeCanvas}\n              annotationResources={annotationResources}\n              searchServiceUrl={searchServiceUrl}\n              setContentSearchResource={setContentSearchResource}\n              contentSearchResource={contentSearchResource}\n            />\n          </CollapsibleContent>\n        </Aside>\n      )}\n    </Content>\n  );\n};\n\nexport default ViewerContent;\n","import { Popover } from \"src/components/UI\";\nimport { StyledSelect } from \"src/components/UI/Select/Select.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst IIIFBadgeButton = styled(Popover.Trigger, {\n  width: \"30px\",\n  padding: \"5px\",\n});\n\nconst PopoverContent = styled(Popover.Content, {\n  display: \"flex\",\n  flexDirection: \"column\",\n  fontSize: \"0.8333rem\",\n  border: \"none\",\n  boxShadow: \"2px 2px 5px #0003\",\n  zIndex: \"2\",\n\n  button: {\n    display: \"flex\",\n    textDecoration: \"none\",\n    marginBottom: \"0.5em\",\n    color: \"$accentAlt\",\n    cursor: \"pointer\",\n    background: \"$secondary\",\n    border: \"none\",\n\n    [\"&:last-child\"]: {\n      marginBottom: \"0\",\n    },\n  },\n});\n\nconst ManifestLabel = styled(\"span\", {\n  fontSize: \"1.33rem\",\n  alignSelf: \"flex-start\",\n  flexGrow: \"0\",\n  flexShrink: \"1\",\n  padding: \"1rem\",\n\n  \"@sm\": {\n    fontSize: \"1rem\",\n  },\n\n  \"&.visually-hidden\": {\n    position: \"absolute\",\n    width: \"1px\",\n    height: \"1px\",\n    padding: \"0\",\n    margin: \"-1px\",\n    overflow: \"hidden\",\n    clip: \"rect(0, 0, 0, 0)\",\n    whiteSpace: \"nowrap\",\n    border: \"0\",\n  },\n});\n\nconst Header = styled(\"header\", {\n  display: \"flex\",\n  backgroundColor: \"transparent !important\",\n  justifyContent: \"space-between\",\n  alignItems: \"flex-start\",\n  width: \"100%\",\n\n  [`> ${StyledSelect}`]: {\n    flexGrow: \"1\",\n    flexShrink: \"0\",\n  },\n\n  form: {\n    flexGrow: \"0\",\n    flexShrink: \"1\",\n  },\n});\n\nconst HeaderOptions = styled(\"div\", {\n  display: \"flex\",\n  alignItems: \"flex-end\",\n  justifyContent: \"flex-end\",\n  padding: \"1rem\",\n  flexShrink: \"0\",\n  flexGrow: \"1\",\n});\n\nexport {\n  Header,\n  HeaderOptions,\n  IIIFBadgeButton,\n  PopoverContent,\n  ManifestLabel,\n};\n","import { Select, SelectOption } from \"src/components/UI/Select\";\nimport { useViewerDispatch, useViewerState } from \"src/context/viewer-context\";\n\nimport { CollectionItems } from \"@iiif/presentation-3\";\nimport React from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nconst Collection: React.FC = () => {\n  const dispatch: any = useViewerDispatch();\n  const viewerState: any = useViewerState();\n\n  const { activeManifest, collection, configOptions, vault } = viewerState;\n  const maxHeight = configOptions?.canvasHeight;\n\n  const handleValueChange = (manifestId: string) => {\n    dispatch({\n      type: \"updateActiveManifest\",\n      manifestId: manifestId,\n    });\n    dispatch({\n      type: \"updateViewerId\",\n      viewerId: uuidv4(),\n    });\n  };\n\n  return (\n    <div style={{ margin: \"0.75rem\" }}>\n      <Select\n        label={collection.label}\n        maxHeight={maxHeight}\n        value={activeManifest}\n        onValueChange={handleValueChange}\n      >\n        {collection?.items?.map((item: CollectionItems) => (\n          <SelectOption\n            value={item.id}\n            key={item.id}\n            thumbnail={item?.thumbnail ? vault.get(item?.thumbnail) : undefined}\n            label={item.label}\n          />\n        ))}\n      </Select>\n    </div>\n  );\n};\n\nexport default Collection;\n","import { useCallback, useEffect, useState } from \"react\";\n\nexport type CopyStatus = undefined | \"copied\" | \"failed\";\n\nexport const useCopyToClipboard = (\n  text: string,\n  notifyTimeout = 2500,\n): [CopyStatus, () => void] => {\n  const [copyStatus, setCopyStatus] = useState<CopyStatus>();\n  const copy = useCallback(() => {\n    navigator.clipboard.writeText(text).then(\n      () => setCopyStatus(\"copied\"),\n      () => setCopyStatus(\"failed\"),\n    );\n  }, [text]);\n\n  useEffect(() => {\n    if (!copyStatus) {\n      return;\n    }\n\n    const timeoutId = setTimeout(() => setCopyStatus(undefined), notifyTimeout);\n\n    return () => clearTimeout(timeoutId);\n  }, [copyStatus]);\n\n  return [copyStatus, copy];\n};\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { useCopyToClipboard, CopyStatus } from \"src/hooks/useCopyToClipboard\";\n\nconst Status = styled(\"span\", {\n  display: \"flex\",\n  alignContent: \"center\",\n  alignItems: \"center\",\n  padding: \"0.125rem 0.25rem 0\",\n  marginTop: \"-0.125rem\",\n  marginLeft: \"0.5rem\",\n  backgroundColor: \"$accent\",\n  color: \"$secondary\",\n  borderRadius: \"3px\",\n  fontSize: \"0.6111rem\",\n  textTransform: \"uppercase\",\n  lineHeight: \"1em\",\n});\n\nconst CopyTextStatus: React.FC<{ status: CopyStatus }> = ({ status }) => {\n  if (!status) return null;\n\n  return <Status data-copy-status={status}>{status}</Status>;\n};\n\nexport const CopyText: React.FC<{ textPrompt: string; textToCopy: string }> = ({\n  textPrompt,\n  textToCopy,\n}) => {\n  const [copyStatus, copyText] = useCopyToClipboard(textToCopy);\n  return (\n    <button onClick={copyText}>\n      {textPrompt} <CopyTextStatus status={copyStatus} />\n    </button>\n  );\n};\n\nexport default CopyText;\n","import React from \"react\";\n\nconst IIIFBadge: React.FC = () => {\n  const red = \"#ed1d33\";\n  const blue = \"#2873ab\";\n\n  return (\n    <svg viewBox=\"0 0 493.35999 441.33334\" id=\"iiif-logo\" version=\"1.1\">\n      <title>IIIF Manifest Options</title>\n      <g transform=\"matrix(1.3333333,0,0,-1.3333333,0,441.33333)\">\n        <g transform=\"scale(0.1)\">\n          <path\n            style={{ fill: blue }}\n            d=\"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5\"\n          />\n          <path\n            style={{ fill: blue }}\n            d=\"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18\"\n          />\n          <path\n            style={{ fill: red }}\n            d=\"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5\"\n          />\n          <path\n            style={{ fill: red }}\n            d=\"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18\"\n          />\n          <path\n            style={{ fill: blue }}\n            d=\"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5\"\n          />\n          <path\n            style={{ fill: blue }}\n            d=\"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18\"\n          />\n          <path\n            style={{ fill: red }}\n            d=\"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n};\n\nexport default IIIFBadge;\n","import * as Switch from \"@radix-ui/react-switch\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledSwitch = styled(Switch.Root, {\n  all: \"unset\",\n  height: \"2rem\",\n  width: \"3.236rem\",\n  backgroundColor: \"#6663\",\n  borderRadius: \"9999px\",\n  position: \"relative\",\n  WebkitTapHighlightColor: \"transparent\",\n  cursor: \"pointer\",\n\n  \"&:focus\": {\n    boxShadow: `0 0 0 2px $secondaryAlt`,\n  },\n\n  '&[data-state=\"checked\"]': {\n    backgroundColor: \"$accent\",\n    boxShadow: `inset 2px 2px 5px #0003`,\n  },\n});\n\nconst StyledThumb = styled(Switch.Thumb, {\n  display: \"block\",\n  height: \"calc(2rem - 12px)\",\n  width: \"calc(2rem - 12px)\",\n  backgroundColor: \"$secondary\",\n  borderRadius: \"100%\",\n  boxShadow: `2px 2px 5px #0001`,\n  transition: \"$all\",\n  transform: \"translateX(6px)\",\n  willChange: \"transform\",\n\n  '&[data-state=\"checked\"]': {\n    transform: \"translateX(calc(1.236rem + 6px))\",\n  },\n});\n\nconst Label = styled(\"label\", {\n  fontSize: \"0.8333rem\",\n  fontWeight: \"400\",\n  lineHeight: \"1em\",\n  userSelect: \"none\",\n  cursor: \"pointer\",\n  paddingRight: \"0.618rem\",\n});\n\nconst StyledToggle = styled(\"form\", {\n  display: \"flex\",\n  flexShrink: \"0\",\n  flexGrow: \"1\",\n  alignItems: \"center\",\n  marginLeft: \"1.618rem\",\n});\n\nexport { Label, StyledSwitch, StyledThumb, StyledToggle };\n","import {\n  Label,\n  StyledSwitch,\n  StyledThumb,\n  StyledToggle,\n} from \"src/components/Viewer/Viewer/Toggle.styled\";\nimport React, { useEffect, useState } from \"react\";\nimport { useViewerDispatch, useViewerState } from \"src/context/viewer-context\";\n\nconst Toggle = () => {\n  const { configOptions } = useViewerState();\n  const dispatch: any = useViewerDispatch();\n\n  const [checked, setChecked] = useState(configOptions?.informationPanel?.open);\n  const toggleLabel =\n    configOptions?.informationPanel?.toggleLabel ?? \"More information\";\n\n  useEffect(() => {\n    dispatch({\n      type: \"updateInformationOpen\",\n      isInformationOpen: checked,\n    });\n  }, [checked, dispatch]);\n\n  return (\n    <StyledToggle>\n      <Label htmlFor=\"information-toggle\" css={checked ? { opacity: \"1\" } : {}}>\n        {toggleLabel}\n      </Label>\n      <StyledSwitch\n        checked={checked}\n        onCheckedChange={() => setChecked(!checked)}\n        id=\"information-toggle\"\n        aria-label=\"information panel toggle\"\n        name=\"toggled?\"\n      >\n        <StyledThumb />\n      </StyledSwitch>\n    </StyledToggle>\n  );\n};\n\nexport default Toggle;\n","import * as Switch from \"@radix-ui/react-switch\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledSwitch = styled(Switch.Root, {\n  all: \"unset\",\n  height: \"2rem\",\n  width: \"3.236rem\",\n  backgroundColor: \"#6663\",\n  borderRadius: \"9999px\",\n  position: \"relative\",\n  WebkitTapHighlightColor: \"transparent\",\n  cursor: \"pointer\",\n\n  \"&:focus\": {\n    boxShadow: `0 0 0 2px $secondaryAlt`,\n  },\n\n  '&[data-state=\"checked\"]': {\n    backgroundColor: \"$accent\",\n    boxShadow: `inset 2px 2px 5px #0003`,\n  },\n});\n\nconst StyledThumb = styled(Switch.Thumb, {\n  display: \"block\",\n  height: \"calc(2rem - 12px)\",\n  width: \"calc(2rem - 12px)\",\n  backgroundColor: \"$secondary\",\n  borderRadius: \"100%\",\n  boxShadow: `2px 2px 5px #0001`,\n  transition: \"$all\",\n  transform: \"translateX(6px)\",\n  willChange: \"transform\",\n\n  '&[data-state=\"checked\"]': {\n    transform: \"translateX(calc(1.236rem + 6px))\",\n  },\n});\n\nconst Label = styled(\"label\", {\n  fontSize: \"0.8333rem\",\n  fontWeight: \"400\",\n  lineHeight: \"1em\",\n  userSelect: \"none\",\n  cursor: \"pointer\",\n  paddingRight: \"0.618rem\",\n});\n\nconst StyledToggle = styled(\"form\", {\n  display: \"flex\",\n  flexShrink: \"0\",\n  flexGrow: \"1\",\n  alignItems: \"center\",\n  marginLeft: \"1.618rem\",\n});\n\nexport { Label, StyledSwitch, StyledThumb, StyledToggle };\n","import {\n  Label,\n  StyledSwitch,\n  StyledThumb,\n  StyledToggle,\n} from \"src/components/Viewer/Viewer/ShowPagesToggle.styled\";\nimport React, { useEffect, useState } from \"react\";\nimport { useViewerDispatch, useViewerState } from \"src/context/viewer-context\";\n\nconst Toggle = () => {\n  const { configOptions } = useViewerState();\n  const dispatch: any = useViewerDispatch();\n\n  const [checked, setChecked] = useState(configOptions?.pages?.show);\n  const toggleLabel = configOptions?.pages?.toggleLabel ?? \"Show pages\";\n\n  useEffect(() => {\n    dispatch({\n      type: \"updateShowPageNavigation\",\n      showPageNavigation: checked,\n    });\n  }, [checked, dispatch]);\n\n  return (\n    <StyledToggle>\n      <Label htmlFor=\"show-pages-toggle\" css={checked ? { opacity: \"1\" } : {}}>\n        {toggleLabel}\n      </Label>\n      <StyledSwitch\n        checked={checked}\n        onCheckedChange={() => setChecked(!checked)}\n        id=\"show-pages-toggle\"\n        aria-label=\"show pages toggle\"\n        name=\"toggled?\"\n      >\n        <StyledThumb />\n      </StyledSwitch>\n    </StyledToggle>\n  );\n};\n\nexport default Toggle;\n","import { Popover } from \"src/components/UI\";\nimport { PopoverContent } from \"./Header.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst DownloadButton = styled(Popover.Trigger, {\n  width: \"30px\",\n  padding: \"5px\",\n});\n\nconst DownloadContent = styled(PopoverContent, {\n  h3: {\n    color: \"$primaryAlt\",\n    fontSize: \"$2\",\n    fontWeight: \"700\",\n    margin: \"$2 0\",\n  },\n\n  button: {},\n\n  \"& ul li\": {\n    marginBottom: \"$1\",\n  },\n});\n\nexport { DownloadButton, DownloadContent };\n","import { NormalizedEntity } from \"@iiif/vault/*\";\nimport { useViewerState } from \"src/context/viewer-context\";\n\ndeclare type ExtendedNormalizedEntity = NormalizedEntity & { id: string };\n\nexport default function useGetVaultEntityId(id?: string): string | undefined {\n  const { vault } = useViewerState();\n\n  try {\n    const entity: ExtendedNormalizedEntity | undefined | \"\" =\n      id && vault.get(id);\n\n    if (!entity) throw new Error(`Vault entity ${id} not found.`);\n\n    /**\n     * Vault seems to handle storage `id` and `@id` differently based on the entity type.\n     * Ex: Manifest level rendering items use `id` while Canvas level rendering items use `@id`.\n     * The following logic returns `@id` if it exists, otherwise falls back to `id`.\n     */\n    return entity?.[\"@id\"] || entity?.id;\n  } catch (error) {\n    console.error(error);\n    return id;\n  }\n}\n","import { Canvas, Manifest } from \"@iiif/presentation-3\";\nimport { useEffect, useState } from \"react\";\n\nimport { RenderingItem } from \"src/types/presentation-3\";\nimport { useViewerState } from \"src/context/viewer-context\";\n\nfunction extractRenderingContent(\n  rendering: Manifest[\"rendering\"] | Canvas[\"rendering\"],\n  vault: any,\n) {\n  const content: RenderingItem[] = [];\n  if (!rendering) return content;\n\n  for (const item of rendering) {\n    if (item.id) {\n      const itemContent = vault.get(item.id) as RenderingItem;\n      if (itemContent) {\n        content.push(itemContent);\n      }\n    }\n  }\n\n  return content;\n}\n\ntype UseRenderingReturn = {\n  root: RenderingItem[];\n  canvas: RenderingItem[];\n};\n\nexport default function useRendering() {\n  const { activeCanvas, activeManifest, vault } = useViewerState();\n  const [rendering, setRendering] = useState<UseRenderingReturn>({\n    root: [],\n    canvas: [],\n  });\n\n  useEffect(() => {\n    const manifest = vault.get(activeManifest) as Manifest;\n    const activeCanvasEntity = vault.get(activeCanvas) as Canvas;\n\n    const rootRendering = manifest?.rendering;\n    const activeCanvasRendering = activeCanvasEntity?.rendering;\n\n    const rootContent = extractRenderingContent(rootRendering, vault);\n    const canvasContent = extractRenderingContent(activeCanvasRendering, vault);\n\n    setRendering({\n      root: rootContent,\n      canvas: canvasContent,\n    });\n  }, [activeCanvas, activeManifest, vault]);\n\n  return { ...rendering };\n}\n","import { RenderingItem } from \"src/types/presentation-3\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport useGetVaultEntityId from \"src/hooks/useGetVaultEntityId\";\nimport useRendering from \"src/hooks/use-iiif/useRendering\";\n\ntype DownloadItem = {\n  format?: string;\n  id?: string;\n  label: string;\n};\n\nfunction prepareDownloadLinks(\n  items: RenderingItem[],\n  defaultLabel: string,\n): DownloadItem[] {\n  return items.map(({ format, id, label }) => {\n    const resourceId = useGetVaultEntityId(id);\n    return {\n      format,\n      id: resourceId,\n      label: getLabelAsString(label) || defaultLabel,\n    };\n  });\n}\n\nexport default function useViewerDownload() {\n  const rendering = useRendering();\n\n  const allPages = prepareDownloadLinks(\n    rendering?.root || [],\n    \"Root Rendering Label\",\n  );\n\n  const individualPages = prepareDownloadLinks(\n    rendering?.canvas || [],\n    \"Canvas Rendering Label\",\n  );\n\n  return {\n    allPages,\n    individualPages,\n  };\n}\n","import {\n  DownloadButton,\n  DownloadContent,\n} from \"src/components/Viewer/Viewer/Download.styled\";\n\nimport { Icon } from \"src/components/UI/Icon/Icon\";\nimport { Popover } from \"src/components/UI\";\nimport React from \"react\";\nimport { RenderingItem } from \"src/types/presentation-3\";\nimport useViewerDownload from \"src/hooks/useViewerDownload\";\n\nconst ViewerDownload = () => {\n  const { allPages, individualPages } = useViewerDownload();\n  const showDownloadButton = allPages.length > 0 || individualPages.length > 0;\n\n  const handleDownloadClick = (id: RenderingItem[\"id\"]) => {\n    window.open(id, \"_blank\");\n  };\n\n  if (!showDownloadButton) {\n    return null;\n  }\n\n  return (\n    <Popover>\n      <DownloadButton data-testid=\"download-button\">\n        <Icon>\n          <Icon.Download />\n        </Icon>\n      </DownloadButton>\n      <DownloadContent data-testid=\"download-content\">\n        {individualPages.length > 0 && (\n          <>\n            <h3>Individual Pages</h3>\n            <ul>\n              {individualPages.map(({ format, id, label }) => (\n                <li key={label}>\n                  <button onClick={() => handleDownloadClick(id)}>\n                    {label} ({format})\n                  </button>\n                </li>\n              ))}\n            </ul>\n          </>\n        )}\n\n        {allPages.length > 0 && (\n          <>\n            <h3>All Pages</h3>\n            <ul>\n              {allPages.map(({ format, id, label }) => (\n                <li key={label}>\n                  <button onClick={() => handleDownloadClick(id)}>\n                    {label} ({format})\n                  </button>\n                </li>\n              ))}\n            </ul>\n          </>\n        )}\n      </DownloadContent>\n    </Popover>\n  );\n};\n\nexport default ViewerDownload;\n","import { useEffect, useState } from \"react\";\n\nexport const useMediaQuery = (mediaQuery: string) => {\n  const match = () => {\n    if (!window.matchMedia) {\n      return false;\n    }\n    return window.matchMedia(mediaQuery).matches;\n  };\n\n  const [isMatch, setIsMatch] = useState<boolean>(match);\n\n  useEffect(() => {\n    const handler = () => setIsMatch(match);\n    window.addEventListener(\"resize\", handler);\n    return () => window.removeEventListener(\"resize\", handler);\n  });\n\n  return isMatch;\n};\n","import {\n  Header,\n  HeaderOptions,\n  IIIFBadgeButton,\n  ManifestLabel,\n  PopoverContent,\n} from \"./Header.styled\";\nimport {\n  ViewerContextStore,\n  useViewerDispatch,\n  useViewerState,\n} from \"src/context/viewer-context\";\n\nimport Collection from \"src/components/Viewer/Collection/Collection\";\nimport CopyText from \"src/components/Viewer/CopyText\";\nimport IIIFBadge from \"src/components/Viewer/Viewer/IIIFBadge\";\nimport { InternationalString, ManifestNormalized } from \"@iiif/presentation-3\";\nimport { Label } from \"src/components/Primitives\";\nimport { Popover } from \"src/components/UI\";\nimport React, { useEffect, useState } from \"react\";\nimport Toggle from \"./Toggle\";\nimport ShowPagesToggle from \"./ShowPagesToggle\";\nimport ViewerDownload from \"./Download\";\nimport { media } from \"src/styles/stitches.config\";\nimport { useMediaQuery } from \"src/hooks/useMediaQuery\";\n\ninterface Props {\n  manifest: ManifestNormalized;\n  manifestId: string;\n  manifestLabel: InternationalString;\n}\n\nconst ViewerHeader: React.FC<Props> = ({\n  manifest,\n  manifestId,\n  manifestLabel,\n}) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { collection, configOptions } = viewerState;\n  const dispatch: any = useViewerDispatch();\n\n  const [activeIndex, setActiveIndex] = useState<number>(0);\n\n  useEffect(() => {\n    setActiveIndex(0);\n  }, []);\n\n  const {\n    informationPanel,\n    showDownload,\n    showIIIFBadge,\n    showTitle,\n    headerNavigation,\n  } = configOptions;\n\n  /**\n   * Determine if header options should be rendered.\n   */\n  const hasOptions =\n    showDownload || showIIIFBadge || informationPanel?.renderToggle;\n  const isSmallViewport = useMediaQuery(media.sm);\n\n  return (\n    <Header className=\"clover-viewer-header\">\n      {collection?.items ? (\n        <Collection />\n      ) : (\n        <ManifestLabel className={!showTitle ? \"visually-hidden\" : \"\"}>\n          {showTitle && <Label label={manifestLabel} className=\"label\" />}\n          {headerNavigation && (\n            <span\n              className=\"headerNavigation\"\n              dangerouslySetInnerHTML={{ __html: headerNavigation }}\n            ></span>\n          )}\n\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              if (!manifest.items[activeIndex - 1]) {\n                return;\n              }\n              const prevId = manifest.items[activeIndex - 1].id;\n              setActiveIndex(activeIndex - 1);\n              dispatch({\n                type: \"updateActiveCanvas\",\n                canvasId: prevId,\n              });\n            }}\n          >\n            Previous page\n          </button>\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              if (!manifest.items[activeIndex + 1]) {\n                return;\n              }\n              const nextId = manifest.items[activeIndex + 1].id;\n              setActiveIndex(activeIndex + 1);\n              dispatch({\n                type: \"updateActiveCanvas\",\n                canvasId: nextId,\n              });\n            }}\n          >\n            Next page\n          </button>\n        </ManifestLabel>\n      )}\n      {hasOptions && (\n        <HeaderOptions>\n          {showDownload && <ViewerDownload />}\n          {showIIIFBadge && (\n            <Popover>\n              <IIIFBadgeButton>\n                <IIIFBadge />\n              </IIIFBadgeButton>\n              <PopoverContent>\n                {collection?.items && (\n                  <button\n                    onClick={(e) => {\n                      e.preventDefault();\n                      window.open(collection.id, \"_blank\");\n                    }}\n                  >\n                    View Collection\n                  </button>\n                )}\n                <button\n                  onClick={(e) => {\n                    e.preventDefault();\n                    window.open(manifestId, \"_blank\");\n                  }}\n                >\n                  View Manifest\n                </button>{\" \"}\n                {collection?.items && (\n                  <CopyText\n                    textPrompt=\"Copy Collection URL\"\n                    textToCopy={collection.id}\n                  />\n                )}\n                <CopyText\n                  textPrompt=\"Copy Manifest URL\"\n                  textToCopy={manifestId}\n                />\n              </PopoverContent>\n            </Popover>\n          )}\n          {informationPanel?.renderToggle && !isSmallViewport && <Toggle />}\n          <ShowPagesToggle />\n        </HeaderOptions>\n      )}\n    </Header>\n  );\n};\n\nexport default ViewerHeader;\n","import { useEffect, useLayoutEffect, useState } from \"react\";\n\ntype ReturnType = [boolean, (locked: boolean) => void];\n\nexport const useBodyLocked = (initialLocked = false): ReturnType => {\n  const [locked, setLocked] = useState(initialLocked);\n\n  useLayoutEffect(() => {\n    if (!locked) {\n      return;\n    }\n\n    const originalOverflow = document.documentElement.style.overflow;\n\n    document.documentElement.style.overflow = \"hidden\";\n\n    return () => {\n      document.documentElement.style.overflow = originalOverflow;\n    };\n  }, [locked]);\n\n  useEffect(() => {\n    if (locked !== initialLocked) {\n      setLocked(initialLocked);\n    }\n  }, [initialLocked]);\n\n  return [locked, setLocked];\n};\n","import * as Collapsible from \"@radix-ui/react-collapsible\";\n\nimport {\n  ExternalResourceTypes,\n  InternationalString,\n  ManifestNormalized,\n  CanvasNormalized,\n} from \"@iiif/presentation-3\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport {\n  ViewerContextStore,\n  useViewerDispatch,\n  useViewerState,\n} from \"src/context/viewer-context\";\nimport {\n  getAnnotationResources,\n  getPaintingResource,\n  getContentSearchResources,\n} from \"src/hooks/use-iiif\";\nimport {\n  addContentSearchOverlays,\n  removeOverlaysFromViewer,\n} from \"src/lib/openseadragon-helpers\";\n\nimport { AnnotationResources, AnnotationResource } from \"src/types/annotations\";\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport ErrorFallback from \"src/components/UI/ErrorFallback/ErrorFallback\";\nimport { IIIFExternalWebResource } from \"@iiif/presentation-3\";\nimport ViewerContent from \"src/components/Viewer/Viewer/Content\";\nimport ViewerHeader from \"src/components/Viewer/Viewer/Header\";\nimport { Wrapper } from \"src/components/Viewer/Viewer/Viewer.styled\";\nimport { media } from \"src/styles/stitches.config\";\nimport { useBodyLocked } from \"src/hooks/useBodyLocked\";\nimport { useMediaQuery } from \"src/hooks/useMediaQuery\";\nimport { ContentSearchQuery } from \"src/types/annotations\";\n\ninterface ViewerProps {\n  manifest: ManifestNormalized;\n  theme?: unknown;\n  iiifContentSearchQuery?: ContentSearchQuery;\n}\n\nconst Viewer: React.FC<ViewerProps> = ({\n  manifest,\n  theme,\n  iiifContentSearchQuery,\n}) => {\n  /**\n   * Viewer State\n   */\n  const viewerState: ViewerContextStore = useViewerState();\n  const viewerDispatch: any = useViewerDispatch();\n  const {\n    activeCanvas,\n    isInformationOpen,\n    vault,\n    contentSearchVault,\n    configOptions,\n    openSeadragonViewer,\n  } = viewerState;\n\n  const absoluteCanvasHeights = [\"100%\", \"auto\"];\n  const isAbsolutePosition =\n    configOptions?.canvasHeight &&\n    absoluteCanvasHeights.includes(configOptions?.canvasHeight);\n\n  /**\n   * Local state\n   */\n  const [isInformationPanel, setIsInformationPanel] = useState<boolean>(false);\n  const [isAudioVideo, setIsAudioVideo] = useState(false);\n  const [painting, setPainting] = useState<IIIFExternalWebResource[]>([]);\n  const [annotationResources, setAnnotationResources] =\n    useState<AnnotationResources>([]);\n  const [contentSearchResource, setContentSearchResource] =\n    useState<AnnotationResource>();\n\n  const [isBodyLocked, setIsBodyLocked] = useBodyLocked(false);\n  const isSmallViewport = useMediaQuery(media.sm);\n  const [searchServiceUrl, setSearchServiceUrl] = useState();\n\n  const setInformationOpen = useCallback(\n    (open: boolean) => {\n      viewerDispatch({\n        type: \"updateInformationOpen\",\n        isInformationOpen: open,\n      });\n    },\n    [viewerDispatch],\n  );\n\n  useEffect(() => {\n    if (configOptions?.informationPanel?.open) {\n      setInformationOpen(!isSmallViewport);\n    }\n  }, [\n    isSmallViewport,\n    configOptions?.informationPanel?.open,\n    setInformationOpen,\n  ]);\n\n  useEffect(() => {\n    if (!isSmallViewport) {\n      setIsBodyLocked(false);\n      return;\n    }\n    setIsBodyLocked(isInformationOpen);\n  }, [isInformationOpen, isSmallViewport, setIsBodyLocked]);\n\n  useEffect(() => {\n    const painting = getPaintingResource(vault, activeCanvas);\n\n    if (painting) {\n      setIsAudioVideo(\n        [\"Sound\", \"Video\"].indexOf(painting[0].type as ExternalResourceTypes) >\n          -1\n          ? true\n          : false,\n      );\n      setPainting(painting);\n    }\n\n    const resources = getAnnotationResources(vault, activeCanvas);\n\n    if (resources.length > 0) {\n      viewerDispatch({\n        type: \"updateInformationOpen\",\n        isInformationOpen: true,\n      });\n    }\n\n    setAnnotationResources(resources);\n    setIsInformationPanel(resources.length !== 0);\n  }, [activeCanvas, vault, viewerDispatch]);\n\n  const hasSearchService = manifest.service.some(\n    (service: any) => service.type === \"SearchService2\",\n  );\n\n  // check if search service exists in the manifest\n  useEffect(() => {\n    if (hasSearchService) {\n      const searchService: any = manifest.service.find(\n        (service: any) => service.type === \"SearchService2\",\n      );\n      if (searchService) {\n        setSearchServiceUrl(searchService.id);\n      }\n    }\n  }, [manifest, hasSearchService]);\n\n  // make request to content search service using iiifContentSearchQuery prop\n  useEffect(() => {\n    if (!searchServiceUrl) return;\n    if (configOptions.informationPanel?.renderContentSearch === false) return;\n\n    getContentSearchResources(\n      contentSearchVault,\n      searchServiceUrl,\n      configOptions.localeText?.contentSearch?.tabLabel as string,\n      iiifContentSearchQuery,\n    ).then((contentSearch) => {\n      setContentSearchResource(contentSearch);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchServiceUrl]);\n\n  // add overlays for content search\n  useEffect(() => {\n    if (!openSeadragonViewer) return;\n    if (!contentSearchResource) return;\n\n    const canvas: CanvasNormalized = vault.get({\n      id: activeCanvas,\n      type: \"Canvas\",\n    });\n\n    removeOverlaysFromViewer(openSeadragonViewer, \"content-search-overlay\");\n    addContentSearchOverlays(\n      contentSearchVault,\n      contentSearchResource,\n      openSeadragonViewer,\n      canvas,\n      configOptions,\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [openSeadragonViewer, contentSearchResource]);\n\n  return (\n    <ErrorBoundary FallbackComponent={ErrorFallback}>\n      <Wrapper\n        className={`${theme} clover-viewer`}\n        css={{ background: configOptions?.background }}\n        data-body-locked={isBodyLocked}\n        data-absolute-position={isAbsolutePosition}\n        data-information-panel={isInformationPanel}\n        data-information-panel-open={isInformationOpen}\n      >\n        <Collapsible.Root\n          open={isInformationOpen}\n          onOpenChange={setInformationOpen}\n        >\n          <ViewerHeader\n            manifest={manifest}\n            manifestLabel={manifest.label as InternationalString}\n            manifestId={manifest.id}\n          />\n          <ViewerContent\n            activeCanvas={activeCanvas}\n            painting={painting}\n            annotationResources={annotationResources}\n            searchServiceUrl={searchServiceUrl}\n            setContentSearchResource={setContentSearchResource}\n            contentSearchResource={contentSearchResource}\n            items={manifest.items}\n            isAudioVideo={isAudioVideo}\n          />\n        </Collapsible.Root>\n      </Wrapper>\n    </ErrorBoundary>\n  );\n};\n\nexport default Viewer;\n","import { IncomingHttpHeaders } from \"http\";\n\nexport interface RequestOptions {\n  ignoreCache?: boolean;\n  headers?: IncomingHttpHeaders;\n  timeout?: number;\n  withCredentials: boolean;\n}\n\nexport const DEFAULT_REQUEST_OPTIONS = {\n  ignoreCache: false,\n  headers: {\n    Accept: \"application/json, text/javascript, text/plain\",\n  },\n  timeout: 5000,\n  withCredentials: false,\n};\n\nexport interface RequestResult {\n  ok: boolean;\n  status: number;\n  statusText: string;\n  data: string;\n  json: <T>() => T;\n  headers: string;\n}\n\nfunction parseXHRResult(xhr: XMLHttpRequest): RequestResult {\n  return {\n    ok: xhr.status >= 200 && xhr.status < 300,\n    status: xhr.status,\n    statusText: xhr.statusText,\n    headers: xhr.getAllResponseHeaders(),\n    data: xhr.responseText,\n    json: <T>() => JSON.parse(xhr.responseText) as T,\n  };\n}\n\nfunction errorResponse(\n  xhr: XMLHttpRequest,\n  message: string | null = null,\n): RequestResult {\n  return {\n    ok: false,\n    status: xhr.status,\n    statusText: xhr.statusText,\n    headers: xhr.getAllResponseHeaders(),\n    data: message || xhr.statusText,\n    json: <T>() => JSON.parse(message || xhr.statusText) as T,\n  };\n}\n\nexport function getRequest(\n  url: string,\n  options: RequestOptions = DEFAULT_REQUEST_OPTIONS,\n) {\n  const headers = options.headers || DEFAULT_REQUEST_OPTIONS.headers;\n\n  return new Promise<RequestResult>((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"get\", url);\n    xhr.withCredentials = options.withCredentials;\n\n    if (headers) {\n      Object.keys(headers).forEach((key) =>\n        xhr.setRequestHeader(key, headers[key]),\n      );\n    }\n\n    xhr.onload = () => {\n      resolve(parseXHRResult(xhr));\n    };\n\n    xhr.onerror = () => {\n      reject(errorResponse(xhr, `Failed to make request.`));\n    };\n\n    xhr.ontimeout = () => {\n      reject(errorResponse(xhr, `Request took longer than expected.`));\n    };\n\n    xhr.send();\n  });\n}\n","import { CollectionNormalized, ManifestNormalized } from \"@iiif/presentation-3\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  type ViewerConfigOptions,\n  ViewerProvider,\n  defaultState,\n  expandAutoScrollOptions,\n  useViewerDispatch,\n  useViewerState,\n  CustomDisplay,\n  PluginConfig,\n} from \"src/context/viewer-context\";\n\nimport { Vault } from \"@iiif/vault\";\nimport Viewer from \"src/components/Viewer/Viewer/Viewer\";\nimport { createTheme } from \"@stitches/react\";\nimport { getRequest } from \"src/lib/xhr\";\nimport {\n  decodeContentStateContainerURI,\n  getActiveCanvas,\n  getActiveManifest,\n} from \"src/lib/iiif\";\nimport { ContentSearchQuery } from \"src/types/annotations\";\n\nexport interface CloverViewerProps {\n  canvasIdCallback?: (arg0: string) => void;\n  customDisplays?: Array<CustomDisplay>;\n  plugins?: Array<PluginConfig>;\n  customTheme?: any;\n  iiifContent: string;\n  id?: string;\n  manifestId?: string;\n  options?: ViewerConfigOptions;\n  iiifContentSearchQuery?: ContentSearchQuery;\n}\n\nconst CloverViewer: React.FC<CloverViewerProps> = ({\n  canvasIdCallback = () => {},\n  customDisplays = [],\n  plugins = [],\n  customTheme,\n  iiifContent,\n  id,\n  manifestId,\n  options,\n  iiifContentSearchQuery,\n}) => {\n  /**\n   * Legacy `id` and `manifestId` prop support.\n   * If an id is passed, use that as the iiifResource. Otherwise,\n   * use the manifestId. If neither are passed, use the iiifContent\n   * prop.\n   */\n  let iiifResource = iiifContent;\n  if (id) iiifResource = id;\n  if (manifestId) iiifResource = manifestId;\n\n  const autoScrollOptions = expandAutoScrollOptions(\n    options?.informationPanel?.vtt?.autoScroll,\n  );\n\n  return (\n    <ViewerProvider\n      initialState={{\n        ...defaultState,\n        customDisplays,\n        plugins,\n        isAutoScrollEnabled: autoScrollOptions.enabled,\n        isInformationOpen: Boolean(options?.informationPanel?.open),\n        showPageNavigation: true,\n        vault: new Vault({\n          customFetcher: (url: string) =>\n            getRequest(url, {\n              withCredentials: options?.withCredentials as boolean,\n              headers: options?.requestHeaders,\n            }).then((response) => JSON.parse(response.data)),\n        }),\n      }}\n    >\n      <RenderViewer\n        iiifContent={iiifResource}\n        canvasIdCallback={canvasIdCallback}\n        customTheme={customTheme}\n        options={options}\n        iiifContentSearchQuery={iiifContentSearchQuery}\n      />\n    </ViewerProvider>\n  );\n};\n\nconst RenderViewer: React.FC<CloverViewerProps> = ({\n  canvasIdCallback,\n  customTheme,\n  iiifContent,\n  options,\n  iiifContentSearchQuery,\n}) => {\n  const dispatch: any = useViewerDispatch();\n\n  /**\n   * Retrieve state set by the wrapping <ViewerProvider/> and make\n   * the normalized manifest available from @iiif/vault.\n   */\n  const store = useViewerState();\n  const { activeCanvas, activeManifest, isLoaded, vault } = store;\n  const [iiifResource, setIiifResource] = useState<\n    CollectionNormalized | ManifestNormalized\n  >();\n  const [manifest, setManifest] = useState<ManifestNormalized>();\n\n  /**\n   * Overrides the baseline stitches theme when set.\n   */\n  let theme = {};\n  if (customTheme) theme = createTheme(\"custom\", customTheme);\n\n  /**\n   * On change, pass the activeCanvas up to the wrapping `<App/>`\n   * component to be handed off to a consuming application.\n   */\n  useEffect(() => {\n    if (canvasIdCallback) canvasIdCallback(activeCanvas);\n  }, [activeCanvas, canvasIdCallback]);\n\n  useEffect(() => {\n    if (activeManifest)\n      vault\n        .loadManifest(activeManifest)\n        .then((data: ManifestNormalized) => {\n          setManifest(data);\n          dispatch({\n            type: \"updateActiveCanvas\",\n            canvasId: getActiveCanvas(iiifContent, data),\n          });\n        })\n        .catch((error: Error) => {\n          console.error(`Manifest failed to load: ${error}`);\n        })\n        .finally(() => {\n          dispatch({\n            type: \"updateIsLoaded\",\n            isLoaded: true,\n          });\n        });\n  }, [iiifContent, activeManifest, dispatch, vault]);\n\n  useEffect(() => {\n    dispatch({\n      type: \"updateConfigOptions\",\n      configOptions: options,\n    });\n    const containerURI = decodeContentStateContainerURI(iiifContent);\n    vault\n      .load(containerURI)\n      .then((data: CollectionNormalized | ManifestNormalized) => {\n        setIiifResource(data);\n      })\n      .catch((error: Error) => {\n        console.error(\n          `The IIIF resource ${iiifContent} failed to load: ${error}`,\n        );\n      });\n  }, [dispatch, iiifContent, options, vault]);\n\n  useEffect(() => {\n    if (iiifResource?.type === \"Collection\") {\n      dispatch({\n        type: \"updateCollection\",\n        collection: iiifResource,\n      });\n\n      const manifestFromContentState = getActiveManifest(\n        iiifContent,\n        iiifResource,\n      );\n      if (manifestFromContentState) {\n        dispatch({\n          type: \"updateActiveManifest\",\n          manifestId: manifestFromContentState,\n        });\n      }\n    } else if (iiifResource?.type === \"Manifest\") {\n      dispatch({\n        type: \"updateActiveManifest\",\n        manifestId: iiifResource.id,\n      });\n    }\n  }, [dispatch, iiifContent, iiifResource]);\n\n  /**\n   * Render loading component while manifest is fetched and\n   * loaded into React.Context as `vault`. Upon completion\n   * (error or not) isLoaded will be set to true.\n   */\n  if (!isLoaded) return <>Loading</>;\n\n  /**\n   * If an error occurs during manifest fetch process used by\n   * @iiif/vault, vault will not return a manifest\n   * that is fully normalized, and be missing the items property.\n   * This being undefined signals that something went wrong and we\n   * will render a user-friendly error as a functional component.\n   */\n\n  if (!manifest || !manifest[\"items\"]) {\n    console.log(`The IIIF manifest ${iiifContent} failed to load.`);\n    return <></>;\n  }\n\n  /**\n   * If the manifest returned by @iiif/vault does not\n   * contain any canvases, then we'll show an error to the screen. This\n   * may be required if the viewer is rendered to preview manifests in\n   * repository administration views.\n   */\n  if (manifest[\"items\"].length === 0) {\n    console.log(`The IIIF manifest ${iiifContent} does not contain canvases.`);\n    return <></>;\n  }\n\n  /**\n   * Load specified page if initialPage option is set\n   * [Added by Whirl-i-Gig on 12 June 2024 for GRPL project]\n   */\n  const initialPage: number = options?.initialPage ?? 0;\n  if (\n    initialPage > 0 &&\n    manifest?.items &&\n    manifest.items[initialPage - 1] &&\n    activeCanvas !== manifest.items[initialPage - 1].id\n  ) {\n    dispatch({\n      type: \"updateActiveCanvas\",\n      canvasId: manifest.items[initialPage - 1].id,\n    });\n    if (options) {\n      options.initialPage = undefined;\n    }\n  }\n\n  /**\n   * If manifest is normalized by @iiif/vault, we know\n   * that the manifest data is retrievable via vault.get() and we\n   * will will set the activeCanvas to the first index and render the\n   * <Viewer/> component.\n   */\n  return (\n    <Viewer\n      manifest={manifest}\n      theme={theme}\n      key={manifest.id}\n      iiifContentSearchQuery={iiifContentSearchQuery}\n    />\n  );\n};\n\nexport default CloverViewer;\n"],"names":["cleanTime","standardNotation","array","hours","minutes","seconds","zeroPad","time","convertTime","duration","deepMerge","target","source","key","hashCode","s","a","b","getRealPropertyValue","obj","property","num","places","defaultAutoScrollSettings","defaultConfigOptions","expandAutoScrollOptions","value","result","validateAutoScrollSettings","behavior","block","validBehaviors","validPositions","expandedAutoScrollOptions","_b","_a","defaultState","Vault","uuidv4","ViewerStateContext","React","ViewerDispatchContext","viewerReducer","state","action","c","ViewerProvider","initialState","children","dispatch","useReducer","useViewerState","context","useViewerDispatch","getAnnotationResources","vault","activeCanvas","canvas","annotationPage","label","getContentSearchResources","contentSearchVault","searchUrl","tabLabel","searchQuery","url","getCanvasByCriteria","item","motivation","paintingType","entity","filterAnnotations","annotation","annotationBody","resource","annotationPageResources","annotations","getLabel","language","codes","getPaintingResource","id","canvasEntity","getThumbnail","width","height","candidates","canvasThumbnail","annotationThumbnail","$","OpenSeadragon","svgNS","Overlay","viewer","self","p","zoom","rotation","flipped","containerSizeX","scaleX","scaleY","node","handler","OsdSvgOverlay","parseAnnotationTarget","parsedTarget","parts","x","y","w","h","getInfoResponse","response","json","error","getImageServiceURI","service","imageService","imageServiceURI","parseIiifContent","iiifContent","resourceId","active","isURL","decodeContentState","decodeContentStateContainerURI","getActiveCanvas","manifest","canvases","getActiveManifest","collection","manifests","OpenSeadragonImageTypes","addOverlaysToViewer","configOptions","overlaySelector","scale","parsedAnnotationTarget","point","rect","svg","addRectangularOverlay","addSvgOverlay","createOpenSeadragonRect","zoomLevel","div","backgroundColor","opacity","borderType","borderColor","borderWidth","convertSVGStringToHTML","svgString","template","svgEl","child","svg_processChild","svg_handleTextNode","newElement","svg_handleElementNode","overlay","hasStrokeColor","hasStrokeWidth","hasFillColor","hasFillOpacity","index","element","parseImageBody","body","hasImageService","uri","imageType","parseSrc","src","isTiledImage","removeOverlaysFromViewer","elements","panToTarget","openSeadragonViewer","addContentSearchOverlays","contentSearch","hue","theme","media","styled","css","keyframes","createTheme","createStitches","ErrorFallbackStyled","Headline","ErrorBody","ErrorFallback","message","MediaWrapper","Content","Main","CollapsibleTrigger","Collapsible","CollapsibleContent","Aside","Wrapper","Tabs","List","Trigger","ScrollableComponent","handleScroll","className","Scroll","annotationItemRow","ButtonStyled","Group","Item","ItemHTMLWrapper","AnnotationItemPlainText","handleClick","AnnotationItemHTML","useWebVtt","addIdentifiersToParsedCues","cues","cue","identifier","createNestedCues","flat","nestedItems","stack","isChild","currentCue","orderCuesByTime","cue1","cue2","spin","RadioGroup","AutoScrollDisableTime","findScrollableParent","overflowY","Cue","start","end","isAutoScrollEnabled","isUserScrolling","autoScrollOptions","isActive","updateIsActive","useState","ref","useRef","video","useEffect","currentTime","withAutoScrollDisabled","func","parent","top","parentRect","MenuStyled","Menu","items","text","AnnotationItemVTT","vttUri","setCues","isNetworkError","setIsNetworkError","data","flatCues","parse","orderedCues","nestedCues","AnnotationItemImage","caption","imageUri","AnnotationItem","viewerState","annotationBodyFormat","annotationBodyValue","renderItemBody","ItemStyled","AnnotationPage","Container","ResultsHeader","ResultsFooter","ContentSearchItem","activeContentSearchTarget","setActiveContentSearchTarget","OSDImageLoaded","annotationTarget","annotationCanvas","_c","e","canvasId","targetJson","zoomedTo","ContentSearchPage","searchResultsLimit","zoomToFirst","searchText","formatAnnotationPage","groupedAnnotations","internationalLabel","renderSearchResults","i","renderMoreResultsMessage","moreCount","_d","FormStyled","SearchContent","searchServiceUrl","setContentSearchResource","setLoading","initialSearch","searchTerms","setSearchTerms","searchSubmitHandler","resources","handleChange","Form","ContentSearch","loading","ContentSearchForm","ContentSearchAnnotationPage","AboutContent","AboutStyled","getLabelEntries","lang","getLabelAsString","delimiter","entries","createMarkup","html","sanitizeHTML","sanitizeAttributes","props","remove","attributes","sanitizeHtml","StyledLabel","Label","as","useGetImageResource","size","region","StyledResource","ContentResource","mediaRef","contentResource","altAsLabel","alt","type","hls","Hls","event","playLoop","useCallback","startTime","loopTime","fragment","imgSrc","StyledHomepage","Homepage","homepage","PrimitivesContext","createContext","usePrimitivesContext","useContext","PrimitivesProvider","StyledMarkup","Markup","markup","MarkupWrapper","Value","StyledCustomValue","CustomValue","customValueContent","entry","cloneElement","Fragment","MetadataItem","dataAttribute","parseCustomContent","valueArray","customContent","matchingLabel","labelPattern","StyledMetadata","Metadata","metadata","customValue","StyledRendering","StyledWrapper","Rendering","rendering","StyledRequiredStatement","RequiredStatement","requiredStatement","StyledSeeAlso","SeeAlso","seeAlso","Summary","summary","Thumbnail","thumbnail","PropertiesHomepage","PropertiesId","htmlLabel","PropertiesMetadata","PropertiesRendering","PropertiesRequiredStatement","PropertiesRights","rights","PropertiesSeeAlso","PropertiesSummary","PropertiesThumbnail","About","activeManifest","setManifest","setHomepage","setSeeAlso","setRendering","setThumbnail","Rights","Id","setupPlugins","plugins","pluginsWithInfoPanel","plugin","UserScrollTimeout","InformationPanel","annotationResources","contentSearchResource","isAutoScrolling","informationPanel","informationPanelCounts","activeResource","setActiveResource","renderAbout","renderAnnotation","renderContentSearch","renderPluginInformationPanel","PluginInformationPanelComponent","validActiveResource","timeout","handleValueChange","l","lbl","Information","Input","Button","Direction","useKeyPress","onKeyup","PreviousIcon","NextIcon","CloseIcon","SearchIcon","Controls","handleCanvasToggle","handleFilter","activeIndex","canvasLength","toggleFilter","setToggleFilter","isNextDisabled","setIsNextDisabled","isPreviousDisabled","setIsPreviousDisabled","handleFilterToggle","prevToggleFilter","handleFilterChange","Add","Audio","Close","Download","Image","Video","StyledIcon","Title","Icon","slideDown","slideUp","StyledArrow","Popover","StyledClose","StyledContent","StyledTrigger","StyledPopover","Tag","Type","Spacer","Duration","IconPath","canvasIndex","getResourceType","Media","filter","setFilter","mediaItems","setMediaItems","setActiveIndex","scrollRef","entities","leftPos","step","PlaceholderStyled","ToggleStyled","PaintingStyled","PaintingCanvas","StyledSelectIcon","StyledSelectButton","Select","StyledSelectContent","StyledSelectItem","StyledSelectLabel","StyledSelect","SelectIcon","direction","title","CaretUp","CaretDown","maxHeight","onValueChange","SelectValue","SelectPortal","SelectScrollUpButton","SelectViewport","SelectGroup","SelectScrollDownButton","SelectOption","SelectItemText","SelectItemIndicator","Navigator","Viewport","dataButton","ZoomIn","ZoomOut","ZoomFullScreen","Reset","Rotate","_cloverViewerHasPlaceholder","config","renderPlugins","PluginComponent","OSD","ariaLabel","openSeadragonCallback","osdUri","setOsdUri","openSeadragon","setOpenSeadragon","initializeOSD","tileSource","defaultOpenSeadragonConfiguration","openSeadragonInstance","CloverImage","instanceId","openSeadragonConfig","instance","defaultOpenSeadragonConfig","ErrorBoundary","PaintingPlaceholder","isMedia","placeholderCanvas","setIsInteractive","painting","placeholder","labelAsArray","AudioVisualizerWrapper","AudioVisualizer","_props","canvasRef","audioVisualizer","analyser","ctx","bufferLength","dataArray","renderFrame","barWidth","barHeight","PlayerWrapper","Track","ignoreCaptionLabels","hlsMimeTypes","Player","allSources","setCurrentTime","poster","setPoster","playerRef","isAudio","xhr","accompanyingCanvas","annotationBodies","OpenIcon","Toggle","handleToggle","isInteractive","Painting","annotationIndex","setAnnotationIndex","customDisplays","viewerId","normalizedCanvas","hasPlaceholder","hasChoice","showPlaceholder","handleChoiceChange","customDisplay","match","paintingFormat","format","annotationResource","handleOpenSeadragonCallback","CustomComponent","ImageViewer","_e","ViewerContent","isAudioVideo","isInformationOpen","showPageNavigation","isAside","isForcedAside","IIIFBadgeButton","PopoverContent","ManifestLabel","Header","HeaderOptions","Collection","manifestId","useCopyToClipboard","notifyTimeout","copyStatus","setCopyStatus","copy","timeoutId","Status","CopyTextStatus","status","CopyText","textPrompt","textToCopy","copyText","IIIFBadge","red","blue","StyledSwitch","Switch","StyledThumb","StyledToggle","checked","setChecked","toggleLabel","DownloadButton","DownloadContent","useGetVaultEntityId","extractRenderingContent","content","itemContent","useRendering","activeCanvasEntity","rootRendering","activeCanvasRendering","rootContent","canvasContent","prepareDownloadLinks","defaultLabel","useViewerDownload","allPages","individualPages","ViewerDownload","showDownloadButton","handleDownloadClick","useMediaQuery","mediaQuery","isMatch","setIsMatch","ViewerHeader","manifestLabel","showDownload","showIIIFBadge","showTitle","headerNavigation","hasOptions","isSmallViewport","prevId","nextId","ShowPagesToggle","useBodyLocked","initialLocked","locked","setLocked","useLayoutEffect","originalOverflow","Viewer","iiifContentSearchQuery","viewerDispatch","absoluteCanvasHeights","isAbsolutePosition","isInformationPanel","setIsInformationPanel","setIsAudioVideo","setPainting","setAnnotationResources","isBodyLocked","setIsBodyLocked","setSearchServiceUrl","setInformationOpen","open","hasSearchService","searchService","DEFAULT_REQUEST_OPTIONS","parseXHRResult","errorResponse","getRequest","options","headers","resolve","reject","CloverViewer","canvasIdCallback","customTheme","iiifResource","RenderViewer","store","isLoaded","setIiifResource","containerURI","manifestFromContentState","initialPage"],"mappings":"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"}