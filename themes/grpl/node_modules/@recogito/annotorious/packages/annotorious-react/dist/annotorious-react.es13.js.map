{"version":3,"file":"annotorious-react.es13.js","sources":["../src/openseadragon/OpenSeadragonAnnotator.tsx"],"sourcesContent":["import { createContext, ReactNode, useContext, useEffect, useState } from 'react';\nimport OpenSeadragon from 'openseadragon';\nimport { DrawingStyle } from '@annotorious/core';\nimport { createOSDAnnotator } from '@annotorious/openseadragon';\nimport { OpenSeadragonAnnotator as AnnotoriousOpenSeadragonAnnotator } from '@annotorious/openseadragon';\nimport { AnnotoriousOpts, ImageAnnotation } from '@annotorious/annotorious';\nimport { AnnotoriousContext } from '../Annotorious';\n\nexport const OpenSeadragonAnnotatorContext = createContext<{ \n  viewer: OpenSeadragon.Viewer,\n  setViewer(viewer: OpenSeadragon.Viewer): void\n}>({ viewer: null, setViewer: null });\n\nexport type OpenSeadragonAnnotatorProps<E extends unknown> = AnnotoriousOpts<ImageAnnotation, E> & {\n\n  children?: ReactNode;\n\n  keepEnabled?: boolean;\n\n  tool?: string | null;\n\n}\n\nexport const OpenSeadragonAnnotator = <E extends unknown>(props: OpenSeadragonAnnotatorProps<E>) => {\n\n  const { children, keepEnabled, tool, ...opts } = props;\n\n  const [viewer, setViewer] = useState<OpenSeadragon.Viewer>();\n\n  const { anno, setAnno } = useContext(AnnotoriousContext);\n\n  useEffect(() => {\n    if (viewer) {\n      const anno = createOSDAnnotator<E>(viewer, opts);\n      setAnno(anno);\n    }\n  }, [viewer]);\n\n  useEffect(() => {\n    if (!anno)\n      return;\n\n    if (props.tool)\n      (anno as AnnotoriousOpenSeadragonAnnotator).startDrawing(props.tool, props.keepEnabled);\n    else\n      (anno as AnnotoriousOpenSeadragonAnnotator).stopDrawing();\n  }, [props.tool, props.keepEnabled]);\n\n  useEffect(() => {\n    if (anno)    \n      anno.style = props.style;\n  }, [props.style]);\n\n  return (\n    <OpenSeadragonAnnotatorContext.Provider value={{ viewer, setViewer }}>\n      {props.children}\n    </OpenSeadragonAnnotatorContext.Provider>\n  )\n\n}\n\nexport const useViewer = () => {\n  const { viewer } = useContext(OpenSeadragonAnnotatorContext);\n  return viewer;\n}"],"names":["OpenSeadragonAnnotatorContext","createContext","OpenSeadragonAnnotator","props","children","keepEnabled","tool","opts","viewer","setViewer","useState","anno","setAnno","useContext","AnnotoriousContext","useEffect","createOSDAnnotator","jsx","useViewer"],"mappings":";;;;AAQO,MAAMA,IAAgCC,EAG1C,EAAE,QAAQ,MAAM,WAAW,MAAM,GAYvBC,IAAyB,CAAoBC,MAA0C;AAElG,QAAM,EAAE,UAAAC,GAAU,aAAAC,GAAa,MAAAC,GAAM,GAAGC,EAAS,IAAAJ,GAE3C,CAACK,GAAQC,CAAS,IAAIC,EAA+B,GAErD,EAAE,MAAAC,GAAM,SAAAC,EAAQ,IAAIC,EAAWC,CAAkB;AAEvD,SAAAC,EAAU,MAAM;AACd,QAAIP,GAAQ;AACJG,YAAAA,IAAOK,EAAsBR,GAAQD,CAAI;AAC/C,MAAAK,EAAQD,CAAI;AAAA,IACd;AAAA,EAAA,GACC,CAACH,CAAM,CAAC,GAEXO,EAAU,MAAM;AACd,IAAKJ,MAGDR,EAAM,OACPQ,EAA2C,aAAaR,EAAM,MAAMA,EAAM,WAAW,IAErFQ,EAA2C,YAAY;AAAA,KACzD,CAACR,EAAM,MAAMA,EAAM,WAAW,CAAC,GAElCY,EAAU,MAAM;AACV,IAAAJ,MACFA,EAAK,QAAQR,EAAM;AAAA,EAAA,GACpB,CAACA,EAAM,KAAK,CAAC,GAGd,gBAAAc,EAACjB,EAA8B,UAA9B,EAAuC,OAAO,EAAE,QAAAQ,GAAQ,WAAAC,EACtD,GAAA,UAAAN,EAAM,SACT,CAAA;AAGJ,GAEae,IAAY,MAAM;AAC7B,QAAM,EAAE,QAAAV,EAAA,IAAWK,EAAWb,CAA6B;AACpD,SAAAQ;AACT;"}