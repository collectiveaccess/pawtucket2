{"version":3,"file":"annotorious-react.es5.js","sources":["../src/ImageAnnotator.tsx"],"sourcesContent":["import { Children, ReactElement, cloneElement, useContext, useEffect } from 'react';\nimport { AnnotoriousOpts, createImageAnnotator, DrawingTool } from '@annotorious/annotorious';\nimport type { ImageAnnotation, ImageAnnotator as AnnotoriousImageAnnotator } from '@annotorious/annotorious';\nimport { AnnotoriousContext } from './Annotorious';\n\nexport interface ImageAnnotatorProps<E extends unknown> extends AnnotoriousOpts<ImageAnnotation, E> {\n\n  children: ReactElement<HTMLImageElement>;\n\n  tool?: DrawingTool\n\n}\n\nexport const ImageAnnotator = <E extends unknown>(props: ImageAnnotatorProps<E>) => {\n\n  const { children, tool, ...opts } = props;\n\n  const child = Children.only(children);\n\n  const { anno, setAnno } = useContext(AnnotoriousContext);\n\n  const onLoad = (evt: Event) => {\n    if (!anno) {\n      const img = evt.target as HTMLImageElement;\n\n      const next = createImageAnnotator(img, opts);\n      setAnno(next); \n    }\n  };\n\n  useEffect(() => {\n    if (props.tool && anno)\n      (anno as AnnotoriousImageAnnotator).setDrawingTool(props.tool);\n  }, [props.tool, anno]);\n\n  useEffect(() => {\n    if (anno)\n      anno.style = props.style;\n  }, [props.style]);\n \n  return <>{cloneElement(child, { onLoad }  as Partial<HTMLImageElement>)}</>\n\n}"],"names":["ImageAnnotator","props","children","tool","opts","child","Children","anno","setAnno","useContext","AnnotoriousContext","onLoad","evt","img","next","createImageAnnotator","useEffect","cloneElement"],"mappings":";;;;AAaa,MAAAA,IAAiB,CAAoBC,MAAkC;AAElF,QAAM,EAAE,UAAAC,GAAU,MAAAC,GAAM,GAAGC,MAASH,GAE9BI,IAAQC,EAAS,KAAKJ,CAAQ,GAE9B,EAAE,MAAAK,GAAM,SAAAC,EAAQ,IAAIC,EAAWC,CAAkB,GAEjDC,IAAS,CAACC,MAAe;AAC7B,QAAI,CAACL,GAAM;AACT,YAAMM,IAAMD,EAAI,QAEVE,IAAOC,EAAqBF,GAAKT,CAAI;AAC3C,MAAAI,EAAQM,CAAI;AAAA,IACd;AAAA,EAAA;AAGF,SAAAE,EAAU,MAAM;AACd,IAAIf,EAAM,QAAQM,KACfA,EAAmC,eAAeN,EAAM,IAAI;AAAA,EAC9D,GAAA,CAACA,EAAM,MAAMM,CAAI,CAAC,GAErBS,EAAU,MAAM;AACV,IAAAT,MACFA,EAAK,QAAQN,EAAM;AAAA,EAAA,GACpB,CAACA,EAAM,KAAK,CAAC,0BAEN,UAAagB,EAAAZ,GAAO,EAAE,QAAAM,GAAsC,EAAE,CAAA;AAE1E;"}