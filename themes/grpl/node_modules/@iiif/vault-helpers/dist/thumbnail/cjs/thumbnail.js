"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var b=require("@atlas-viewer/iiif-image-api");const m={},w={get(o){return o},setMetaValue([o,l,e],s){const h=w.getResourceMeta(o,l),n=h?h[e]:void 0,i=typeof s=="function"?s(n):s;m[o]={...m[o]||{},[l]:{...(m[o]||{})[l]||{},[e]:i}}},getResourceMeta:(o,l)=>{const e=m[o];if(!!e)return l?e[l]:e}};function p(o=w,l={}){const e=l.imageServiceLoader||new b.ImageServiceLoader;async function s(h,n,i,r=[],u){const g=()=>e.getThumbnailFromResource(void 0,n,i,r);if(!h)return await e.getThumbnailFromResource(void 0,n,i,r);if(typeof h=="string"){const t=b.getFixedSizeFromImage(h);return t&&r.push(t),await e.getThumbnailFromResource(void 0,n,i,r)}const a=o.get(h,{skipSelfReturn:!1});if(typeof a=="string")return{best:b.getFixedSizeFromImage(a),fallback:[],log:[]};if(!a)return await g();switch(await(async t=>{if(t&&t.thumbnail&&t.thumbnail.length){const c=o.get(t.thumbnail[0]),f=await e.getImageCandidates(c,i);f&&f.length&&r.push(...f)}})(a),a.type){case"Annotation":{const t=Array.isArray(a.body)?a.body:[a.body],c=o.get(t[0]);return u&&!c.width&&(c.width=u.width,c.height=u.height),await e.getThumbnailFromResource(c,n,i,r)}case"Canvas":{const t=a;return s(t.items[0],n,i,r,{width:t.width,height:t.height})}case"AnnotationPage":return s(a.items[0],n,i,r,u);case"Choice":{const t=a;return!t.items||t.items[0]?await g():s(t.items[0],n,i,r,u)}case"Collection":{const c=a.items[0];return c?s(c,n,i,r,u):await g()}case"Manifest":{const c=a.items[0];return c?s(c,n,i,r,u):await g()}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return u&&!a.width&&(a.width=u.width,a.height=u.height),e.getThumbnailFromResource(a,n,i,r);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return await g()}return await g()}return{getBestThumbnailAtSize:s}}exports.createThumbnailHelper=p;
//# sourceMappingURL=thumbnail.js.map
