var J=Object.defineProperty,Q=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var P=(t,r,e)=>r in t?J(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,i=(t,r)=>{for(var e in r||(r={}))X.call(r,e)&&P(t,e,r[e]);if(z)for(var e of z(r))Y.call(r,e)&&P(t,e,r[e]);return t},$=(t,r)=>Q(t,U(r));import E from"react";import{createStitches as Z}from"@stitches/react";var{styled:m,css:jt,keyframes:qt}=Z({prefix:"nectar"});var x=(t,r="none")=>{if(!t)return null;if(typeof t=="string")return[t];if(!t[r]){let e=Object.getOwnPropertyNames(t);if(e.length>0)return t[e[0]]}return!t[r]||!Array.isArray(t[r])?null:t[r]},c=(t,r="none")=>{let e=x(t,r);return Array.isArray(e)?e.join(", "):e};import tt from"sanitize-html";function W(t){return{__html:et(t)}}function s(t,r){let e=Object.keys(t).filter(a=>r.includes(a)?null:a),n=new Object;return e.forEach(a=>{n[a]=t[a]}),n}function et(t){return tt(t,{allowedAttributes:{a:["href"],img:["alt","src"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}var rt=m("a",{}),ot=t=>{let{children:r,homepage:e}=t,a=s(t,["children","homepage"]);return E.createElement(E.Fragment,null,e&&e.map(o=>{let l=c(o.label,a.lang);return E.createElement(rt,i({"aria-label":r?l:void 0,href:o.id,key:o.id},a),r||l)}))},at=ot;import nt from"react";var it=m("span",{}),mt=t=>{let{as:r,label:e}=t,a=s(t,["as","label"]);return nt.createElement(it,i({as:r},a),c(e,a.lang))},R=mt;import d from"react";import v from"react";import ut from"react";import V from"react";var st=m("span",{}),lt=t=>{let{as:r,markup:e}=t;if(!e)return V.createElement(V.Fragment,null);let a=s(t,["as","markup"]),o=W(c(e,a.lang));return V.createElement(st,$(i({as:r},a),{dangerouslySetInnerHTML:o}))},h=lt;var ct=({as:t="dd",lang:r,value:e})=>ut.createElement(h,{markup:e,as:t,lang:r}),T=ct;import j,{cloneElement as ft,Fragment as pt}from"react";var dt=m("span",{}),gt=({as:t="dd",customValueContent:r,lang:e,value:n})=>{var o;let a=(o=x(n,e))==null?void 0:o.map(l=>ft(r,{value:l}));return j.createElement(dt,{as:t,lang:e},a==null?void 0:a.map((l,p)=>[p>0&&", ",j.createElement(pt,{key:p},l)]))},q=gt;var yt=t=>{let{item:r,lang:e,customValueContent:n}=t,{label:a,value:o}=r;return v.createElement("div",{role:"group"},v.createElement(R,{as:"dt",label:a,lang:e}),n?v.createElement(q,{as:"dd",customValueContent:n,value:o,lang:e}):v.createElement(T,{as:"dd",value:o,lang:e}))},C=yt;function _(t,r){let e=r.filter(n=>{let{matchingLabel:a}=n,o=Object.keys(n.matchingLabel)[0],l=c(a,o);if(c(t,o)===l)return!0}).map(n=>n.Content);if(!!Array.isArray(e))return e[0]}var bt=m("dl",{}),St=t=>{let{as:r,customValueContent:e,metadata:n}=t;if(!Array.isArray(n))return d.createElement(d.Fragment,null);let o=s(t,["as","customValueContent","metadata"]);return d.createElement(d.Fragment,null,n.length>0&&d.createElement(bt,i({as:r},o),n.map((l,p)=>{let g=e?_(l.label,e):void 0;return d.createElement(C,{customValueContent:g,item:l,key:p,lang:o==null?void 0:o.lang})})))},At=St;import F from"react";var ht=m("li",{}),vt=m("ul",{}),Ct=t=>{let{as:r,partOf:e}=t,a=s(t,["as","partOf"]);return F.createElement(vt,{as:r},e&&e.map(o=>{let l=o.label?c(o.label,a.lang):void 0;return F.createElement(ht,{key:o.id},F.createElement("a",i({href:o.id},a),l||o.id))}))},Nt=Ct;import N from"react";var Mt=m("dl",{}),It=t=>{let{as:r,requiredStatement:e}=t;if(!e)return N.createElement(N.Fragment,null);let a=s(t,["as","requiredStatement"]);return N.createElement(Mt,i({as:r},a),N.createElement(C,{item:e,lang:a.lang}))},Lt=It;import O from"react";var kt=m("li",{}),xt=m("ul",{}),Et=t=>{let{as:r,seeAlso:e}=t,a=s(t,["as","seeAlso"]);return O.createElement(xt,{as:r},e&&e.map(o=>{let l=c(o.label,a.lang);return O.createElement(kt,{key:o.id},O.createElement("a",i({href:o.id},a),l||o.id))}))},Rt=Et;import Vt from"react";var Tt=t=>{let{as:r,summary:e}=t,a=s(t,["as","summary"]);return Vt.createElement(h,i({as:r,markup:e},a))},Ft=Tt;import H from"react";import M,{useEffect as G,useRef as Ot}from"react";import S from"hls.js";var D=(t,r="200,",e="full")=>{Array.isArray(t)&&(t=t[0]);let{id:n,service:a}=t,o;if(!a)return n;if(Array.isArray(t.service)&&t.service.length>0&&(o=a[0]),o){if(o["@id"])return`${o["@id"]}/${e}/${r}/0/default.jpg`;if(o.id)return`${o.id}/${e}/${r}/0/default.jpg`}};var K=m("img",{objectFit:"cover"}),Ht=t=>{let r=Ot(null),{contentResource:e,altAsLabel:n,region:a="full"}=t,o;n&&(o=c(n));let p=s(t,["contentResource","altAsLabel"]),{type:g,id:f,width:I=200,height:L=200,format:Pt,duration:A}=e;G(()=>{if(!f&&!r.current||["Image"].includes(g)||!f.includes("m3u8"))return;let u=new S;return r.current&&(u.attachMedia(r.current),u.on(S.Events.MEDIA_ATTACHED,function(){u.loadSource(f)})),u.on(S.Events.ERROR,function(y,b){if(b.fatal)switch(b.type){case S.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${y} network error encountered, try to recover`),u.startLoad();break;case S.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${y} media error encountered, try to recover`),u.recoverMediaError();break;default:u.destroy();break}}),()=>{u&&(u.detachMedia(),u.destroy())}},[]),G(()=>k(),[]);let k=()=>{if(!r.current)return;let u=0,y=30;if(A&&(y=A),!f.split("#t=")&&A&&(u=A*.1),f.split("#t=").pop()){let w=f.split("#t=").pop();w&&(u=parseInt(w.split(",")[0]))}let b=r.current;b.autoplay=!0,b.currentTime=u,setTimeout(()=>k(),y*1e3)};switch(g){case"Image":let u=D(e,`${I},${L}`,a);return M.createElement(K,i({as:"img",alt:o,css:{width:I,height:L},key:f,src:u},p));case"Video":return M.createElement(K,{as:"video",css:{width:I,height:L},disablePictureInPicture:!0,key:f,loop:!0,muted:!0,onPause:k,ref:r,src:f});default:return console.warn(`Resource type: ${g} is not valid or not yet supported in Nectar.`),M.createElement(M.Fragment,null)}},B=Ht;var wt=t=>{let{thumbnail:r,region:e}=t,a=s(t,["thumbnail"]);return H.createElement(H.Fragment,null,r&&r.map(o=>H.createElement(B,i({contentResource:o,key:o.id,region:e},a))))},zt=wt;export{at as Homepage,R as Label,At as Metadata,Nt as PartOf,Lt as RequiredStatement,Rt as SeeAlso,Ft as Summary,zt as Thumbnail,T as Value};
