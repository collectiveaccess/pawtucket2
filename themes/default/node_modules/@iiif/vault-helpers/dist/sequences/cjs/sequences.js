"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function C(t,s){const n=[];for(const e of s.items)if(e.type==="Canvas"&&(e.id.indexOf("#")!==-1?n.push({id:e.id.split("#")[0],type:"Canvas"}):n.push(e)),e.type==="Range"&&n.push(...C(t,t.get(e))),e.type==="SpecificResource"){const u=typeof e.source=="string"?e.source:e.source.id;n.push({id:u,type:"Canvas"})}return n}function m(t){return{getVisibleCanvasesFromCanvasId:(s,n,e=!1)=>b(t,s,n,e),getManifestSequence:(s,n={})=>h(t,s,n)}}function b(t,s,n,e=!1){const u=s.behavior,f=n?t.get(n):null;if(!f)return[];const g=f.behavior,v=e?!1:u.includes("paged"),a=v?!1:u.includes("continuous"),l=v||a?!1:u.includes("individuals"),c=g.includes("facing-pages"),r=g.includes("non-paged");if(c||r||l||e)return[{id:f.id,type:"Canvas"}];const[d,p]=h(t,s);if(a)return d;const i=d.findIndex(o=>o.id===n);if(i===-1)return[];for(const o of p)if(o.includes(i))return o.map(y=>d[y]);return[{id:f.id,type:"Canvas"}]}function h(t,s,{disablePaging:n,skipNonPaged:e}={}){const u=s.behavior,f=u.includes("paged"),g=f?!1:u.includes("continuous"),v=f||g?!1:u.includes("individuals"),a=s.type==="Manifest"?s.items:C(t,s);if(g)return[a,[a.map((i,o)=>o)]];if(v||!f||n)return[a,a.map((i,o)=>[o])];const l=[];let c=[];const r=()=>{c.length&&(l.push([...c]),c=[])};let d=0,p=!1;for(let i=0;i<a.length;i++){const o=t.get(a[i]);if(o.behavior.includes("non-paged")){i===d&&d++,e||(r(),l.push([i]),r());continue}if(i===d||o.behavior.includes("facing-pages")){c.length&&(p=!0),r(),l.push([i]),r();continue}if(c.push(i),p){r(),p=!1;continue}c.length>1&&r()}return c.length&&r(),[a,l]}exports.createSequenceHelper=m;exports.getManifestSequence=h;exports.getVisibleCanvasesFromCanvasId=b;
//# sourceMappingURL=sequences.js.map
